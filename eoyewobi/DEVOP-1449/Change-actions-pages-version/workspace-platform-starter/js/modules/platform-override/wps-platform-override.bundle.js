var e;function a(e){return null==e}function t(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}function o(e){return void 0===e?void 0:JSON.parse(JSON.stringify(e))}function r(e,a,o=!0){if(t(e)&&t(a)){const t=Object.keys(e),n=Object.keys(a);if(t.length!==n.length)return!1;if(o&&JSON.stringify(t)!==JSON.stringify(n))return!1;for(const n of t)if(!r(e[n],a[n],o))return!1;return!0}if(Array.isArray(e)&&Array.isArray(a)){if(e.length!==a.length)return!1;for(let t=0;t<e.length;t++)if(!r(e[t],a[t],o))return!1}return JSON.stringify(e)===JSON.stringify(a)}function n(e,...o){if(!Array.isArray(o)||0===o.length)return e;const r=e,i=o.shift();let s;if(t(r)&&t(i))s=Object.keys(i);else if(Array.isArray(i)){if(!Array.isArray(e))return i;s=Object.keys(i).map(e=>Number.parseInt(e,10))}if(s){const e=i;for(const o of s){const i=e[o];t(i)?(a(r[o])&&(r[o]={}),n(r[o],i)):Array.isArray(i)?(a(r[o])&&(r[o]=[]),n(r[o],i)):r[o]=i}}return n(e,...o)}function i(){return"randomUUID"in globalThis.crypto?globalThis.crypto.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){const a=globalThis.crypto.getRandomValues(new Uint8Array(1))[0]&15>>Number(e)/4;return(Number(e)^a).toString(16)})}function s(e,t){if(a(e))return;const r=o(e);for(const e of r.snapshot.windows)l(e,t);w(r,"metadata");const n=[{propName:"interopSnapshotDetails",defaultValue:{contextGroupStates:{green:{},purple:{},orange:{},red:{},pink:{},yellow:{}}}}];for(const e of n)m(r.snapshot,e.propName,e.defaultValue);return r}function p(e,t){if(a(e))return;const r=o(e);return u(r,t),r}function l(e,a){const t=[{propName:"uuid",defaultValue:""},{propName:"url",defaultValue:""},{propName:"title",defaultValue:""},{propName:"alwaysOnTop",defaultValue:!1},{propName:"frame",defaultValue:!1},{propName:"icon",defaultValue:""},{propName:"x",defaultValue:-1},{propName:"y",defaultValue:-1},{propName:"width",defaultValue:-1},{propName:"height",defaultValue:-1},{propName:"center",defaultValue:!1},{propName:"defaultLeft",defaultValue:0},{propName:"defaultTop",defaultValue:0},{propName:"defaultWidth",defaultValue:-1},{propName:"defaultHeight",defaultValue:-1},{propName:"minWidth",defaultValue:200},{propName:"minHeight",defaultValue:200},{propName:"maxWidth",defaultValue:-1},{propName:"maxHeight",defaultValue:-1},{propName:"minimizable",defaultValue:!0},{propName:"maximizable",defaultValue:!0},{propName:"state",defaultValue:"normal"},{propName:"opacity",defaultValue:1},{propName:"transparent",defaultValue:!1},{propName:"resizeRegion",defaultValue:{bottomRightCorner:20,size:7,sides:{top:!0,right:!0,bottom:!0,left:!0}}},{propName:"accelerator",defaultValue:{devtools:!1,zoom:!1,reload:!1,reloadIgnoringCache:!1}},{propName:"alphaMask",defaultValue:{blue:-1,green:-1,red:-1}},{propName:"alwaysOnBottom",defaultValue:!1},{propName:"api",defaultValue:{iframe:{crossOriginInjection:!1,sameOriginInjection:!0,enableDeprecatedSharedName:!1}}},{propName:"applicationIcon",defaultValue:""},{propName:"aspectRatio",defaultValue:0},{propName:"autoShow",defaultValue:!1},{propName:"backgroundThrottling",defaultValue:!0},{propName:"contentNavigation",defaultValue:{allowlist:["<all_urls>"],denylist:[],whitelist:["<all_urls>"],blacklist:[]}},{propName:"contentRedirect",defaultValue:{allowlist:["<all_urls>"],denylist:[],whitelist:["<all_urls>"],blacklist:[]}},{propName:"contentCreation",defaultValue:{rules:[]}},{propName:"contextMenuSettings",defaultValue:{enable:!0,devtools:!0,reload:!1}},{propName:"cornerRounding",defaultValue:{height:0,width:0}},{propName:"closeOnLastViewRemoved",defaultValue:!1},{propName:"draggable",defaultValue:!1},{propName:"includeInSnapshots",defaultValue:!0},{propName:"resizable",defaultValue:!0},{propName:"resize",defaultValue:!0},{propName:"saveWindowState",defaultValue:!1},{propName:"shadow",defaultValue:!1},{propName:"showTaskbarIcon",defaultValue:!0},{propName:"showBackgroundImages",defaultValue:!1},{propName:"smallWindow",defaultValue:!1},{propName:"spellCheck",defaultValue:!1},{propName:"taskbarIcon",defaultValue:""},{propName:"waitForPageLoad",defaultValue:!1},{propName:"backgroundColor",defaultValue:""},{propName:"fdc3InteropApi",defaultValue:""},{propName:"enableBeforeUnload",defaultValue:!1},{propName:"viewVisibility",defaultValue:{showViewsOnSplitterDrag:{enabled:!0},showViewsOnWindowResize:{enabled:!0},showViewsOnTabDrag:{enabled:!0}}},{propName:"autoplayPolicy",defaultValue:"no-user-gesture-required"},{propName:"permissions",defaultValue:{}},{propName:"contextMenu",defaultValue:!0},{propName:"contextMenuOptions",defaultValue:{template:[],enabled:!1}},{propName:"ignoreSavedWindowState",defaultValue:!0},{propName:"preloadScripts",defaultValue:[]}];for(const o of t)m(e,o.propName,a?.window?.[o.propName]??o.defaultValue);if(w(e,"hotkeys"),w(e,"taskbarIconGroup"),w(e,"experimental"),e.workspacePlatform){w(e,"layout");const t=[{propName:"favicon",defaultValue:""},{propName:"title",defaultValue:""},{propName:"windowStateButtonOptions",defaultValue:void 0},{propName:"disableMultiplePages",defaultValue:!1},{propName:"isLocked",defaultValue:!1},{propName:"preventPageDragIn",defaultValue:!1},{propName:"preventPageDragOut",defaultValue:!1},{propName:"preventPageDrag",defaultValue:!1},{propName:"preventPageClose",defaultValue:!1},{propName:"windowType",defaultValue:"browser"}];for(const o of t)m(e.workspacePlatform,o.propName,a?.window?.workspacePlatform?.[o.propName]??o.defaultValue);w(e.workspacePlatform,"newTabUrl"),w(e.workspacePlatform,"newPageUrl"),w(e.workspacePlatform,"toolbarOptions"),w(e.workspacePlatform,"_internalDeferShowOptions");for(const t of e.workspacePlatform.pages)u(t,a)}}function u(e,a){const t=[{propName:"isActive",defaultValue:!1},{propName:"isReadOnly",defaultValue:!1},{propName:"panels",defaultValue:[]}];for(const o of t)m(e,o.propName,a?.page?.[o.propName]??o.defaultValue);w(e,"hasUnsavedChanges"),d(e.layout,a)}function d(e,a){const t=[{propName:"dimensions",defaultValue:{borderWidth:3,borderGrabWidth:15,minItemHeight:10,minItemWidth:10,headerHeight:30,dragProxyWidth:300,dragProxyHeight:200}},{propName:"labels",defaultValue:{close:"close",maximise:"maximise",minimise:"minimise",popout:"open in new window",popin:"pop in",tabDropdown:"additional tabs"}},{propName:"isClosable",defaultValue:!0},{propName:"reorderEnabled",defaultValue:!0},{propName:"title",defaultValue:""},{propName:"openPopouts",defaultValue:[]},{propName:"maximisedItemId",defaultValue:null}];for(const a of t)m(e,a.propName,a.defaultValue);if(w(e,"layoutDetails"),e.settings){const a=[{propName:"hasHeaders",defaultValue:!0},{propName:"reorderEnabled",defaultValue:!0},{propName:"selectionEnabled",defaultValue:!1},{propName:"popoutWholeStack",defaultValue:!1},{propName:"blockedPopoutsThrowError",defaultValue:!0},{propName:"closePopoutsOnUnload",defaultValue:!0},{propName:"showPopoutIcon",defaultValue:!1},{propName:"showMaximiseIcon",defaultValue:!1},{propName:"showCloseIcon",defaultValue:!1},{propName:"responsiveMode",defaultValue:"onload"},{propName:"tabOverlapAllowance",defaultValue:0},{propName:"reorderOnTabMenuClick",defaultValue:!0},{propName:"tabControlOffset",defaultValue:10},{propName:"preventDragOut",defaultValue:!1},{propName:"preventDragIn",defaultValue:!1},{propName:"constrainDragToContainer",defaultValue:!0},{propName:"constrainDragToHeaders",defaultValue:!1}];for(const t of a)m(e.settings,t.propName,t.defaultValue);w(e.settings,"newTabButton"),0===Object.keys(e.settings).length&&delete e.settings}if(e.content)for(const t of e.content)f(t,a)}function f(e,a){const t=[{propName:"title",defaultValue:""},{propName:"width",defaultValue:0},{propName:"height",defaultValue:0},{propName:"componentName",defaultValue:""},{propName:"isClosable",defaultValue:!0},{propName:"reorderEnabled",defaultValue:!0},{propName:"activeItemIndex",defaultValue:0}];for(const a of t)m(e,a.propName,a.defaultValue);if("componentState"in e){const t=e.componentState;if(t){const e=[{propName:"name",defaultValue:""},{propName:"url",defaultValue:""},{propName:"uuid",defaultValue:""},{propName:"componentName",defaultValue:"view"},{propName:"initialUrl",defaultValue:""},{propName:"processAffinity",defaultValue:fin.me.identity.uuid},{propName:"isClosable",defaultValue:!0},{propName:"bounds",defaultValue:{x:1,y:1,width:0,height:0}},{propName:"detachOnClose",defaultValue:!0},{propName:"isClosable",defaultValue:!0},{propName:"preventDragOut",defaultValue:!1},{propName:"accelerator",defaultValue:{zoom:!0}},{propName:"zoomLevel",defaultValue:0},{propName:"permissions",defaultValue:{}},{propName:"contextMenu",defaultValue:!0},{propName:"contextMenuOptions",defaultValue:{enabled:!0,template:["spellCheck","separator","print","separator","cut","copy","paste","undo","redo","selectAll","inspect","reload"]}},{propName:"preloadScripts",defaultValue:[]},{propName:"enableBeforeUnload",defaultValue:!1},{propName:"backgroundThrottling",defaultValue:!0},{propName:"autoResize",defaultValue:{width:!1,height:!1}},{propName:"zoomLevel",defaultValue:0},{propName:"fdc3InteropApi",defaultValue:""},{propName:"interop",defaultValue:{}},{propName:"customData",defaultValue:{}},{propName:"contentNavigation",defaultValue:{}}];for(const o of e)m(t,o.propName,a?.view?.[o.propName]??o.defaultValue);w(t,"hotkeys")}}if(e.content)for(const t of e.content)f(t,a)}function c(e,t){const o=n(e,t?.window);if(!a(e?.workspacePlatform?.pages))for(const a of e.workspacePlatform.pages)g(a,t);return o}function g(e,a){d(e.layout,a)}function m(e,a,t){a in e&&r(e[a],t,!1)&&delete e[a]}function w(e,a){a in e&&delete e[a]}function h(e){return JSON.parse(JSON.stringify(e,(e,t)=>{return o=t?.name,function(e){return null!=e&&"string"==typeof e}(o)&&o.trim().length>0&&!a(t.url)&&(/\/[\d,a-z-]{36}$/.test(t.name)&&(t.name=t.name.replace(/([\d,a-z-]{36}$)/,i())),/-[\d,a-z-]{36}$/.test(t.name)&&(t.name=t.name.replace(/(-[\d,a-z-]{36}$)/,i()))),t;var o}))}async function y(e){const a=await fin.Application.getCurrent(),t=await a.getManifest();return{window:n({},t.platform?.defaultWindowOptions,e?.defaultWindowOptions),page:n({},e?.defaultPageOptions),view:n({},t.platform?.defaultViewOptions,e?.defaultViewOptions)}}async function k(e,t,o=!1){let r;if(o){const o=await e.Storage.getPage(t);if(!a(o?.customData?.windowBounds))return{bounds:o?.customData?.windowBounds,state:o?.customData?.windowState}}const n=await e.Browser.getAllAttachedPages();let i;for(const e of n)if(e.pageId===t){i=e.parentIdentity;break}if(a(i)){const o=await e.Storage.getPage(t);if(!a(o))return{bounds:o?.customData?.windowBounds,state:o?.customData?.windowState};i=await e.Browser.getLastFocusedWindow()}if(!a(i)){const a=e.Browser.wrapSync(i);r={bounds:await a.openfinWindow.getBounds(),state:await a.openfinWindow.getState()}}return r}!function(e){e.Light="light",e.Dark="dark"}(e||(e={}));const N="workspace-list",V="workspace-get",v="workspace-set",b="workspace-remove",S="page-list",P="page-get",C="page-remove",I="page-set";let O,$,D,M,A,W;const x={platformOverride:new class{async initialize(e,a,t){this._definition=e;const o=e.data?.loggerName??"WpsPlatformOverride";this._logger=a(o),this._helpers=t,this._logger.info("Initializing")}async closedown(){this._logger?.info("Closedown")}async getConstructorOverride(t){if(!this._helpers||!this._logger)throw new Error("Module not initialized");return async function(t,r,n){let l,u;if($=t?.platformProviderOptions?.disableStorageMapping??!1,D=t?.browserProviderOptions?.menuOptions?.styles?.globalMenu,M=t?.browserProviderOptions?.menuOptions?.styles?.pageMenu,A=t?.browserProviderOptions?.menuOptions?.styles?.viewMenu,O=t?.browserProviderOptions?.unsavedPagePromptStrategy??"default",W=!1,n?.getEndpointClient&&(l=await n.getEndpointClient()),n.getAnalyticsClient&&(u=await n.getAnalyticsClient()),!(l&&n.getThemeClient&&n.getVersionInfo&&n.getPlatform&&n.getMenuClient&&n.fireLifecycleEvent&&n.getSnapClient&&n.getConnectionClient))throw new Error("Platform Override Constructor is missing required helpers. The platform override will not function correctly so this error is to flag the issue.");const d=await n.getVersionInfo(),f=n.getPlatform,m=await n.getMenuClient(),w=n.fireLifecycleEvent,x=n.getUtilClient(),E=await n.getSnapClient(),R=await x.position.getWindowPositionOptions(t?.browserProviderOptions),U=await n.getThemeClient(),T=await n.getConnectionClient(),B=await n.getButtonClient(),q=await n.getDockClient(),z=async e=>{const a=f();await w(a,"language-changed",{locale:e});const t=await fin.me.interop.joinSessionContextGroup("platform/events");await t.setContext({type:"platform.language",locale:e})};return t=>class extends t{async launchIntoPlatform(e){r.debug("launchIntoPlatform called. Please use the initOptionsProvider for loading content into the platform. If triggered by clicking on the application icon then autoShow options from the bootstrapper are applied.",e)}async getSnapshot(e,t){let o=await super.getSnapshot(e,t);return E.isEnabled()&&(o=await E.decorateSnapshot(o)),a(T?.decorateSnapshot)?o:T.decorateSnapshot(o)}async applySnapshot(e,t){let o;E.isEnabled()&&(o=await E.prepareToApplyDecoratedSnapshot()),await super.applySnapshot(e,t),a(T?.applyClientSnapshot)||await T.applyClientSnapshot(e.snapshot),E.isEnabled()&&await E.applyDecoratedSnapshot(e.snapshot,o??[])}async getSavedWorkspaces(e){if(a(e)||r.info(`Saved workspaces requested with query: ${e}`),r.info(`Checking for custom workspace storage with endpoint id: ${N}`),l.hasEndpoint(N)){r.info("Requesting saved workspaces from custom storage");const t=await l.requestResponse(N,{platform:fin.me.identity.uuid,query:e});return!a(t)&&Object.keys(t).length>0?(r.info("Returning saved workspaces from custom storage"),Object.values(t).map(e=>e.payload)):(r.warn("No response getting saved workspaces from custom storage"),[])}r.info("Requesting saved workspaces from default storage");const t=await super.getSavedWorkspaces(e);return r.info("Returning saved workspaces from default storage"),t}async getSavedWorkspace(e){if(r.info(`Checking for custom workspace storage with endpoint id: ${V}`),l.hasEndpoint(V)){r.info(`Requesting saved workspace from custom storage for workspace id: ${e}`);const t=await l.requestResponse(V,{platform:fin.me.identity.uuid,id:e});if(!a(t?.payload)){r.info(`Returning saved workspace from custom storage for workspace id: ${e}`);const n=await y();return function(e,t){if(a(e))return;const r=o(e);if(Array.isArray(r.snapshot.windows)){const e=[];for(const a of r.snapshot.windows)e.push(c(a,t));r.snapshot.windows=e}return r}(t.payload,n)}return void r.warn(`No response getting saved workspace from custom storage for workspace id: ${e}`)}r.info(`Requesting saved workspace from default storage for workspace id: ${e}`);const t=await super.getSavedWorkspace(e);return r.info(`Returning saved workspace from default storage for workspace id: ${e}`),t}async createSavedWorkspace(e){if(r.info(`Checking for custom workspace storage with endpoint id: ${v}`),l.hasEndpoint(v)){if(!await l.action(v,{platform:fin.me.identity.uuid,id:e.workspace.workspaceId,metaData:{version:{workspacePlatformClient:d.workspacePlatformClient,platformClient:d.platformClient}},payload:$?e.workspace:s(e.workspace,await y())})){const a=`Unable to save workspace with id: ${e.workspace.workspaceId} to custom storage`;throw r.error(a),new Error(a)}r.info(`Saved workspace with id: ${e.workspace.workspaceId} to custom storage`)}else r.info(`Saving workspace to default storage for workspace id: ${e.workspace.workspaceId}`),await super.createSavedWorkspace(e),r.info(`Saved workspace to default storage for workspace id: ${e.workspace.workspaceId}`);const a=f();W=!0,await w(a,"workspace-changed",{action:"create",id:e.workspace.workspaceId,workspace:e.workspace})}async updateSavedWorkspace(e){if(r.info(`Checking for custom workspace storage with endpoint id: ${v}`),l.hasEndpoint(v)){if(!await l.action(v,{platform:fin.me.identity.uuid,id:e.workspace.workspaceId,metaData:{version:{workspacePlatformClient:d.workspacePlatformClient,platformClient:d.platformClient}},payload:$?e.workspace:s(e.workspace,await y())})){const a=`Unable to update workspace with id: ${e.workspace.workspaceId} against custom storage`;throw r.error(a),new Error(a)}r.info(`Updated workspace with id: ${e.workspace.workspaceId} against custom storage`)}else r.info(`Saving updated workspace to default storage for workspace id: ${e.workspace.workspaceId}.`),await super.updateSavedWorkspace(e),r.info(`Saved updated workspace to default storage for workspace id: ${e.workspace.workspaceId}.`);const a=f();W=!0,await w(a,"workspace-changed",{action:"update",id:e.workspace.workspaceId,workspace:e.workspace})}async deleteSavedWorkspace(e){if(r.info(`Checking for custom workspace storage with endpoint id: ${b}`),l.hasEndpoint(b)){if(!await l.action(b,{platform:fin.me.identity.uuid,id:e})){const a=`Unable to remove workspace with id: ${e} from custom storage`;throw r.error(a),new Error(a)}r.info(`Removed workspace with id: ${e} from custom storage`)}else r.info(`Deleting workspace from default storage for workspace id: ${e}`),await super.deleteSavedWorkspace(e),r.info(`Deleted workspace from default storage for workspace id: ${e}`);const a=f();await w(a,"workspace-changed",{action:"delete",id:e})}async applyWorkspace(e){if(!e)return!1;const t=f();if(!W){let o;const r=await t.getSnapshot();Array.isArray(r.windows)&&0===r.windows.length&&(o=!0,a(e.options)?e.options={skipPrompt:o}:!a(e.options)&&a(e.options.skipPrompt)&&(e.options.skipPrompt=o))}const o=await super.applyWorkspace({...e,options:{...e.options,applySnapshotOptions:{...e.options?.applySnapshotOptions,closeExistingWindows:!1,closeSnapshotWindows:!0}}});return o&&!W&&(W=!0),await w(t,"workspace-changed",{action:"apply",id:e.workspaceId,workspace:e}),o}async getSavedPages(e){if(a(e)||r.info(`Saved pages requested with query: ${e}`),r.info(`Checking for custom page storage with endpoint id: ${S}`),l.hasEndpoint(S)){r.info("Getting saved pages from custom storage");const t=await l.requestResponse(S,{platform:fin.me.identity.uuid,query:e});return!a(t)&&Object.keys(t).length>0?(r.info("Returning saved pages from custom storage"),Object.values(t).map(e=>e.payload)):(r.warn("No response getting saved pages from custom storage"),[])}r.info("Getting saved pages from default storage");const t=await super.getSavedPages(e);return r.info("Returning saved pages from default storage"),t}async getSavedPage(e){let t;if(r.info(`Checking for custom page storage with endpoint id: ${P}`),l.hasEndpoint(P)){r.info(`Getting saved page from custom storage for page id: ${e}`);const n=await l.requestResponse(P,{platform:fin.me.identity.uuid,id:e});if(a(n?.payload))return void r.warn(`No response getting saved page from custom storage for page id: ${e}`);{r.info(`Returning saved page from custom storage for page id: ${e}`);const i=await y();t=function(e,t){if(a(e))return;const r=o(e);return g(r,t),r}(n.payload,i)}}else{if(r.info(`Getting saved page with id ${e} from default storage`),t=await super.getSavedPage(e),a(t))return void r.warn(`No response getting saved page from default storage for page id: ${e}`);r.info(`Returning saved page with id ${e} from default storage`)}return t.layout=h(t?.layout),Array.isArray(t.panels)&&t.panels.length>0&&(t.panels=h(t.panels)),t}async createSavedPage(e){const t=f(),o=await k(t,e.page.pageId);if(a(o)||(a(e.page.customData)&&(e.page.customData={}),a(e.page?.customData?.windowBounds)&&(e.page.customData.windowBounds=o.bounds),a(e.page?.customData?.windowState)&&(e.page.customData.windowState=o.state)),r.info(`Checking for custom page storage with endpoint id: ${I}`),l.hasEndpoint(I)){if(r.info(`Saving page with id: ${e.page.pageId} to custom storage`),!await l.action(I,{platform:fin.me.identity.uuid,id:e.page.pageId,metaData:{version:{workspacePlatformClient:d.workspacePlatformClient,platformClient:d.platformClient}},payload:$?e.page:p(e.page,await y())})){const a=`Unable to save page with id: ${e.page.pageId} to custom storage`;throw r.error(a),new Error(a)}r.info(`Saved page with id: ${e.page.pageId} to custom storage`)}else r.info(`creating saved page and saving to default storage. PageId: ${e.page.pageId}`),await super.createSavedPage(e),r.info(`Saved page with id: ${e.page.pageId} to default storage`);await w(t,"page-changed",{action:"create",id:e.page.pageId,page:e.page})}async updateSavedPage(e){const t=f(),o=await k(t,e.page.pageId);if(a(o)||(a(e.page.customData)&&(e.page.customData={}),e.page.customData.windowBounds=o.bounds,e.page.customData.windowState=o.state),r.info(`Checking for custom page storage with endpoint id: ${I}`),l.hasEndpoint(I)){if(r.info(`Updating saved page and saving to custom storage with page id: ${e.page.pageId}`),!await l.action(I,{platform:fin.me.identity.uuid,id:e.page.pageId,metaData:{version:{workspacePlatformClient:d.workspacePlatformClient,platformClient:d.platformClient}},payload:$?e.page:p(e.page,await y())})){const a=`Unable to save page with id: ${e.page.pageId} against custom storage`;throw r.error(a),new Error(a)}r.info(`Updated page with id: ${e.page.pageId} against custom storage`)}else r.info(`updating saved page and saving to default storage with page id: ${e.page.pageId}`),await super.updateSavedPage(e),r.info(`Updated page with id: ${e.page.pageId} against default storage`);await w(t,"page-changed",{action:"update",id:e.page.pageId,page:e.page})}async deleteSavedPage(e){if(r.info(`Checking for custom page storage with endpoint id: ${C}`),l.hasEndpoint(C)){if(r.info(`deleting saved page from custom storage. PageId: ${e}`),!await l.action(C,{platform:fin.me.identity.uuid,id:e})){const a=`Unable to remove page with id: ${e} from custom storage`;throw r.error(a),new Error(a)}r.info(`Removed page with id: ${e} from custom storage`)}else r.info(`deleting saved page from default storage. PageId: ${e}`),await super.deleteSavedPage(e),r.info(`Removed page with id: ${e} from custom storage`);const a=f();await w(a,"page-changed",{action:"delete",id:e})}async openGlobalContextMenu(e,a){const t=await m.getGlobalMenu(e.template,{windowIdentity:e.identity}),o=D??m.getPopupMenuStyle();if("platform"===o)return super.openGlobalContextMenu({...e,template:t},a);const r=await m.showPopupMenu({x:e.x,y:e.y},e.identity,"",t,{popupMenuStyle:o});r&&e.callback(r,e)}async openViewTabContextMenu(e,a){const t=await m.getViewMenu(e.template,{windowIdentity:e.identity,views:e.selectedViews}),o=A??m.getPopupMenuStyle();if("platform"===o)return super.openViewTabContextMenu({...e,template:t},a);const r=await m.showPopupMenu({x:e.x,y:e.y},e.identity,"",t,{popupMenuStyle:o});r&&e.callback(r,e)}async openPageTabContextMenu(e,a){const t=await m.getPageMenu(e.template,{windowIdentity:e.identity,pageId:e.pageId}),o=M??m.getPopupMenuStyle();if("platform"===o)return super.openPageTabContextMenu({...e,template:t},a);const r=await m.showPopupMenu({x:e.x,y:e.y},e.identity,"",t,{popupMenuStyle:o});r&&e.callback(r,e)}async quit(e,a){const t=f();return await w(t,"before-quit"),super.quit(e,a)}async createWindow(e,t){if(!1===e.autoShow)return super.createWindow(e,t);if(!a(R)&&!R?.disableWindowPositioningStrategy){const t=!a(e?.defaultLeft),o=!a(e?.defaultTop);if(!t||!o){const n=await x.position.getWindowPositionUsingStrategy(R);t||a(n?.left)||(e.defaultLeft=n.left,r.debug(`Updating default left to ${n.left} using window positioning strategy`)),o||a(n?.top)||(e.defaultTop=n.top,r.debug(`Updating default top to ${n.top} using window positioning strategy`))}}const o=Array.isArray(e?.workspacePlatform?.toolbarOptions?.buttons);if(!o){e.workspacePlatform=e.workspacePlatform??{},e.workspacePlatform.toolbarOptions=e.workspacePlatform.toolbarOptions??{};const t=await B.getToolbarButtons(e);a(t)||(e.workspacePlatform.toolbarOptions.buttons=t)}const n=await super.createWindow(e,t);try{r.info("After Create Window",await n.getOptions())}catch{}if(o)try{const e=f().Browser.wrapSync(n.identity);await B.updateBrowserWindowButtonsColorScheme(e)}catch{}return n}async setSelectedScheme(t){if(a(U.setCurrentColorSchemeMode))r.warn("setCurrentColorSchemeMode is not implemented in the theme client."),await super.setSelectedScheme(t);else{let a;switch(t){case"dark":a=e.Dark;break;case"light":a=e.Light;break;default:a=void 0}await Promise.all([U.setCurrentColorSchemeMode(a),super.setSelectedScheme(t)])}}async setLanguage(e){r.info(`Setting language to: ${e}`),await Promise.all([z(e),super.setLanguage(e)])}async handleAnalytics(e){if(u){const a=[],t=new Date;for(const o of e)a.push({timestamp:t,...o});await u.handleAnalytics(a)}return super.handleAnalytics(e)}async getDockProviderConfig(e){return q.loadConfig(e,async e=>super.getDockProviderConfig(e))}async saveDockProviderConfig(e){return q.saveConfig(e,async e=>super.saveDockProviderConfig(e))}async handleSaveModalOnPageClose(e){if(a(O)||"default"===O)return super.handleSaveModalOnPageClose(e);if("never"===O)return{shouldShowModal:!1};if("skip-untitled"===O){const a=f(),t=(await a.Browser.getUniquePageTitle()).split(" ")[0];if(e.page.title.startsWith(t))return{shouldShowModal:!1}}return r.warn("Unsaved page prompt strategy is not valid. Using default."),super.handleSaveModalOnPageClose(e)}async copyPage(e){const t=a(e?.page?.panels)?e?.page?.panels:h(e.page.panels),o=h(e.page.layout);return{...e.page,panels:t,layout:o,pageId:i(),isReadOnly:!1}}async handlePageChanges(e){return super.handlePageChanges(e)}async setActivePage(e){const a=f();await Promise.all([super.setActivePage(e),w(a,"page-changed",{action:"focus",id:e.pageId})])}}}(t,this._logger,this._helpers)}}};export{x as entryPoints};
//# sourceMappingURL=wps-platform-override.bundle.js.map