var t;function e(t){return null==t}!function(t){t.CustomButton="CustomButton",t.StoreCustomButton="StoreCustomButton",t.CustomDropdownItem="CustomDropdownItem",t.GlobalContextMenu="GlobalContextMenu",t.ViewTabContextMenu="ViewTabContextMenu",t.PageTabContextMenu="PageTabContextMenu",t.SaveButtonContextMenu="SaveButtonContextMenu",t.API="API"}(t||(t={}));class i{async initialize(t,e,i){this._integrationHelpers=i,this._definition=t,this._settings=t.data,this._versionTypeMap=t?.data?.versionTypeMap??{},this._excludeVersionType=t?.data?.excludeVersionType??[],this._logger=e("AboutProvider")}async getHelpSearchEntries(){return this._integrationHelpers?[{key:`${this._definition?.id}-help`,score:this._definition?.baseScore??i._DEFAULT_BASE_SCORE,title:i._ABOUT_COMMAND,label:"Help",icon:this._definition?.icon,actions:[],data:{providerId:this._definition?.id,populateQuery:i._ABOUT_COMMAND},template:"Custom",templateContent:await this._integrationHelpers.templateHelpers.createHelp(i._ABOUT_COMMAND,["The about command lists the version information related to this platform."],[i._ABOUT_COMMAND])}]:[]}async getSearchResults(t,n,o,s){if(t.length<2||!i._ABOUT_COMMAND.startsWith(t))return{results:[]};if(this._integrationHelpers?.getVersionInfo){const t=await this._integrationHelpers.getThemeClient(),n=await t.getPalette(),o=await this._integrationHelpers.getVersionInfo(),s=[],a={},r=[];if(r.push(["Version Type","Version"]),o&&this._versionTypeMap&&this._excludeVersionType){const t=Object.keys(o);for(const e of t){const t=o[e];if(!this._excludeVersionType.includes(e)&&t){const i=this._versionTypeMap[e]??e;r.push([i,t??"unknown"])}}}a.title=this._settings?.title??"Versions";const u=[],l=await this._integrationHelpers.templateHelpers.createTitle("title",void 0,void 0,{marginBottom:"10px",borderBottom:`1px solid ${n.background6}`});u.push(l);const c=this._settings?.description;if(!e(c)){a.description=c;const t=await this._integrationHelpers.templateHelpers.createText("description",void 0,{marginBottom:"10px"});u.push(t)}const d=await this._integrationHelpers.templateHelpers.createTable(r,[],0,a);return u.push(d),{results:[{key:"about-info",score:this._definition?.baseScore??i._DEFAULT_BASE_SCORE,title:i._ABOUT_COMMAND,label:"Version",icon:this._definition?.icon,actions:s,data:{providerId:this._definition?.id},template:"Custom",templateContent:{layout:await this._integrationHelpers.templateHelpers.createContainer("column",u,{padding:"10px"}),data:a}}]}}return{results:[]}}async itemSelection(t,e){return!0}}i._DEFAULT_BASE_SCORE=3e3,i._ABOUT_COMMAND="/about";const n={},o={integrations:new i,conditions:new class{constructor(t){this._sharedState=t}async initialize(t,e){this._logger=e("AboutCondition"),this._definition=t,this._logger.info("Condition Initialized")}async get(){const t={};return t["has-about"]=async()=>!e(this._sharedState.aboutWindow),t}}(n),actions:new class{constructor(t){this._sharedState=t}async initialize(t,e,i){this._logger=e("AboutAction"),this._helpers=i,this._definition=t,this._sharedState.aboutWindow=await this.getAboutWindow()}async get(i){const n={};return n["show-about"]=async i=>{if(i.callerType===t.GlobalContextMenu&&!e(this._sharedState?.aboutWindow)){const t=fin.Window.wrapSync({uuid:fin.me.identity.uuid,name:this._sharedState.aboutWindow.name});let e=!1;try{await t.getInfo(),e=!0}catch{this._logger?.info("Cannot see existing about window. Will create an about window.")}if(e)await t.setAsForeground();else try{await fin.Window.create(this._sharedState.aboutWindow)}catch(t){this._logger?.error("Error launching show about action window.",t)}}},n}async getAboutWindow(){if(e(this._definition?.data?.windowOptions))return void this._logger?.info("No about window configuration provided.");const t={...this._definition?.data?.windowOptions};if(!e(t.url))return e(t.name)&&(t.name=`${fin.me.identity.uuid}-versioning-about`),this._helpers?.getVersionInfo&&(e(t?.customData?.versionInfo)?(this._logger?.info("Setting customData versionInfo for about version window configuration."),e(t.customData)&&(t.customData={}),t.customData.versionInfo=await this._helpers.getVersionInfo()):(this._logger?.info("Enriching customData versionInfo provided by about version window configuration."),t.customData.versionInfo={...t.customData.versionInfo,...await this._helpers.getVersionInfo()})),this._logger?.info("Returning about version window configuration."),t;this._logger?.error("An about version window configuration was set but a url was not provided. A window cannot be launched.")}}(n),menus:new class{async initialize(t,e,i){this._logger=e("DeveloperMenus"),this._settings=t.data}async get(t,e){if("global"===t)return[{label:this._settings?.entries?.about?.label??"About",data:{type:"Custom",action:{id:"show-about"}},position:this._settings?.entries?.about?.position??{type:"Quit",operation:"before"},conditions:["has-about"]}]}}};export{o as entryPoints};
//# sourceMappingURL=about.bundle.js.map