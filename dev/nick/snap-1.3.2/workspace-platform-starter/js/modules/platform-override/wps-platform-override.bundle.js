var e,a={};function t(e){return null==e}function o(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}function r(e){return void 0===e?void 0:JSON.parse(JSON.stringify(e))}function n(e,a,t=!0){if(o(e)&&o(a)){const o=Object.keys(e),r=Object.keys(a);if(o.length!==r.length)return!1;if(t&&JSON.stringify(o)!==JSON.stringify(r))return!1;for(const r of o)if(!n(e[r],a[r],t))return!1;return!0}if(Array.isArray(e)&&Array.isArray(a)){if(e.length!==a.length)return!1;for(let o=0;o<e.length;o++)if(!n(e[o],a[o],t))return!1}return JSON.stringify(e)===JSON.stringify(a)}function i(e,...a){if(!Array.isArray(a)||0===a.length)return e;const r=e,n=a.shift();let s;if(o(r)&&o(n))s=Object.keys(n);else if(Array.isArray(n)){if(!Array.isArray(e))return n;s=Object.keys(n).map(e=>Number.parseInt(e,10))}if(s){const e=n;for(const a of s){const n=e[a];o(n)?(t(r[a])&&(r[a]={}),i(r[a],n)):Array.isArray(n)?(t(r[a])&&(r[a]=[]),i(r[a],n)):r[a]=n}}return i(e,...a)}function s(){return"randomUUID"in globalThis.crypto?globalThis.crypto.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){const a=globalThis.crypto.getRandomValues(new Uint8Array(1))[0]&15>>Number(e)/4;return(Number(e)^a).toString(16)})}function p(e,a){if(t(e))return;const o=r(e);for(const e of o.snapshot.windows)u(e,a);h(o,"metadata");const n=[{propName:"interopSnapshotDetails",defaultValue:{contextGroupStates:{green:{},purple:{},orange:{},red:{},pink:{},yellow:{}}}}];for(const e of n)w(o.snapshot,e.propName,e.defaultValue);return o}function l(e,a){if(t(e))return;const o=r(e);return d(o,a),o}function u(e,a){const t=[{propName:"uuid",defaultValue:""},{propName:"url",defaultValue:""},{propName:"title",defaultValue:""},{propName:"alwaysOnTop",defaultValue:!1},{propName:"frame",defaultValue:!1},{propName:"icon",defaultValue:""},{propName:"x",defaultValue:-1},{propName:"y",defaultValue:-1},{propName:"width",defaultValue:-1},{propName:"height",defaultValue:-1},{propName:"center",defaultValue:!1},{propName:"defaultLeft",defaultValue:0},{propName:"defaultTop",defaultValue:0},{propName:"defaultWidth",defaultValue:-1},{propName:"defaultHeight",defaultValue:-1},{propName:"minWidth",defaultValue:200},{propName:"minHeight",defaultValue:200},{propName:"maxWidth",defaultValue:-1},{propName:"maxHeight",defaultValue:-1},{propName:"minimizable",defaultValue:!0},{propName:"maximizable",defaultValue:!0},{propName:"state",defaultValue:"normal"},{propName:"opacity",defaultValue:1},{propName:"transparent",defaultValue:!1},{propName:"resizeRegion",defaultValue:{bottomRightCorner:20,size:7,sides:{top:!0,right:!0,bottom:!0,left:!0}}},{propName:"accelerator",defaultValue:{devtools:!1,zoom:!1,reload:!1,reloadIgnoringCache:!1}},{propName:"alphaMask",defaultValue:{blue:-1,green:-1,red:-1}},{propName:"alwaysOnBottom",defaultValue:!1},{propName:"api",defaultValue:{iframe:{crossOriginInjection:!1,sameOriginInjection:!0,enableDeprecatedSharedName:!1}}},{propName:"applicationIcon",defaultValue:""},{propName:"aspectRatio",defaultValue:0},{propName:"autoShow",defaultValue:!1},{propName:"backgroundThrottling",defaultValue:!0},{propName:"contentNavigation",defaultValue:{allowlist:["<all_urls>"],denylist:[],whitelist:["<all_urls>"],blacklist:[]}},{propName:"contentRedirect",defaultValue:{allowlist:["<all_urls>"],denylist:[],whitelist:["<all_urls>"],blacklist:[]}},{propName:"contentCreation",defaultValue:{rules:[]}},{propName:"contextMenuSettings",defaultValue:{enable:!0,devtools:!0,reload:!1}},{propName:"cornerRounding",defaultValue:{height:0,width:0}},{propName:"closeOnLastViewRemoved",defaultValue:!1},{propName:"draggable",defaultValue:!1},{propName:"includeInSnapshots",defaultValue:!0},{propName:"resizable",defaultValue:!0},{propName:"resize",defaultValue:!0},{propName:"saveWindowState",defaultValue:!1},{propName:"shadow",defaultValue:!1},{propName:"showTaskbarIcon",defaultValue:!0},{propName:"showBackgroundImages",defaultValue:!1},{propName:"smallWindow",defaultValue:!1},{propName:"spellCheck",defaultValue:!1},{propName:"taskbarIcon",defaultValue:""},{propName:"waitForPageLoad",defaultValue:!1},{propName:"backgroundColor",defaultValue:""},{propName:"fdc3InteropApi",defaultValue:""},{propName:"enableBeforeUnload",defaultValue:!1},{propName:"viewVisibility",defaultValue:{showViewsOnSplitterDrag:{enabled:!0},showViewsOnWindowResize:{enabled:!0},showViewsOnTabDrag:{enabled:!0}}},{propName:"autoplayPolicy",defaultValue:"no-user-gesture-required"},{propName:"permissions",defaultValue:{}},{propName:"contextMenu",defaultValue:!0},{propName:"contextMenuOptions",defaultValue:{template:[],enabled:!1}},{propName:"ignoreSavedWindowState",defaultValue:!0},{propName:"preloadScripts",defaultValue:[]}];for(const o of t)w(e,o.propName,a?.window?.[o.propName]??o.defaultValue);if(h(e,"hotkeys"),h(e,"taskbarIconGroup"),h(e,"experimental"),e.workspacePlatform){h(e,"layout");const t=[{propName:"favicon",defaultValue:""},{propName:"title",defaultValue:""},{propName:"windowStateButtonOptions",defaultValue:void 0},{propName:"disableMultiplePages",defaultValue:!1},{propName:"isLocked",defaultValue:!1},{propName:"preventPageDragIn",defaultValue:!1},{propName:"preventPageDragOut",defaultValue:!1},{propName:"preventPageDrag",defaultValue:!1},{propName:"preventPageClose",defaultValue:!1},{propName:"windowType",defaultValue:"browser"}];for(const o of t)w(e.workspacePlatform,o.propName,a?.window?.workspacePlatform?.[o.propName]??o.defaultValue);h(e.workspacePlatform,"newTabUrl"),h(e.workspacePlatform,"newPageUrl"),h(e.workspacePlatform,"toolbarOptions"),h(e.workspacePlatform,"_internalDeferShowOptions");for(const t of e.workspacePlatform.pages)d(t,a)}}function d(e,a){const t=[{propName:"isActive",defaultValue:!1},{propName:"isReadOnly",defaultValue:!1},{propName:"panels",defaultValue:[]}];for(const o of t)w(e,o.propName,a?.page?.[o.propName]??o.defaultValue);h(e,"hasUnsavedChanges"),f(e.layout,a)}function f(e,a){const t=[{propName:"dimensions",defaultValue:{borderWidth:3,borderGrabWidth:15,minItemHeight:10,minItemWidth:10,headerHeight:30,dragProxyWidth:300,dragProxyHeight:200}},{propName:"labels",defaultValue:{close:"close",maximise:"maximise",minimise:"minimise",popout:"open in new window",popin:"pop in",tabDropdown:"additional tabs"}},{propName:"isClosable",defaultValue:!0},{propName:"reorderEnabled",defaultValue:!0},{propName:"title",defaultValue:""},{propName:"openPopouts",defaultValue:[]},{propName:"maximisedItemId",defaultValue:null}];for(const a of t)w(e,a.propName,a.defaultValue);if(h(e,"layoutDetails"),e.settings){const a=[{propName:"hasHeaders",defaultValue:!0},{propName:"reorderEnabled",defaultValue:!0},{propName:"selectionEnabled",defaultValue:!1},{propName:"popoutWholeStack",defaultValue:!1},{propName:"blockedPopoutsThrowError",defaultValue:!0},{propName:"closePopoutsOnUnload",defaultValue:!0},{propName:"showPopoutIcon",defaultValue:!1},{propName:"showMaximiseIcon",defaultValue:!1},{propName:"showCloseIcon",defaultValue:!1},{propName:"responsiveMode",defaultValue:"onload"},{propName:"tabOverlapAllowance",defaultValue:0},{propName:"reorderOnTabMenuClick",defaultValue:!0},{propName:"tabControlOffset",defaultValue:10},{propName:"preventDragOut",defaultValue:!1},{propName:"preventDragIn",defaultValue:!1},{propName:"constrainDragToContainer",defaultValue:!0},{propName:"constrainDragToHeaders",defaultValue:!1}];for(const t of a)w(e.settings,t.propName,t.defaultValue);h(e.settings,"newTabButton"),0===Object.keys(e.settings).length&&delete e.settings}if(e.content)for(const t of e.content)c(t,a)}function c(e,a){const t=[{propName:"title",defaultValue:""},{propName:"width",defaultValue:0},{propName:"height",defaultValue:0},{propName:"componentName",defaultValue:""},{propName:"isClosable",defaultValue:!0},{propName:"reorderEnabled",defaultValue:!0},{propName:"activeItemIndex",defaultValue:0}];for(const a of t)w(e,a.propName,a.defaultValue);if("componentState"in e){const t=e.componentState;if(t){const e=[{propName:"name",defaultValue:""},{propName:"url",defaultValue:""},{propName:"uuid",defaultValue:""},{propName:"componentName",defaultValue:"view"},{propName:"initialUrl",defaultValue:""},{propName:"processAffinity",defaultValue:fin.me.identity.uuid},{propName:"isClosable",defaultValue:!0},{propName:"bounds",defaultValue:{x:1,y:1,width:0,height:0}},{propName:"detachOnClose",defaultValue:!0},{propName:"isClosable",defaultValue:!0},{propName:"preventDragOut",defaultValue:!1},{propName:"accelerator",defaultValue:{zoom:!0}},{propName:"zoomLevel",defaultValue:0},{propName:"permissions",defaultValue:{}},{propName:"contextMenu",defaultValue:!0},{propName:"contextMenuOptions",defaultValue:{enabled:!0,template:["spellCheck","separator","print","separator","cut","copy","paste","undo","redo","selectAll","inspect","reload"]}},{propName:"preloadScripts",defaultValue:[]},{propName:"enableBeforeUnload",defaultValue:!1},{propName:"backgroundThrottling",defaultValue:!0},{propName:"autoResize",defaultValue:{width:!1,height:!1}},{propName:"zoomLevel",defaultValue:0},{propName:"fdc3InteropApi",defaultValue:""},{propName:"interop",defaultValue:{}},{propName:"customData",defaultValue:{}},{propName:"contentNavigation",defaultValue:{}}];for(const o of e)w(t,o.propName,a?.view?.[o.propName]??o.defaultValue);h(t,"hotkeys")}}if(e.content)for(const t of e.content)c(t,a)}function g(e,a){const o=i(e,a?.window);if(!t(e?.workspacePlatform?.pages))for(const t of e.workspacePlatform.pages)m(t,a);return o}function m(e,a){f(e.layout,a)}function w(e,a,t){a in e&&n(e[a],t,!1)&&delete e[a]}function h(e,a){a in e&&delete e[a]}function y(e){return JSON.parse(JSON.stringify(e,(e,a)=>{return o=a?.name,function(e){return null!=e&&"string"==typeof e}(o)&&o.trim().length>0&&!t(a.url)&&(/\/[\d,a-z-]{36}$/.test(a.name)&&(a.name=a.name.replace(/([\d,a-z-]{36}$)/,s())),/-[\d,a-z-]{36}$/.test(a.name)&&(a.name=a.name.replace(/(-[\d,a-z-]{36}$)/,s()))),a;var o}))}async function k(e){const a=await fin.Application.getCurrent(),t=await a.getManifest();return{window:i({},t.platform?.defaultWindowOptions,e?.defaultWindowOptions),page:i({},e?.defaultPageOptions),view:i({},t.platform?.defaultViewOptions,e?.defaultViewOptions)}}async function N(e,a,o=!1){let r;if(o){const o=await e.Storage.getPage(a);if(!t(o?.customData?.windowBounds))return{bounds:o?.customData?.windowBounds,state:o?.customData?.windowState}}const n=await e.Browser.getAllAttachedPages();let i;for(const e of n)if(e.pageId===a){i=e.parentIdentity;break}if(t(i)){const o=await e.Storage.getPage(a);if(!t(o))return{bounds:o?.customData?.windowBounds,state:o?.customData?.windowState};i=await e.Browser.getLastFocusedWindow()}if(!t(i)){const a=e.Browser.wrapSync(i);r={bounds:await a.openfinWindow.getBounds(),state:await a.openfinWindow.getState()}}return r}a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),function(e){e.Light="light",e.Dark="dark"}(e||(e={}));const V="workspace-list",v="workspace-get",b="workspace-set",S="workspace-remove",P="page-list",C="page-get",O="page-remove",I="page-set";let $,D,M,A,W,x;const E={platformOverride:new class{async initialize(e,a,t){this._definition=e;const o=e.data?.loggerName??"WpsPlatformOverride";this._logger=a(o),this._helpers=t,this._logger.info("Initializing")}async closedown(){this._logger?.info("Closedown")}async getConstructorOverride(a){if(!this._helpers||!this._logger)throw new Error("Module not initialized");return async function(a,o,n){let i,u;if(D=a?.platformProviderOptions?.disableStorageMapping??!1,M=a?.browserProviderOptions?.menuOptions?.styles?.globalMenu,A=a?.browserProviderOptions?.menuOptions?.styles?.pageMenu,W=a?.browserProviderOptions?.menuOptions?.styles?.viewMenu,$=a?.browserProviderOptions?.unsavedPagePromptStrategy??"default",x=!1,n?.getEndpointClient&&(i=await n.getEndpointClient()),n.getAnalyticsClient&&(u=await n.getAnalyticsClient()),!(i&&n.getThemeClient&&n.getVersionInfo&&n.getPlatform&&n.getMenuClient&&n.fireLifecycleEvent&&n.getSnapClient&&n.getConnectionClient))throw new Error("Platform Override Constructor is missing required helpers. The platform override will not function correctly so this error is to flag the issue.");const d=await n.getVersionInfo(),f=n.getPlatform,c=await n.getMenuClient(),w=n.fireLifecycleEvent,h=n.getUtilClient(),E=await n.getSnapClient(),R=await h.position.getWindowPositionOptions(a?.browserProviderOptions),U=await n.getThemeClient(),T=await n.getConnectionClient(),B=await n.getButtonClient(),q=await n.getDockClient(),z=async e=>{const a=f();await w(a,"language-changed",{locale:e});const t=await fin.me.interop.joinSessionContextGroup("platform/events");await t.setContext({type:"platform.language",locale:e})};return a=>class extends a{async launchIntoPlatform(e){o.debug("launchIntoPlatform called. Please use the initOptionsProvider for loading content into the platform. If triggered by clicking on the application icon then autoShow options from the bootstrapper are applied.",e)}async getSnapshot(e,a){let o=await super.getSnapshot(e,a);return E.isEnabled()&&(o=await E.decorateSnapshot(o)),t(T?.decorateSnapshot)?o:T.decorateSnapshot(o)}async applySnapshot(e,a){let o;E.isEnabled()&&(o=await E.prepareToApplyDecoratedSnapshot()),await super.applySnapshot(e,a),t(T?.applyClientSnapshot)||await T.applyClientSnapshot(e.snapshot),E.isEnabled()&&await E.applyDecoratedSnapshot(e.snapshot,o??[])}async getSavedWorkspaces(e){if(t(e)||o.info(`Saved workspaces requested with query: ${e}`),o.info(`Checking for custom workspace storage with endpoint id: ${V}`),i.hasEndpoint(V)){o.info("Requesting saved workspaces from custom storage");const a=await i.requestResponse(V,{platform:fin.me.identity.uuid,query:e});return!t(a)&&Object.keys(a).length>0?(o.info("Returning saved workspaces from custom storage"),Object.values(a).map(e=>e.payload)):(o.warn("No response getting saved workspaces from custom storage"),[])}o.info("Requesting saved workspaces from default storage");const a=await super.getSavedWorkspaces(e);return o.info("Returning saved workspaces from default storage"),a}async getSavedWorkspace(e){if(o.info(`Checking for custom workspace storage with endpoint id: ${v}`),i.hasEndpoint(v)){o.info(`Requesting saved workspace from custom storage for workspace id: ${e}`);const a=await i.requestResponse(v,{platform:fin.me.identity.uuid,id:e});if(!t(a?.payload)){o.info(`Returning saved workspace from custom storage for workspace id: ${e}`);const n=await k();return function(e,a){if(t(e))return;const o=r(e);if(Array.isArray(o.snapshot.windows)){const e=[];for(const t of o.snapshot.windows)e.push(g(t,a));o.snapshot.windows=e}return o}(a.payload,n)}return void o.warn(`No response getting saved workspace from custom storage for workspace id: ${e}`)}o.info(`Requesting saved workspace from default storage for workspace id: ${e}`);const a=await super.getSavedWorkspace(e);return o.info(`Returning saved workspace from default storage for workspace id: ${e}`),a}async createSavedWorkspace(e){if(o.info(`Checking for custom workspace storage with endpoint id: ${b}`),i.hasEndpoint(b)){if(!await i.action(b,{platform:fin.me.identity.uuid,id:e.workspace.workspaceId,metaData:{version:{workspacePlatformClient:d.workspacePlatformClient,platformClient:d.platformClient}},payload:D?e.workspace:p(e.workspace,await k())})){const a=`Unable to save workspace with id: ${e.workspace.workspaceId} to custom storage`;throw o.error(a),new Error(a)}o.info(`Saved workspace with id: ${e.workspace.workspaceId} to custom storage`)}else o.info(`Saving workspace to default storage for workspace id: ${e.workspace.workspaceId}`),await super.createSavedWorkspace(e),o.info(`Saved workspace to default storage for workspace id: ${e.workspace.workspaceId}`);const a=f();x=!0,await w(a,"workspace-changed",{action:"create",id:e.workspace.workspaceId,workspace:e.workspace})}async updateSavedWorkspace(e){if(o.info(`Checking for custom workspace storage with endpoint id: ${b}`),i.hasEndpoint(b)){if(!await i.action(b,{platform:fin.me.identity.uuid,id:e.workspace.workspaceId,metaData:{version:{workspacePlatformClient:d.workspacePlatformClient,platformClient:d.platformClient}},payload:D?e.workspace:p(e.workspace,await k())})){const a=`Unable to update workspace with id: ${e.workspace.workspaceId} against custom storage`;throw o.error(a),new Error(a)}o.info(`Updated workspace with id: ${e.workspace.workspaceId} against custom storage`)}else o.info(`Saving updated workspace to default storage for workspace id: ${e.workspace.workspaceId}.`),await super.updateSavedWorkspace(e),o.info(`Saved updated workspace to default storage for workspace id: ${e.workspace.workspaceId}.`);const a=f();x=!0,await w(a,"workspace-changed",{action:"update",id:e.workspace.workspaceId,workspace:e.workspace})}async deleteSavedWorkspace(e){if(o.info(`Checking for custom workspace storage with endpoint id: ${S}`),i.hasEndpoint(S)){if(!await i.action(S,{platform:fin.me.identity.uuid,id:e})){const a=`Unable to remove workspace with id: ${e} from custom storage`;throw o.error(a),new Error(a)}o.info(`Removed workspace with id: ${e} from custom storage`)}else o.info(`Deleting workspace from default storage for workspace id: ${e}`),await super.deleteSavedWorkspace(e),o.info(`Deleted workspace from default storage for workspace id: ${e}`);const a=f();await w(a,"workspace-changed",{action:"delete",id:e})}async applyWorkspace(e){if(!e)return!1;const a=f();if(!x){let o;const r=await a.getSnapshot();Array.isArray(r.windows)&&0===r.windows.length&&(o=!0,t(e.options)?e.options={skipPrompt:o}:!t(e.options)&&t(e.options.skipPrompt)&&(e.options.skipPrompt=o))}const o=await super.applyWorkspace({...e,options:{...e.options,applySnapshotOptions:{...e.options?.applySnapshotOptions,closeExistingWindows:!1,closeSnapshotWindows:!0}}});return o&&!x&&(x=!0),await w(a,"workspace-changed",{action:"apply",id:e.workspaceId,workspace:e}),o}async getSavedPages(e){if(t(e)||o.info(`Saved pages requested with query: ${e}`),o.info(`Checking for custom page storage with endpoint id: ${P}`),i.hasEndpoint(P)){o.info("Getting saved pages from custom storage");const a=await i.requestResponse(P,{platform:fin.me.identity.uuid,query:e});return!t(a)&&Object.keys(a).length>0?(o.info("Returning saved pages from custom storage"),Object.values(a).map(e=>e.payload)):(o.warn("No response getting saved pages from custom storage"),[])}o.info("Getting saved pages from default storage");const a=await super.getSavedPages(e);return o.info("Returning saved pages from default storage"),a}async getSavedPage(e){let a;if(o.info(`Checking for custom page storage with endpoint id: ${C}`),i.hasEndpoint(C)){o.info(`Getting saved page from custom storage for page id: ${e}`);const n=await i.requestResponse(C,{platform:fin.me.identity.uuid,id:e});if(t(n?.payload))return void o.warn(`No response getting saved page from custom storage for page id: ${e}`);{o.info(`Returning saved page from custom storage for page id: ${e}`);const i=await k();a=function(e,a){if(t(e))return;const o=r(e);return m(o,a),o}(n.payload,i)}}else{if(o.info(`Getting saved page with id ${e} from default storage`),a=await super.getSavedPage(e),t(a))return void o.warn(`No response getting saved page from default storage for page id: ${e}`);o.info(`Returning saved page with id ${e} from default storage`)}return a.layout=y(a?.layout),Array.isArray(a.panels)&&a.panels.length>0&&(a.panels=y(a.panels)),a}async createSavedPage(e){const a=f(),r=await N(a,e.page.pageId);if(t(r)||(t(e.page.customData)&&(e.page.customData={}),t(e.page?.customData?.windowBounds)&&(e.page.customData.windowBounds=r.bounds),t(e.page?.customData?.windowState)&&(e.page.customData.windowState=r.state)),o.info(`Checking for custom page storage with endpoint id: ${I}`),i.hasEndpoint(I)){if(o.info(`Saving page with id: ${e.page.pageId} to custom storage`),!await i.action(I,{platform:fin.me.identity.uuid,id:e.page.pageId,metaData:{version:{workspacePlatformClient:d.workspacePlatformClient,platformClient:d.platformClient}},payload:D?e.page:l(e.page,await k())})){const a=`Unable to save page with id: ${e.page.pageId} to custom storage`;throw o.error(a),new Error(a)}o.info(`Saved page with id: ${e.page.pageId} to custom storage`)}else o.info(`creating saved page and saving to default storage. PageId: ${e.page.pageId}`),await super.createSavedPage(e),o.info(`Saved page with id: ${e.page.pageId} to default storage`);await w(a,"page-changed",{action:"create",id:e.page.pageId,page:e.page})}async updateSavedPage(e){const a=f(),r=await N(a,e.page.pageId);if(t(r)||(t(e.page.customData)&&(e.page.customData={}),e.page.customData.windowBounds=r.bounds,e.page.customData.windowState=r.state),o.info(`Checking for custom page storage with endpoint id: ${I}`),i.hasEndpoint(I)){if(o.info(`Updating saved page and saving to custom storage with page id: ${e.page.pageId}`),!await i.action(I,{platform:fin.me.identity.uuid,id:e.page.pageId,metaData:{version:{workspacePlatformClient:d.workspacePlatformClient,platformClient:d.platformClient}},payload:D?e.page:l(e.page,await k())})){const a=`Unable to save page with id: ${e.page.pageId} against custom storage`;throw o.error(a),new Error(a)}o.info(`Updated page with id: ${e.page.pageId} against custom storage`)}else o.info(`updating saved page and saving to default storage with page id: ${e.page.pageId}`),await super.updateSavedPage(e),o.info(`Updated page with id: ${e.page.pageId} against default storage`);await w(a,"page-changed",{action:"update",id:e.page.pageId,page:e.page})}async deleteSavedPage(e){if(o.info(`Checking for custom page storage with endpoint id: ${O}`),i.hasEndpoint(O)){if(o.info(`deleting saved page from custom storage. PageId: ${e}`),!await i.action(O,{platform:fin.me.identity.uuid,id:e})){const a=`Unable to remove page with id: ${e} from custom storage`;throw o.error(a),new Error(a)}o.info(`Removed page with id: ${e} from custom storage`)}else o.info(`deleting saved page from default storage. PageId: ${e}`),await super.deleteSavedPage(e),o.info(`Removed page with id: ${e} from custom storage`);const a=f();await w(a,"page-changed",{action:"delete",id:e})}async openGlobalContextMenu(e,a){const t=await c.getGlobalMenu(e.template,{windowIdentity:e.identity}),o=M??c.getPopupMenuStyle();if("platform"===o)return super.openGlobalContextMenu({...e,template:t},a);const r=await c.showPopupMenu({x:e.x,y:e.y},e.identity,"",t,{popupMenuStyle:o});r&&e.callback(r,e)}async openViewTabContextMenu(e,a){const t=await c.getViewMenu(e.template,{windowIdentity:e.identity,views:e.selectedViews}),o=W??c.getPopupMenuStyle();if("platform"===o)return super.openViewTabContextMenu({...e,template:t},a);const r=await c.showPopupMenu({x:e.x,y:e.y},e.identity,"",t,{popupMenuStyle:o});r&&e.callback(r,e)}async openPageTabContextMenu(e,a){const t=await c.getPageMenu(e.template,{windowIdentity:e.identity,pageId:e.pageId}),o=A??c.getPopupMenuStyle();if("platform"===o)return super.openPageTabContextMenu({...e,template:t},a);const r=await c.showPopupMenu({x:e.x,y:e.y},e.identity,"",t,{popupMenuStyle:o});r&&e.callback(r,e)}async quit(e,a){const t=f();return await w(t,"before-quit"),super.quit(e,a)}async createWindow(e,a){if(!1===e.autoShow)return super.createWindow(e,a);if(!t(R)&&!R?.disableWindowPositioningStrategy){const a=!t(e?.defaultLeft),r=!t(e?.defaultTop);if(!a||!r){const n=await h.position.getWindowPositionUsingStrategy(R);a||t(n?.left)||(e.defaultLeft=n.left,o.debug(`Updating default left to ${n.left} using window positioning strategy`)),r||t(n?.top)||(e.defaultTop=n.top,o.debug(`Updating default top to ${n.top} using window positioning strategy`))}}const r=Array.isArray(e?.workspacePlatform?.toolbarOptions?.buttons);if(!r){e.workspacePlatform=e.workspacePlatform??{},e.workspacePlatform.toolbarOptions=e.workspacePlatform.toolbarOptions??{};const a=await B.getToolbarButtons(e);t(a)||(e.workspacePlatform.toolbarOptions.buttons=a)}const n=await super.createWindow(e,a);try{o.info("After Create Window",await n.getOptions())}catch{}if(r)try{const e=f().Browser.wrapSync(n.identity);await B.updateBrowserWindowButtonsColorScheme(e)}catch{}return n}async setSelectedScheme(a){if(t(U.setCurrentColorSchemeMode))o.warn("setCurrentColorSchemeMode is not implemented in the theme client."),await super.setSelectedScheme(a);else{let t;switch(a){case"dark":t=e.Dark;break;case"light":t=e.Light;break;default:t=void 0}await Promise.all([U.setCurrentColorSchemeMode(t),super.setSelectedScheme(a)])}}async setLanguage(e){o.info(`Setting language to: ${e}`),await Promise.all([z(e),super.setLanguage(e)])}async handleAnalytics(e){if(u){const a=[],t=new Date;for(const o of e)a.push({timestamp:t,...o});await u.handleAnalytics(a)}return super.handleAnalytics(e)}async getDockProviderConfig(e){return q.loadConfig(e,async e=>super.getDockProviderConfig(e))}async saveDockProviderConfig(e){return q.saveConfig(e,async e=>super.saveDockProviderConfig(e))}async handleSaveModalOnPageClose(e){if(t($)||"default"===$)return super.handleSaveModalOnPageClose(e);if("never"===$)return{shouldShowModal:!1};if("skip-untitled"===$){const a=f(),t=(await a.Browser.getUniquePageTitle()).split(" ")[0];if(e.page.title.startsWith(t))return{shouldShowModal:!1}}return o.warn("Unsaved page prompt strategy is not valid. Using default."),super.handleSaveModalOnPageClose(e)}async copyPage(e){const a=t(e?.page?.panels)?e?.page?.panels:y(e.page.panels),o=y(e.page.layout);return{...e.page,panels:a,layout:o,pageId:s(),isReadOnly:!1}}async handlePageChanges(e){return super.handlePageChanges(e)}async setActivePage(e){const a=f();await Promise.all([super.setActivePage(e),w(a,"page-changed",{action:"focus",id:e.pageId})])}}}(a,this._logger,this._helpers)}}};export{E as entryPoints};
//# sourceMappingURL=wps-platform-override.bundle.js.map