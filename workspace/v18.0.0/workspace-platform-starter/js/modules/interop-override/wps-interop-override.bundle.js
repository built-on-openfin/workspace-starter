var t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function n(t){return null==t}function i(t){return null!=t&&"string"==typeof t}function s(t){return i(t)&&t.trim().length>0}function a(t){return n(t)?"":t instanceof Error?t.message:s(t)?t:null!=(e=t)&&"object"==typeof e&&!Array.isArray(e)&&"message"in t&&i(t.message)?t.message:JSON.stringify(t);var e}function r(t){const e=[],i=[];if(Array.isArray(t.icons))for(const i of t.icons)n(i.src)||e.push(i.src);if(Array.isArray(t.images))for(const e of t.images)n(e.src)||i.push(e.src);return{appId:t.appId,description:t.description,icons:e,images:i,name:t.appId,title:t.title,tooltip:t.tooltip,version:t.version}}function o(t,e){return{appId:t.appId,description:t.description,icons:t.icons,name:t.name,screenshots:t.images,title:t.title,tooltip:t.tooltip,version:t.version,resultType:e}}t.d(e,{k:()=>A});const p="AppTimeout",d="NoAppsFound",c="ResolverUnavailable",l="TargetAppUnavailable",h="TargetInstanceUnavailable",u="IntentDeliveryFailed",f="unregistered-app";async function g(t){let e,i;try{const e=fin.View.wrapSync(t);i=await e.getCurrentWindow()}catch{}if(n(e))try{const n=i??fin.Window.wrapSync(t);e=await n.getBounds()}catch{}if(n(e))try{e=await fin.me.getBounds()}catch{}return e}async function I(t){const e=await fin.System.getMonitorInfo(),i=t.x,s=t.y;if(!n(i)&&!n(s))for(const t of e.nonPrimaryMonitors)if(w({x:i,y:s},t.monitorRect))return t;return e.primaryMonitor}function w(t,e){return t.x>=e.left&&t.x<=e.right&&t.y>=e.top&&t.y<=e.bottom}async function y(t,e){if(!0===t?.disableWindowPositioningStrategy)return;let i;if(n(e))i=(await fin.System.getMonitorInfo()).primaryMonitor;else if(!n(e)&&"monitorRect"in e)i=e;else if(!n(e)&&"x"in e)i=await I(e);else{const t=await g(e);i=n(t)?(await fin.System.getMonitorInfo()).primaryMonitor:await I({x:t.left,y:t.top})}const s=t?.defaults?.left??0,a=t?.defaults?.top??0,r=i.availableRect.left,o=i.availableRect.top,p=t?.windowPositioningStrategy?.x??30,d=t?.windowPositioningStrategy?.y??30,c=t?.windowPositioningStrategy?.maxIncrements??8,l=await async function(){const t=fin.Platform.getCurrentSync(),e=await t.Application.getChildWindows(),n=[];for(const t of e)try{await t.isShowing()&&n.push(t)}catch{}return n}(),h=await Promise.all(l.map((async t=>{try{const e=await t.getBounds();return{left:e.left,top:e.top,right:e.left+p,bottom:e.top+d}}catch{return{left:0,top:0,right:0,bottom:0}}})));let u=1e3,f=c;for(let t=0;t<c;t++){const e=s+t*p,n=a+t*d,i=h.filter((t=>t.left>=e+r&&t.right<=e+p+r&&t.top>=n+o&&t.bottom<=n+d+o));i.length<u&&(u=i.length,f=t)}return{left:s+f*p+r,top:a+f*d+o}}class m{constructor(t,e){this._getApps=t,this._logger=e}async getAppsByIntent(t){return(await this._getApps()).filter((e=>{const i=e.interop?.intents?.listensFor;if(n(i))return!1;const s=Object.keys(i);for(const e of s)if(e.toLowerCase()===t.toLowerCase())return!0;return!1}))}async getIntent(t,e,i){const s=await this._getApps();if(0===s.length)return void this._logger.warn("There was no apps returned so we are unable to find apps that support an intent");const a={};for(const r of s)if(r.interop?.intents?.listensFor&&!n(r.interop.intents.listensFor[t])){const n=r.interop.intents.listensFor[t];this.appIntentContains(n,e,i)&&this.updateAppIntentsMap(a,t,n.displayName,r)}const r=Object.values(a);if(0!==r.length)return 1===r.length||this._logger.warn(`Received more than one result for findIntent for intent ${t} and context ${e} and resultType ${i}. Returning the first entry.`),r[0];this._logger.info(`No results found for findIntent for intent ${t} and context ${e} and resultType ${i}`)}async getIntentsByContext(t,e){const i=await this._getApps();if(0===i.length)return this._logger.warn("Unable to get apps so we can not get apps and intents that support a particular context"),[];const s={};for(const a of i){const i=a.interop?.intents?.listensFor;if(!n(i)){const n=Object.keys(i);for(const r of n){const n=i[r];this.appIntentContains(n,t,e)&&this.updateAppIntentsMap(s,r,n.displayName,a)}}}return Object.values(s)}appIntentContains(t,e,i){if(n(e)||n(i)){if(!n(e)&&!t?.contexts?.includes(e))return!1;if(!n(i)&&!t?.resultType?.includes(i))return!1}else if(!t?.contexts?.includes(e)||!t.resultType?.includes(i))return!1;return!0}updateAppIntentsMap(t,e,i,s){n(t[e])&&(t[e]={intent:{name:e,displayName:i},apps:[]}),t[e].apps.push(s)}}class _{constructor(t,e){this._logger=e,this._lookupAppId=t,this._clientReadyRequests={},this._trackedClientConnections={},this._trackedContextHandlers={},this._trackedIntentHandlers={}}async clientDisconnected(t){this._logger.info("Client Disconnected.",t);for(const[e,n]of Object.entries(this._trackedIntentHandlers))this._trackedIntentHandlers[e]=n.filter((e=>e.clientIdentity.endpointId!==t.endpointId));for(const[e,n]of Object.entries(this._trackedContextHandlers))this._trackedContextHandlers[e]=n.filter((e=>e.clientIdentity.endpointId!==t.endpointId));this.removeTrackedClientConnection(t)}async intentHandlerRegistered(t,e){if(this._logger.info("intentHandlerRegistered:",t,e),!n(t)){const i=t.handlerId.replace("intent-handler-","");let s=this._trackedIntentHandlers[i];if(n(s)&&(s=[],this._trackedIntentHandlers[i]=s),n(this._trackedIntentHandlers[i].find((t=>t.clientIdentity.endpointId===e.endpointId)))){this._logger.info(`intentHandler endpoint not registered. Registering ${e.endpointId} against intent ${i} and looking up app name.`);const s=await this._lookupAppId(e);if(n(s))return void this._logger.warn("Unable to determine app id based on name. This app will not be tracked via intent handler registration.");this._trackedIntentHandlers[i].push({fdc3Version:t.fdc3Version,clientIdentity:e,appId:s}),this._logger.info(`intentHandler endpoint: ${e.endpointId} registered against intent: ${i} and app Id: ${s}.`)}const a=this.getClientReadyKey(e,"intent",i);n(this._clientReadyRequests[a])||(this._logger.info("Resolving client ready request."),this._clientReadyRequests[a](e.endpointId))}}async contextHandlerRegistered(t,e){if(this._logger.info("contextHandlerRegistered:",t,e),!n(t?.handlerId)){const i=t?.contextType??"*",s=t.handlerId;let a=this._trackedContextHandlers[i];if(n(a)&&(a=[],this._trackedContextHandlers[i]=a),n(this._trackedContextHandlers[i].find((t=>t.clientIdentity.endpointId===e.endpointId)))){this._logger.info(`contextHandler endpoint not registered. Registering ${e.endpointId} against context handler for context type ${i} and looking up app name.`);const t=await this._lookupAppId(e);if(n(t))return void this._logger.warn("Unable to determine app id based on name. This app will not be tracked via context handler registration.");this._trackedContextHandlers[i].push({clientIdentity:e,appId:t,handlerId:s}),this._logger.info(`contextHandler endpoint: ${e.endpointId} registered against context type: ${i} and app Id: ${t}.`)}const r=this.getClientReadyKey(e,"context",i);n(this._clientReadyRequests[r])||(this._logger.info("Resolving client ready request."),this._clientReadyRequests[r](e.endpointId))}}async clientConnectionRegistered(t,e){const i=`${t.uuid}-${t.name}`;let a;if(n(this._trackedClientConnections[i])){if(t.uuid!==fin.me.identity.uuid){const i=e?.apiVersion;a=n(i)||n(i?.type)?s(t.connectionUrl)?{type:"fdc3",version:"2.0"}:{type:"interop"}:i}else{const e=t.entityType;if(n(e))a=await this.captureViewApiUsage(t),n(a)&&(a=await this.captureWindowApiUsage(t));else switch(e){case"window":a=await this.captureWindowApiUsage(t);break;case"view":a=await this.captureViewApiUsage(t);break;default:this._logger.warn(`We currently do not check for entity types that are not views or windows. Entity type: ${e}`)}}const r={clientIdentity:t,apiMetadata:a};this._trackedClientConnections[i]=r;const o=this.getClientReadyKey(t,"connection");n(this._clientReadyRequests[o])||(this._logger.info("Resolving client ready request."),this._clientReadyRequests[o](t.endpointId))}}getRegisteredContextHandler(t,e){const n=this._trackedContextHandlers[t]?.find((t=>t.clientIdentity.endpointId===e));return n}async findAppInstances(t,e,i="connected"){const s={};if("intent"===i){for(const[,e]of Object.entries(this._trackedIntentHandlers)){const n=e.filter((e=>e.appId===t.appId));for(const t of n)s[t.clientIdentity.endpointId]={appId:t.appId??"",instanceId:t.clientIdentity.endpointId}}return Object.values(s)}for(const[,e]of Object.entries(this._trackedClientConnections))await this._lookupAppId(e.clientIdentity)===t.appId&&n(s[e.clientIdentity.endpointId])&&(s[e.clientIdentity.endpointId]={appId:t.appId??"",instanceId:e.clientIdentity.endpointId});return Object.values(s)}getApiVersion(t){const e=`${t.uuid}-${t.name}`,n=this._trackedClientConnections[e]?.apiMetadata;return n}async onConnectionClientReady(t,e=15e3){return new Promise(((i,s)=>{const a=this.getClientIdentity(t);n(a)||i(a.endpointId);const r=this.getClientReadyKey(t,"connection"),o=setTimeout((()=>{n(this._clientReadyRequests[r])||(delete this._clientReadyRequests[r],s(h))}),e);this._clientReadyRequests[r]=t=>{clearTimeout(o),delete this._clientReadyRequests[r],i(t)}}))}async onIntentClientReady(t,e,i=15e3){return new Promise(((s,a)=>{const r=this._trackedIntentHandlers[e];let o;if(!n(r))for(const e of r)if(e.clientIdentity.uuid===t.uuid&&e.clientIdentity.name===t.name){o=e.clientIdentity.endpointId;break}n(o)||s(o);const p=this.getClientReadyKey(t,"intent",e),d=setTimeout((()=>{n(this._clientReadyRequests[p])||(delete this._clientReadyRequests[p],a(u))}),i);this._clientReadyRequests[p]=t=>{clearTimeout(d),delete this._clientReadyRequests[p],s(t)}}))}async onContextClientReady(t,e,i=15e3){return new Promise(((s,a)=>{const r=this._trackedContextHandlers[e],o=this._trackedContextHandlers["*"];let d;if(!n(r))for(const e of r)if(e.clientIdentity.uuid===t.uuid&&e.clientIdentity.name===t.name){d=e.clientIdentity.endpointId;break}if(!n(o)&&n(d))for(const e of o)if(e.clientIdentity.uuid===t.uuid&&e.clientIdentity.name===t.name){d=e.clientIdentity.endpointId;break}if(!n(d))return void s(d);const c=this.getClientReadyKey(t,"context",e),l=this.getClientReadyKey(t,"context","*"),h=setTimeout((()=>{const t=!n(this._clientReadyRequests[c]),e=!n(this._clientReadyRequests[l]);(t||e)&&(delete this._clientReadyRequests[c],delete this._clientReadyRequests[l],a(p))}),i);let u=!1;this._clientReadyRequests[c]=t=>{clearTimeout(h),u||(u=!0,delete this._clientReadyRequests[c],delete this._clientReadyRequests[l],s(t))},this._clientReadyRequests[l]=t=>{clearTimeout(h),u||(u=!0,delete this._clientReadyRequests[c],delete this._clientReadyRequests[l],s(t))}}))}getClientIdentity(t){const e=`${t.uuid}-${t.name}`,n=this._trackedClientConnections[e]?.clientIdentity;return n}removeTrackedClientConnection(t){const e=`${t.uuid}-${t.name}`;delete this._trackedClientConnections[e]}async captureWindowApiUsage(t){try{const e=fin.Window.wrapSync(t),i=await e.getOptions();if(!n(i.fdc3InteropApi))return{type:"fdc3",version:i.fdc3InteropApi}}catch{}}async captureViewApiUsage(t){try{const e=fin.View.wrapSync(t),i=await e.getOptions();if(!n(i.fdc3InteropApi))return{type:"fdc3",version:i.fdc3InteropApi}}catch{}}getClientReadyKey(t,e,i){return n(i)?`${t.uuid}/${t.name}/${e}`:`${t.uuid}/${t.name}/${e}/${i}`}}class R{constructor(t,e,n){this._defaultIntentResolverHeight=715,this._defaultIntentResolverWidth=665,this._intentResolverOptions={height:this._defaultIntentResolverHeight,width:this._defaultIntentResolverWidth,fdc3InteropApi:"2.0",title:"Intent Resolver",...t},this._logger=e}async launchIntentResolver(t,e){try{const i=await async function(t,e){const i=function(t){let e,i;if(!n(t)){const n=t.width/2,s=t.height/2;return e=t.left+n,i=t.top+s,{x:Math.round(e),y:Math.round(i)}}return{}}(await g(t));return function(t,e){const n=t.bottom-t.top,i=(t.right-t.left)/2,s=n/2,a=e.width/2,r=e.height/2,o=t.left+i-a,p=t.top+s-r;return{x:Math.round(o),y:Math.round(p)}}((await I(i)).availableRect,e)}(e,{height:this._intentResolverOptions?.height??this._defaultIntentResolverHeight,width:this._intentResolverOptions?.width??this._defaultIntentResolverWidth}),s={name:"intent-picker",includeInSnapshots:!1,fdc3InteropApi:this._intentResolverOptions?.fdc3InteropApi,defaultWidth:this._intentResolverOptions?.width,defaultHeight:this._intentResolverOptions?.height,showTaskbarIcon:!1,saveWindowState:!1,customData:{title:this._intentResolverOptions?.title,apps:t.apps,intent:t.intent,intents:t.intents,unregisteredAppId:this._unregisteredAppId},url:this._intentResolverOptions?.url,frame:!1,autoShow:!0,alwaysOnTop:!0};n(i)?s.defaultCentered=!0:(s.defaultLeft=i.x,s.defaultTop=i.y);const a=(await fin.Window.create(s)).getWebWindow();return await a.getIntentSelection()}catch(e){const n=a(e);if(n?.includes("UserCancelledResolution"))throw this._logger.info("App for intent not selected/launched by user",t.intent),new Error(n);throw this._logger.error("Unexpected error from intent picker/resolver for intent",t.intent),new Error(c)}}}const A={interopOverride:new class{async initialize(t,e,n){this._definition=t;const i=t.data?.loggerName??"WpsInteropOverride";this._logger=e(i),this._helpers=n,this._logger.info("Initializing")}async closedown(){this._logger?.info("Closedown")}async getConstructorOverride(t){if(!this._helpers||!this._logger)throw new Error("Module not initialized");return async function(t,e,g){if(!g?.getApp||!g?.getApps||!g.launchApp)throw new Error("Interop Broker Constructor is missing required helpers. The broker will not function correctly so this error is to flag the issue.");const I=g.getApp,w=g.getApps;let A;g?.getEndpointClient&&(A=await(g?.getEndpointClient()));const v=g.launchApp;return x=>class extends x{constructor(){super(),e.info("Interop Broker Constructor applying settings."),this._appIntentHelper=new m(w,e),this._clientRegistrationHelper=new _((async t=>this.lookupAppId(t)),e),this._metadataKey=`_metadata_${"randomUUID"in globalThis.crypto?globalThis.crypto.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){const e=globalThis.crypto.getRandomValues(new Uint8Array(1))[0]&15>>Number(t)/4;return(Number(t)^e).toString(16)}))}`,t.intentResolver&&(this._intentResolverHelper=new R(t.intentResolver,e,t?.unregisteredApp?.appId)),this._openOptions=t?.openOptions,this._unregisteredApp=t?.unregisteredApp,n(this._unregisteredApp)||(this._unregisteredApp.manifestType=f)}async isConnectionAuthorized(t,i){e.info("Interop connection being made by the following identity. About to verify connection",t);const s=i;if(!n(g.isConnectionValid)){const n=await g.isConnectionValid(t,i,{type:"broker"});return n.isValid?(e.info("Connection validation request was validated and is valid."),await this._clientRegistrationHelper.clientConnectionRegistered(t,s)):e.warn(`Connection request from ${JSON.stringify(t)} was validated and rejected.`),n.isValid}const a=await super.isConnectionAuthorized(t,i);return a&&await this._clientRegistrationHelper.clientConnectionRegistered(t,s),a}async setContext(t,e){t.context=await this.processContext(t.context);const n=await this.getContextMetadata(e);t.context={...t.context,[this._metadataKey]:n},super.setContext(t,e)}async invokeContextHandler(t,e,i){const s={...i},a=s[this._metadataKey];return n(a)||delete s[this._metadataKey],super.invokeContextHandler(t,e,{...s,contextMetadata:a})}async handleInfoForIntentsByContext(t,e){let i,s,a;const p=this._clientRegistrationHelper.getApiVersion(e);"type"in t?i=t.type:(a=t,i=a.context.type,s=a.metadata.resultType);const c=await this._appIntentHelper.getIntentsByContext(i,s);if(0===c.length)throw new Error(d);const l="fdc3"===p?.type&&"2.0"===p.version;return c.map((t=>({intent:t.intent,apps:t.apps.map((e=>{let i;const s=e?.interop?.intents?.listensFor;return n(s)||n(s[t.intent.name])||(i=s[t.intent.name].resultType),l?o(e,i):r(e)}))})))}async handleInfoForIntent(t,e){const i=this._clientRegistrationHelper.getApiVersion(e);let s;const a=t?.context?.type;n(a)||"fdc3.nothing"===a||(s=a);const p=await this._appIntentHelper.getIntent(t.name,s,t?.metadata?.resultType);if(n(p))throw new Error(d);const c="fdc3"===i?.type&&"2.0"===i.version;return{intent:p.intent,apps:p.apps.map((t=>{let e;const i=t?.interop?.intents?.listensFor;return n(i)||n(i[p.intent.name])||(e=i[p.intent.name].resultType),c?o(t,e):r(t)}))}}async handleFiredIntentForContext(t,e){const i=this.getApplicationIdentity(t.metadata),s=this.usesApplicationIdentity(e),a={context:t},r=await this._appIntentHelper.getIntentsByContext(t.type);if(!n(i)){const r=await I(i.appId);if(n(r))throw new Error(l);if(!r?.interop?.intents?.listensFor||!Object.values(r.interop.intents.listensFor).some((e=>e.contexts.includes(t.type))))throw new Error(d);const o=await this.handleTargetedIntent(i,a,!0,e);return this.shapeIntentResolver(o,s)}const o=await this.getUnregisteredAppIntentByContext(t.type,e);if(o.length>0&&!n(this._unregisteredApp)){const t=[];for(const e of r)o.includes(e.intent.name)&&(e.apps.push(this._unregisteredApp),t.push(e.intent.name));const e=o.filter((e=>!t.includes(e)));for(const t of e){const e=this._unregisteredApp.intents?.find((e=>e.name===t));e&&r.push({intent:{name:e.name,displayName:e.displayName},apps:[this._unregisteredApp]})}}let p;if(1===r.length){const t=r[0];if(a.name=t.intent.name,a.displayName=t.intent.displayName,1===t.apps.length&&(0===(await this._clientRegistrationHelper.findAppInstances(t.apps[0],e,"intent")).length||this.createNewInstance(t.apps[0]))){const i=await this.launchAppWithIntent(t.apps[0],a,void 0,e);if(n(i))throw new Error(d);return this.shapeIntentResolver(i,s)}p=await(this._intentResolverHelper?.launchIntentResolver({apps:r[0].apps,intent:a},e))}else p=await(this._intentResolverHelper?.launchIntentResolver({intent:a,intents:r},e));if(n(p))throw new Error(c);a.displayName=p.intent.displayName,a.name=p.intent.name;const h=await this.handleIntentPickerSelection(p,a,e);return this.shapeIntentResolver(h,s)}async handleFiredIntent(t,i){e.info("Received request for a raised intent",t);const s=this.getApplicationIdentity(t.metadata),a=this.usesApplicationIdentity(i),r=await this._appIntentHelper.getIntent(t.name,t?.context?.type),o=[];if(n(r)||o.push(...r.apps),!n(s)){if(n(await I(s.appId)))throw new Error(l);if(!o.some((t=>t.appId===s.appId)))throw new Error(d);const e=await this.handleTargetedIntent(s,t,!1,i);return this.shapeIntentResolver(e,a)}if(this._unregisteredApp&&await this.canAddUnregisteredApp(i,t.name,t?.context?.type)&&o.push(this._unregisteredApp),0===o.length)throw e.info("No apps support this intent"),new Error(d);if(1===o.length){const e=await this._clientRegistrationHelper.findAppInstances(o[0],i,"intent");let s;if(1===e.length&&(s=e[0].instanceId),0===e.length||this.useSingleInstance(o[0])||this.createNewInstance(o[0])){const e=await this.launchAppWithIntent(o[0],t,s,i);if(n(e))throw new Error(d);return this.shapeIntentResolver(e,a)}}const p=await(this._intentResolverHelper?.launchIntentResolver({apps:o,intent:t},i));if(n(p))throw new Error(c);const h=await this.handleIntentPickerSelection(p,t,i);return this.shapeIntentResolver(h,a)}async invokeIntentHandler(t,e,i){const{context:s}=i;let a,r;return n(s)||(r={...s},a=r[this._metadataKey],n(a)||delete r[this._metadataKey]),super.invokeIntentHandler(t,e,{...i,context:{...r,contextMetadata:a}})}async fdc3HandleOpen(s,r){if(n(s?.app))throw e.error("A request to fdc3.open did not pass an fdc3OpenOptions object"),new Error(d);e.info(`A request to Open has been sent to the platform by uuid: ${r?.uuid}, name: ${r?.name}, endpointId: ${r.endpointId} with passed context:`,s.context);try{let a,o,p,d,c=!1;i(s.app)?a=s.app:(a=s.app.appId??s.app.name,o=s.app.instanceId);const l=await I(a);if(n(l))throw new Error("AppNotFound");if(!n(o)){const t=(await this.getAllClientInfo()).find((t=>t.endpointId===o));if(n(t))throw new Error(h);e.info(`App Id: ${a} and instance Id: ${o} was provided and found.`),p=[{uuid:t.uuid,name:t.name,appId:a,instanceId:o}]}if("intent"===this._openOptions?.openStrategy){const t={context:s.context,name:"OpenApp",metadata:{target:{appId:a}}},e=await this.launchAppWithIntent(l,t,o,r);i(e.source)?d=e.source:(d=e.source.appId,o=e.source.instanceId)}else{if(n(p)){let e;const i=await y(t.windowPositionOptions,r);n(i)||(e={bounds:i}),p=await v(l?.appId,e)}else c=!0;if(!n(p)&&p?.length>0){d=p[0].appId;const i=this._openOptions?.connectionTimeout;if(o=await this._clientRegistrationHelper.onConnectionClientReady(p[0],i),p.length>1&&e.warn("Open can only return one app and instance id and multiple instances were launched as a result. Returning the first instance. Returned instances: ",p),!n(s?.context)){const i=t?.intentOptions?.intentTimeout,a=s.context.type,o=await this._clientRegistrationHelper.onContextClientReady(p[0],a,i);let c=this._clientRegistrationHelper.getRegisteredContextHandler(a,o);if(n(c)&&(c=this._clientRegistrationHelper.getRegisteredContextHandler("*",o)),n(c))e.warn(`Unable to send context of type ${a} opened app ${d} with instanceId of ${o} as we cannot find a tracked context handler.`);else{const t=await this.processContext(s.context),e=await this.getContextMetadata(r),n={...t,[this._metadataKey]:e};await this.invokeContextHandler(c.clientIdentity,c.handlerId,n)}}}}if(!n(d))return!c||n(p)||n(g?.bringAppToFront)||await g.bringAppToFront(l,p),{appId:d,instanceId:o};throw new Error("ErrorOnLaunch")}catch(t){const e=a(t);if(e===h||e===u||e===h||e===p)throw new Error(p);throw t}}async clientDisconnected(t){await this._clientRegistrationHelper.clientDisconnected(t),await super.clientDisconnected(t)}async fdc3HandleFindInstances(t,e){return this._clientRegistrationHelper.findAppInstances(t,e)}async fdc3HandleGetAppMetadata(t,i){e.info("fdc3HandleGetAppMetadata call received.",t,i);let a=await I(t.appId);if(n(a)&&t.appId===this._unregisteredApp?.appId&&(a=this._unregisteredApp),!n(a)){const i=o(a);if(!n(t.instanceId)){const a=(await this.getAllClientInfo()).find((e=>e.endpointId===t.instanceId));if(!n(a)&&a.uuid===fin.me.identity.uuid){const o={uuid:a.uuid,name:a.name};let p,d;try{if("window"===a.entityType){const t=fin.Window.wrapSync(o);await t.isShowing()&&(p=(await t.getInfo()).title,d=await this.getPreviewImage(t))}else{const t=fin.View.wrapSync(o);p=(await t.getInfo()).title,d=await this.getPreviewImage(t)}}catch(n){e.warn(`A connected client could not be queried for data. It could be it hasn't unregistered itself from the broker. AppId: ${t.appId}, instanceId: ${t.instanceId}, name: ${o.name}`,n)}return n(p)||(p=s(r=p)?r.replace(/<[^>]*>?/gm,"").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/&nbsp;/g," ").replace(/\n\s*\n/g,"\n"):""),{...i,instanceId:t.instanceId,instanceMetadata:{title:p,preview:d}}}}return i}var r;throw new Error("TargetAppUnavailable")}async fdc3HandleGetInfo(t,i){if(e.info("fdc3HandleGetInfo",t,i),"2.0"===t?.fdc3Version){const e=await super.fdc3HandleGetInfo(t,i),s=await this.lookupAppId(i);return n(s)?e:{...e,appMetadata:{appId:s,instanceId:i.endpointId}}}return super.fdc3HandleGetInfo(t,i)}async intentHandlerRegistered(t,e){await this._clientRegistrationHelper.intentHandlerRegistered(t,e),await super.intentHandlerRegistered(t,e)}async contextHandlerRegistered(t,e){await this._clientRegistrationHelper.contextHandlerRegistered(t,e),super.contextHandlerRegistered(t,e)}async launchAppWithIntent(i,s,a,r){e.info("Launching app with intent");let o,p=[],d=!0;if(n(s?.context)||(s.context=await this.processContext(s.context),n(r)||(o=await this.getContextMetadata(r),s.context={...s.context,[this._metadataKey]:o})),!n(a)){const t=(await this.getAllClientInfo()).find((t=>t.endpointId===a));if(n(t))throw new Error(h);e.info(`App Id: ${i.appId} and instance Id: ${a} was provided and found.`),p.push({uuid:t.uuid,name:t.name,appId:i.appId,instanceId:t.endpointId})}if(0===p.length){let o;const c=await y(t.windowPositionOptions,r);if(n(c)||(o={bounds:c}),p=await v(i.appId,o),!p?.length)throw new Error(u);if(d=!1,1===p.length){const n=t?.intentOptions?.intentTimeout;try{a=await this._clientRegistrationHelper.onIntentClientReady(p[0],s.name,n)}catch(t){throw e.warn("An error occurred while getting a instance to target an intent at.",t),new Error(u)}}}for(const t of p)if(await super.setIntentTarget(s,t),d)try{g.bringAppToFront&&await g.bringAppToFront(i,[t])}catch(n){e.warn(`There was an error bringing app: ${t.appId}, and instance ${t.instanceId} with name: ${t.name} to front.`,n)}return{source:{appId:i.appId,instanceId:a},version:i.version,intent:s.name}}async handleIntentPickerSelection(t,e,i){let s=await I(t.appId);if(n(s)&&!n(this._unregisteredApp)&&(s=this._unregisteredApp),n(s))throw new Error(d);const a=t.instanceId,r=await this.launchAppWithIntent(s,e,a,i);if(n(r))throw new Error(d);return r}async handleTargetedIntent(t,i,a,r){const o=[];let p=await I(t.appId);if(n(p)){if(n(t.instanceId)||t.appId!==this._unregisteredApp?.appId)throw new Error(l);p=this._unregisteredApp}if(!n(t.instanceId)){const e=await this._clientRegistrationHelper.findAppInstances(t,r,"intent");if(0===e.length||!e.some((e=>e.appId===t.appId&&e.instanceId===t.instanceId)))throw new Error(h)}if(!Array.isArray(p.intents)||0===p.intents.length)throw new Error(l);const d=p.intents.filter((t=>{let e=!0;const s=i.context?.type;return(!n(s)&&(e=t.contexts?.includes(s),a)||t.name===i.name)&&e}));if(0===d.length)throw new Error(l);if(1===d.length){if(i.name=d[0].name,!n(t.instanceId))return await this.launchAppWithIntent(p,i,t.instanceId,r);const e=await this._clientRegistrationHelper.findAppInstances(p,r,"intent"),s=1===e.length&&this.useSingleInstance(p);if(0===e.length||this.createNewInstance(p)||s){const t=await this.launchAppWithIntent(p,i,void 0,r);if(n(t))throw new Error(u);return t}}for(const t of d){const e={apps:[p],intent:{name:t.name,displayName:t.displayName}};o.push(e)}let f;if(1===o.length?(s(i.name)||n(o[0]?.intent?.name)||n(i?.context)||n(i?.context?.type)||(e.info(`A request to raise an intent was passed and the intent name was not passed but a context was ${i?.context?.type} with 1 matching intent. Name: ${o[0]?.intent?.name},  Display Name: ${o[0]?.intent?.displayName}. Updating intent object.`),i.name=o[0]?.intent?.name),f=await(this._intentResolverHelper?.launchIntentResolver({apps:o[0].apps,intent:i},r))):(f=await(this._intentResolverHelper?.launchIntentResolver({intent:i,intents:o},r)),s(i.name)||n(f?.intent?.name)||(e.info(`A request to raise an intent was passed and the following intent was selected (from a selection of ${o.length}). Name: ${f?.intent?.name},  Display Name: ${f?.intent?.displayName}. Updating intent object.`),i.name=f?.intent?.name??i.name)),n(f))throw new Error(c);return this.handleIntentPickerSelection(f,i,r)}shapeIntentResolver(t,e){return e?t:{source:t.source.appId,version:t.version}}useSingleInstance(t){return"single"===t?.instanceMode}createNewInstance(t){return"new"===t?.instanceMode}async getPreviewImage(t){try{const e=await t.capturePage({format:"jpg",quality:85});if(s(e))return e}catch(n){e.error(`Error while trying to capture a preview image of the view/window: ${t.identity.name}`,n)}}async getUnregisteredAppIntentByContext(t,e){const i=[],s=[];if(n(this?._unregisteredApp))return i;if(Array.isArray(this?._unregisteredApp?.intents))for(const e of this._unregisteredApp.intents)if(e.contexts.includes(t)){const t=e.name;i.push(t)}if(i.length>0)for(const t of i)await this.canAddUnregisteredApp(e,t)&&s.push(t);return s}async canAddUnregisteredApp(t,e,i){if(n(this?._unregisteredApp))return!1;const s=this._unregisteredApp?.interop?.intents?.listensFor;return!(!n(e)&&(n(s)||n(s[e])))&&!!(n(i)||n(s)||n(e)||s[e].contexts.includes(i))&&(await this._clientRegistrationHelper.findAppInstances({appId:this._unregisteredApp.appId},t,"intent")).length>0}getApplicationIdentity(t){const e=t?.target;if(!n(e)){if(i(e)){if(0===e.trim().length)return;return{appId:e}}if(!n(e.appId))return{appId:e.appId,instanceId:e.instanceId}}}usesApplicationIdentity(t){const e=this._clientRegistrationHelper.getApiVersion(t);return!n(e)&&"fdc3"===e.type&&"2.0"===e.version}async lookupAppId(t){const i=t.name.split("/");let s;1!==i.length&&2!==i.length||(s=await I(i[0])),i.length>2&&(s=await I(`${i[0]}/${i[1]}`));const a=n(s);if(a&&t.uuid!==fin.me.identity.uuid)e.warn("Lookup made by a non-registered app that is outside of this platform.",t);else{if(!a||!n(this._unregisteredApp))return a&&(s=this._unregisteredApp,e.info("Assigned the following unregistered app to represent the app.",s)),s?.appId;e.warn("Lookup made by a non-registered app that falls under this platform. No unregistered placeholder app is specified.",t)}}async processContext(t){if(n(A))return t;const i=`interopbroker.process.${t.type}`;if(A.hasEndpoint(i)){e.info(`Processing context ${t.type} with endpoint ${i}`);const n=await A.requestResponse(i,{context:t});if(n?.context)return n?.context}return t}async getContextMetadata(t){return{source:{appId:await this.lookupAppId(t)??t.name,instanceId:t.endpointId}}}}}(t,this._logger,this._helpers)}}};var v=e.k;export{v as entryPoints};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVNGLEtBQUt3SixTQUMzRCxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BlbmZpbi13b3Jrc3BhY2UtLXdvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL29wZW5maW4td29ya3NwYWNlLS13b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vb3BlbmZpbi13b3Jrc3BhY2UtLXdvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vb3BlbmZpbi13b3Jrc3BhY2UtLXdvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyLy4vY2xpZW50L3NyYy9mcmFtZXdvcmsvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vb3BlbmZpbi13b3Jrc3BhY2UtLXdvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyLy4vY2xpZW50L3NyYy9mcmFtZXdvcmsvZmRjMy8xLjIvbWFwcGVyLnRzIiwid2VicGFjazovL29wZW5maW4td29ya3NwYWNlLS13b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci8uL2NsaWVudC9zcmMvZnJhbWV3b3JrL2ZkYzMvMi4wL21hcHBlci50cyIsIndlYnBhY2s6Ly9vcGVuZmluLXdvcmtzcGFjZS0td29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvLi9jbGllbnQvc3JjL2ZyYW1ld29yay9mZGMzL2Vycm9ycy50cyIsIndlYnBhY2s6Ly9vcGVuZmluLXdvcmtzcGFjZS0td29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvLi9jbGllbnQvc3JjL2ZyYW1ld29yay9tYW5pZmVzdC10eXBlcy50cyIsIndlYnBhY2s6Ly9vcGVuZmluLXdvcmtzcGFjZS0td29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvLi9jbGllbnQvc3JjL2ZyYW1ld29yay91dGlscy1wb3NpdGlvbi50cyIsIndlYnBhY2s6Ly9vcGVuZmluLXdvcmtzcGFjZS0td29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvLi9jbGllbnQvc3JjL21vZHVsZXMvaW50ZXJvcC1vdmVycmlkZS93cHMtaW50ZXJvcC1vdmVycmlkZS9icm9rZXIvYXBwLWludGVudC1oZWxwZXIudHMiLCJ3ZWJwYWNrOi8vb3BlbmZpbi13b3Jrc3BhY2UtLXdvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyLy4vY2xpZW50L3NyYy9tb2R1bGVzL2ludGVyb3Atb3ZlcnJpZGUvd3BzLWludGVyb3Atb3ZlcnJpZGUvYnJva2VyL2NsaWVudC1yZWdpc3RyYXRpb24taGVscGVyLnRzIiwid2VicGFjazovL29wZW5maW4td29ya3NwYWNlLS13b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci8uL2NsaWVudC9zcmMvbW9kdWxlcy9pbnRlcm9wLW92ZXJyaWRlL3dwcy1pbnRlcm9wLW92ZXJyaWRlL2Jyb2tlci9pbnRlbnQtcmVzb2x2ZXItaGVscGVyLnRzIiwid2VicGFjazovL29wZW5maW4td29ya3NwYWNlLS13b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci8uL2NsaWVudC9zcmMvbW9kdWxlcy9pbnRlcm9wLW92ZXJyaWRlL3dwcy1pbnRlcm9wLW92ZXJyaWRlL2luZGV4LnRzIiwid2VicGFjazovL29wZW5maW4td29ya3NwYWNlLS13b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci8uL2NsaWVudC9zcmMvbW9kdWxlcy9pbnRlcm9wLW92ZXJyaWRlL3dwcy1pbnRlcm9wLW92ZXJyaWRlL2ludGVyb3Atb3ZlcnJpZGUudHMiLCJ3ZWJwYWNrOi8vb3BlbmZpbi13b3Jrc3BhY2UtLXdvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyLy4vY2xpZW50L3NyYy9tb2R1bGVzL2ludGVyb3Atb3ZlcnJpZGUvd3BzLWludGVyb3Atb3ZlcnJpZGUvYnJva2VyL3dwcy1pbnRlcm9wLW92ZXJyaWRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLyoqXG4gKiBUZXN0IGlmIGEgdmFsdWUgaXMgYSB1bmRlZmluZWQgb3IgbnVsbC5cbiAqIEBwYXJhbSB2YWx1ZSBUaGUgdmFsdWUgdG8gdGVzdC5cbiAqIEByZXR1cm5zIFRydWUgaWYgdGhlIHZhbHVlIGlzIG51bGwgb3IgdW5kZWZpbmVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFbXB0eSh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIG51bGwgfCB1bmRlZmluZWQge1xuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1zeW50YXhcblx0cmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGw7XG59XG5cbi8qKlxuICogVGVzdCBpZiBhIHZhbHVlIGlzIGFuIG9iamVjdC5cbiAqIEBwYXJhbSB2YWx1ZSBUaGUgdmFsdWUgdG8gdGVzdC5cbiAqIEByZXR1cm5zIFRydWUgaWYgdGhlIHZhbHVlIGlzIGFuIG9iamVjdC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgb2JqZWN0IHtcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtc3ludGF4XG5cdHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG59XG5cbi8qKlxuICogVGVzdCBpZiBhIHZhbHVlIGlzIGEgc3RyaW5nLlxuICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0byB0ZXN0LlxuICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgdmFsdWUgaXMgYSBzdHJpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1N0cmluZyh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIHN0cmluZyB7XG5cdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuXHRyZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCI7XG59XG5cbi8qKlxuICogVGVzdCBpZiBhIHZhbHVlIGlzIGEgc3RyaW5nIHRoYXQgaXMgbm90IGVtcHR5LlxuICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0byB0ZXN0LlxuICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgdmFsdWUgaXMgYSBzdHJpbmcgdGhhdCBpcyBub3QgZW1wdHkuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1N0cmluZ1ZhbHVlKHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgc3RyaW5nIHtcblx0cmV0dXJuIGlzU3RyaW5nKHZhbHVlKSAmJiB2YWx1ZS50cmltKCkubGVuZ3RoID4gMDtcbn1cblxuLyoqXG4gKiBUZXN0IGlmIGEgdmFsdWUgaXMgYSBudW1iZXIuXG4gKiBAcGFyYW0gdmFsdWUgVGhlIHZhbHVlIHRvIHRlc3QuXG4gKiBAcmV0dXJucyBUcnVlIGlmIHRoZSB2YWx1ZSBpcyBhIG51bWJlci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgbnVtYmVyIHtcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtc3ludGF4XG5cdHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIjtcbn1cblxuLyoqXG4gKiBUZXN0IGlmIGEgdmFsdWUgaXMgYSBudW1iZXIgd2l0aCBhIHJlYWwgdmFsdWUgaS5lLiBub3QgTmFOIG9yIEluZmluaXRlLlxuICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0byB0ZXN0LlxuICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgdmFsdWUgaXMgYSBudW1iZXIuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc051bWJlclZhbHVlKHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgbnVtYmVyIHtcblx0cmV0dXJuIGlzTnVtYmVyKHZhbHVlKSAmJiAhTnVtYmVyLmlzTmFOKHZhbHVlKSAmJiBOdW1iZXIuaXNGaW5pdGUodmFsdWUpO1xufVxuXG4vKipcbiAqIFRlc3QgaWYgYSB2YWx1ZSBpcyBhIGJvb2xlYW4uXG4gKiBAcGFyYW0gdmFsdWUgVGhlIHZhbHVlIHRvIHRlc3QuXG4gKiBAcmV0dXJucyBUcnVlIGlmIHRoZSB2YWx1ZSBpcyBhIGJvb2xlYW4uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Jvb2xlYW4odmFsdWU6IHVua25vd24pOiB2YWx1ZSBpcyBib29sZWFuIHtcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtc3ludGF4XG5cdHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJib29sZWFuXCI7XG59XG5cbi8qKlxuICogVGVzdCBpZiBhIHZhbHVlIGlzIGFuIGludGVnZXIuXG4gKiBAcGFyYW0gdmFsdWUgVGhlIHZhbHVlIHRvIHRlc3QuXG4gKiBAcmV0dXJucyBUcnVlIGlmIHRoZSB2YWx1ZSBpcyBhbiBpbnRlZ2VyLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNJbnRlZ2VyKHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgbnVtYmVyIHtcblx0cmV0dXJuIGlzTnVtYmVyKHZhbHVlKSAmJiBOdW1iZXIuaXNJbnRlZ2VyKHZhbHVlKTtcbn1cblxuLyoqXG4gKiBEZWVwIGNsb25lIGFuIG9iamVjdC5cbiAqIEBwYXJhbSBvYmogVGhlIG9iamVjdCB0byBjbG9uZS5cbiAqIEByZXR1cm5zIFRoZSBjbG9uZSBvZiB0aGUgb2JqZWN0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gb2JqZWN0Q2xvbmU8VD4ob2JqOiBUKTogVCB7XG5cdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuXHRyZXR1cm4gb2JqID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iaikpO1xufVxuXG4vKipcbiAqIERvIGEgZGVlcCBjb21wYXJpc29uIG9mIHRoZSBvYmplY3RzLlxuICogQHBhcmFtIG9iajEgVGhlIGZpcnN0IG9iamVjdCB0byBjb21wYXJlLlxuICogQHBhcmFtIG9iajIgVGhlIHNlY29uZCBvYmplY3QgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSBtYXRjaFByb3BlcnR5T3JkZXIgSWYgdHJ1ZSB0aGUgcHJvcGVydGllcyBtdXN0IGJlIGluIHRoZSBzYW1lIG9yZGVyLlxuICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgb2JqZWN0cyBhcmUgdGhlIHNhbWUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWVwRXF1YWwob2JqMTogdW5rbm93biwgb2JqMjogdW5rbm93biwgbWF0Y2hQcm9wZXJ0eU9yZGVyOiBib29sZWFuID0gdHJ1ZSk6IGJvb2xlYW4ge1xuXHRpZiAoaXNPYmplY3Qob2JqMSkgJiYgaXNPYmplY3Qob2JqMikpIHtcblx0XHRjb25zdCBvYmpLZXlzMSA9IE9iamVjdC5rZXlzKG9iajEpO1xuXHRcdGNvbnN0IG9iaktleXMyID0gT2JqZWN0LmtleXMob2JqMik7XG5cblx0XHRpZiAob2JqS2V5czEubGVuZ3RoICE9PSBvYmpLZXlzMi5sZW5ndGgpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAobWF0Y2hQcm9wZXJ0eU9yZGVyICYmIEpTT04uc3RyaW5naWZ5KG9iaktleXMxKSAhPT0gSlNPTi5zdHJpbmdpZnkob2JqS2V5czIpKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Zm9yIChjb25zdCBrZXkgb2Ygb2JqS2V5czEpIHtcblx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cdFx0XHRjb25zdCB2YWx1ZTEgPSAob2JqMSBhcyBhbnkpW2tleV07XG5cdFx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXHRcdFx0Y29uc3QgdmFsdWUyID0gKG9iajIgYXMgYW55KVtrZXldO1xuXG5cdFx0XHRpZiAoIWRlZXBFcXVhbCh2YWx1ZTEsIHZhbHVlMiwgbWF0Y2hQcm9wZXJ0eU9yZGVyKSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0cnVlO1xuXHR9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkob2JqMSkgJiYgQXJyYXkuaXNBcnJheShvYmoyKSkge1xuXHRcdGlmIChvYmoxLmxlbmd0aCAhPT0gb2JqMi5sZW5ndGgpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBvYmoxLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAoIWRlZXBFcXVhbChvYmoxW2ldLCBvYmoyW2ldLCBtYXRjaFByb3BlcnR5T3JkZXIpKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqMSkgPT09IEpTT04uc3RyaW5naWZ5KG9iajIpO1xufVxuXG4vKipcbiAqIERlZXAgbWVyZ2UgdHdvIG9iamVjdHMuXG4gKiBAcGFyYW0gdGFyZ2V0IFRoZSBvYmplY3QgdG8gYmUgbWVyZ2VkIGludG8uXG4gKiBAcGFyYW0gc291cmNlcyBUaGUgb2JqZWN0cyB0byBtZXJnZSBpbnRvIHRoZSB0YXJnZXQuXG4gKiBAcmV0dXJucyBUaGUgbWVyZ2VkIG9iamVjdC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlZXBNZXJnZTxUID0gdW5rbm93bj4odGFyZ2V0OiBULCAuLi5zb3VyY2VzOiBUW10pOiBUIHtcblx0aWYgKCFBcnJheS5pc0FycmF5KHNvdXJjZXMpIHx8IHNvdXJjZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0cmV0dXJuIHRhcmdldDtcblx0fVxuXG5cdGNvbnN0IHRhcmdldEFzTWFwID0gdGFyZ2V0IGFzIHsgW2lkOiBzdHJpbmddOiB1bmtub3duIH07XG5cdGNvbnN0IHNvdXJjZSA9IHNvdXJjZXMuc2hpZnQoKTtcblxuXHRsZXQga2V5cztcblx0aWYgKGlzT2JqZWN0KHRhcmdldEFzTWFwKSAmJiBpc09iamVjdChzb3VyY2UpKSB7XG5cdFx0a2V5cyA9IE9iamVjdC5rZXlzKHNvdXJjZSk7XG5cdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShzb3VyY2UpKSB7XG5cdFx0aWYgKCFBcnJheS5pc0FycmF5KHRhcmdldCkpIHtcblx0XHRcdHJldHVybiBzb3VyY2U7XG5cdFx0fVxuXHRcdGtleXMgPSBPYmplY3Qua2V5cyhzb3VyY2UpLm1hcCgoaykgPT4gTnVtYmVyLnBhcnNlSW50KGssIDEwKSk7XG5cdH1cblxuXHRpZiAoa2V5cykge1xuXHRcdGNvbnN0IHNvdXJjZUFzTWFwID0gc291cmNlIGFzIHsgW2lkOiBzdHJpbmddOiB1bmtub3duIH07XG5cdFx0Zm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuXHRcdFx0Y29uc3QgdmFsdWUgPSBzb3VyY2VBc01hcFtrZXldO1xuXHRcdFx0aWYgKGlzT2JqZWN0KHZhbHVlKSkge1xuXHRcdFx0XHRpZiAoaXNFbXB0eSh0YXJnZXRBc01hcFtrZXldKSkge1xuXHRcdFx0XHRcdHRhcmdldEFzTWFwW2tleV0gPSB7fTtcblx0XHRcdFx0fVxuXHRcdFx0XHRkZWVwTWVyZ2UodGFyZ2V0QXNNYXBba2V5XSwgdmFsdWUpO1xuXHRcdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuXHRcdFx0XHRpZiAoaXNFbXB0eSh0YXJnZXRBc01hcFtrZXldKSkge1xuXHRcdFx0XHRcdHRhcmdldEFzTWFwW2tleV0gPSBbXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRkZWVwTWVyZ2UodGFyZ2V0QXNNYXBba2V5XSwgdmFsdWUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGFyZ2V0QXNNYXBba2V5XSA9IHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiBkZWVwTWVyZ2UodGFyZ2V0LCAuLi5zb3VyY2VzKTtcbn1cblxuLyoqXG4gKiBQb2x5ZmlsbHMgcmFuZG9tVVVJRCBpZiBydW5uaW5nIGluIGEgbm9uLXNlY3VyZSBjb250ZXh0LlxuICogQHJldHVybnMgVGhlIHJhbmRvbSBVVUlELlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tVVVJRCgpOiBzdHJpbmcge1xuXHRpZiAoXCJyYW5kb21VVUlEXCIgaW4gZ2xvYmFsVGhpcy5jcnlwdG8pIHtcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1zeW50YXhcblx0XHRyZXR1cm4gZ2xvYmFsVGhpcy5jcnlwdG8ucmFuZG9tVVVJRCgpO1xuXHR9XG5cdC8vIFBvbHlmaWxsIHRoZSB3aW5kb3cuY3J5cHRvLnJhbmRvbVVVSUQgaWYgd2UgYXJlIHJ1bm5pbmcgaW4gYSBub24gc2VjdXJlIGNvbnRleHQgdGhhdCBkb2Vzbid0IGhhdmUgaXRcblx0Ly8gd2UgYXJlIHN0aWxsIHVzaW5nIHdpbmRvdy5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzIHdoaWNoIGlzIGFsd2F5cyBhdmFpbGFibGVcblx0Ly8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIxMTc1MjMvMjgwMDIxOFxuXHQvKipcblx0ICogR2V0IHJhbmRvbSBoZXggdmFsdWUuXG5cdCAqIEBwYXJhbSBjIFRoZSBudW1iZXIgdG8gYmFzZSB0aGUgcmFuZG9tIHZhbHVlIG9uLlxuXHQgKiBAcmV0dXJucyBUaGUgcmFuZG9tIHZhbHVlLlxuXHQgKi9cblx0ZnVuY3Rpb24gZ2V0UmFuZG9tSGV4KGM6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWJpdHdpc2Vcblx0XHRjb25zdCBybmQgPSBnbG9iYWxUaGlzLmNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMSkpWzBdICYgKDE1ID4+IChOdW1iZXIoYykgLyA0KSk7XG5cdFx0cmV0dXJuIChcblx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1iaXR3aXNlXG5cdFx0XHQoTnVtYmVyKGMpIF4gcm5kKS50b1N0cmluZygxNilcblx0XHQpO1xuXHR9XG5cdHJldHVybiBcIjEwMDAwMDAwLTEwMDAtNDAwMC04MDAwLTEwMDAwMDAwMDAwMFwiLnJlcGxhY2UoL1swMThdL2csIGdldFJhbmRvbUhleCk7XG59XG5cbi8qKlxuICogRm9ybWF0IGFuIGVycm9yIHRvIGEgcmVhZGFibGUgc3RyaW5nLlxuICogQHBhcmFtIGVyciBUaGUgZXJyb3IgdG8gZm9ybWF0LlxuICogQHJldHVybnMgVGhlIGZvcm1hdHRlZCBlcnJvci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdEVycm9yKGVycjogdW5rbm93bik6IHN0cmluZyB7XG5cdGlmIChpc0VtcHR5KGVycikpIHtcblx0XHRyZXR1cm4gXCJcIjtcblx0fSBlbHNlIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvcikge1xuXHRcdHJldHVybiBlcnIubWVzc2FnZTtcblx0fSBlbHNlIGlmIChpc1N0cmluZ1ZhbHVlKGVycikpIHtcblx0XHRyZXR1cm4gZXJyO1xuXHR9IGVsc2UgaWYgKGlzT2JqZWN0KGVycikgJiYgXCJtZXNzYWdlXCIgaW4gZXJyICYmIGlzU3RyaW5nKGVyci5tZXNzYWdlKSkge1xuXHRcdHJldHVybiBlcnIubWVzc2FnZTtcblx0fVxuXHRyZXR1cm4gSlNPTi5zdHJpbmdpZnkoZXJyKTtcbn1cblxuLyoqXG4gKiBBIGJhc2ljIHN0cmluZyBzYW5pdGl6ZSBmdW5jdGlvbiB0aGF0IHJlbW92ZXMgYW5nbGUgYnJhY2tldHMgPD4gZnJvbSBhIHN0cmluZy5cbiAqIEBwYXJhbSBjb250ZW50IHRoZSBjb250ZW50IHRvIHNhbml0aXplXG4gKiBAcmV0dXJucyBhIHN0cmluZyB3aXRob3V0IGFuZ2xlIGJyYWNrZXRzIDw+XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzYW5pdGl6ZVN0cmluZyhjb250ZW50OiB1bmtub3duKTogc3RyaW5nIHtcblx0aWYgKGlzU3RyaW5nVmFsdWUoY29udGVudCkpIHtcblx0XHRyZXR1cm4gY29udGVudFxuXHRcdFx0LnJlcGxhY2UoLzxbXj5dKj4/L2dtLCBcIlwiKVxuXHRcdFx0LnJlcGxhY2UoLyZndDsvZywgXCI+XCIpXG5cdFx0XHQucmVwbGFjZSgvJmx0Oy9nLCBcIjxcIilcblx0XHRcdC5yZXBsYWNlKC8mYW1wOy9nLCBcIiZcIilcblx0XHRcdC5yZXBsYWNlKC8mbmJzcDsvZywgXCIgXCIpXG5cdFx0XHQucmVwbGFjZSgvXFxuXFxzKlxcbi9nLCBcIlxcblwiKTtcblx0fVxuXHRyZXR1cm4gXCJcIjtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGNvbW1hbmQgbGluZSBhcmd1bWVudHMgZnJvbSBhIGNvbW1hbmQgbGluZSBzdHJpbmcuXG4gKiBFeGFtcGxlcyBvZiBjb21tYW5kIGxpbmUgc3RyaW5nczogYXJnMSBrZXkxPXZhbHVlMSBrZXkyPVwidmFsdWUgd2l0aCBzcGFjZXNcIiBrZXkzPSd2YWx1ZTMnIGtleTQ9J3ZhbHVlIHdpdGggbW9yZSBzcGFjZXMnYC5cbiAqIEBwYXJhbSBjb21tYW5kTGluZSBUaGUgY29tbWFuZCBsaW5lIHN0cmluZy5cbiAqIEByZXR1cm5zIFRoZSBjb21tYW5kIGxpbmUgYXJndW1lbnRzIG9yIGFuIGVtcHR5IGFycmF5IGlmIG5vbmVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbW1hbmRMaW5lQXJncyhjb21tYW5kTGluZTogc3RyaW5nKTogc3RyaW5nW10ge1xuXHRpZiAoIWlzU3RyaW5nVmFsdWUoY29tbWFuZExpbmUpKSB7XG5cdFx0cmV0dXJuIFtdO1xuXHR9XG5cdGNvbnN0IG1hdGNoZXMgPSBjb21tYW5kTGluZS5tYXRjaCgvKFxcdys9KT8oXCJbXlwiXSpcInwnW14nXSonfFteIF0rKS9nKTtcblx0aWYgKGlzRW1wdHkobWF0Y2hlcykpIHtcblx0XHRyZXR1cm4gW107XG5cdH1cblx0cmV0dXJuIG1hdGNoZXM7XG59XG4iLCJpbXBvcnQgdHlwZSB7IEltYWdlIH0gZnJvbSBcIkBvcGVuZmluL3dvcmtzcGFjZVwiO1xuaW1wb3J0IHR5cGUgeyBQbGF0Zm9ybUFwcCB9IGZyb20gXCIuLi8uLi9zaGFwZXMvYXBwLXNoYXBlc1wiO1xuaW1wb3J0IHR5cGUge1xuXHRBcHBEZWZpbml0aW9uLFxuXHRBcHBJY29uLFxuXHRBcHBJbWFnZSxcblx0QXBwSW50ZW50cyxcblx0QXBwTWV0YWRhdGEsXG5cdEN1c3RvbUNvbmZpZ1xufSBmcm9tIFwiLi4vLi4vc2hhcGVzL2ZkYzMtMS0yLXNoYXBlc1wiO1xuaW1wb3J0IHR5cGUgeyBBcHBJbnRlcm9wLCBBcHBJbnRlbnRzIGFzIEZEQzNUd29Qb2ludFplcm9BcHBJbnRlbnRzIH0gZnJvbSBcIi4uLy4uL3NoYXBlcy9mZGMzLTItMC1zaGFwZXNcIjtcbmltcG9ydCB7IGlzQm9vbGVhbiwgaXNFbXB0eSwgaXNTdHJpbmdWYWx1ZSB9IGZyb20gXCIuLi8uLi91dGlsc1wiO1xuXG4vKipcbiAqIE1hcCB0aGUgYXBwIGRlZmluaXRpb24gdG8gYSBwbGF0Zm9ybSBhcHAuXG4gKiBAcGFyYW0gYXBwIFRoZSBhcHAgZGVmaW5pdGlvbiB0byBtYXAuXG4gKiBAcmV0dXJucyBUaGUgcGxhdGZvcm0gYXBwLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwVG9QbGF0Zm9ybUFwcChhcHA6IEFwcERlZmluaXRpb24pOiBQbGF0Zm9ybUFwcCB7XG5cdGNvbnN0IHBsYXRmb3JtQXBwOiBQbGF0Zm9ybUFwcCA9IHtcblx0XHRhcHBJZDogYXBwLmFwcElkLFxuXHRcdG5hbWU6IGFwcC5uYW1lID8/IGFwcC5hcHBJZCxcblx0XHR0aXRsZTogYXBwLnRpdGxlID8/IGFwcC5uYW1lLFxuXHRcdG1hbmlmZXN0VHlwZTogYXBwLm1hbmlmZXN0VHlwZSxcblx0XHRtYW5pZmVzdDogZ2V0TWFuaWZlc3RGcm9tRkRDMyhhcHApIGFzIHN0cmluZyxcblx0XHRkZXNjcmlwdGlvbjogYXBwLmRlc2NyaXB0aW9uLFxuXHRcdGN1c3RvbUNvbmZpZzogYXBwLmN1c3RvbUNvbmZpZyxcblx0XHRpbnRlbnRzOiBhcHAuaW50ZW50cyxcblx0XHRpbnRlcm9wOiBtYXBJbnRlcm9wRnJvbUZEQzMoYXBwLmludGVudHMpLFxuXHRcdHRhZ3M6IG1hcFRhZ3NGcm9tRkRDMyhhcHApLFxuXHRcdHZlcnNpb246IGFwcC52ZXJzaW9uLFxuXHRcdHB1Ymxpc2hlcjogYXBwLnB1Ymxpc2hlciA/PyBcIlwiLFxuXHRcdGNvbnRhY3RFbWFpbDogYXBwLmNvbnRhY3RFbWFpbCxcblx0XHRzdXBwb3J0RW1haWw6IGFwcC5zdXBwb3J0RW1haWwsXG5cdFx0aWNvbnM6IG1hcEljb25zRnJvbUZEQzMoYXBwLmljb25zKSxcblx0XHRpbWFnZXM6IG1hcEltYWdlc0Zyb21GREMzKGFwcC5pbWFnZXMpLFxuXHRcdHByaXZhdGU6IG1hcFByaXZhdGVGcm9tRkRDMyhhcHApLFxuXHRcdGF1dG9zdGFydDogbWFwQXV0b3N0YXJ0RnJvbUZEQzMoYXBwKSxcblx0XHRpbnN0YW5jZU1vZGU6IGFwcC5jdXN0b21Db25maWc/Lmluc3RhbmNlTW9kZSxcblx0XHR0b29sdGlwOiBhcHAudG9vbHRpcCxcblx0XHRsYXVuY2hQcmVmZXJlbmNlOiBhcHAuY3VzdG9tQ29uZmlnPy5sYXVuY2hQcmVmZXJlbmNlXG5cdH07XG5cdHJldHVybiBwbGF0Zm9ybUFwcDtcbn1cblxuLyoqXG4gKiBNYXAgYSBwbGF0Zm9ybSBhcHAgdG8gYW4gRkRDMyAxLjIgYXBwIGRlZmluaXRpb24uXG4gKiBAcGFyYW0gYXBwIFRoZSBhcHAgZGVmaW5pdGlvbiB0byBtYXAuXG4gKiBAcmV0dXJucyBUaGUgZmRjMyAxLjIgYXBwLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwVG9GREMzQXBwKGFwcDogUGxhdGZvcm1BcHApOiBBcHBEZWZpbml0aW9uIHtcblx0Y29uc3QgbWFuaWZlc3RUeXBlOiBzdHJpbmcgPSBgJHthcHAubWFuaWZlc3RUeXBlfWA7XG5cblx0Y29uc3QgZmRjM0FwcDogQXBwRGVmaW5pdGlvbiA9IHtcblx0XHRhcHBJZDogYXBwLmFwcElkLFxuXHRcdG5hbWU6IGFwcC5uYW1lID8/IGFwcC5hcHBJZCxcblx0XHR0aXRsZTogYXBwLnRpdGxlID8/IGFwcC5uYW1lLFxuXHRcdG1hbmlmZXN0VHlwZSxcblx0XHRtYW5pZmVzdDogYXBwLm1hbmlmZXN0IGFzIHN0cmluZyxcblx0XHRkZXNjcmlwdGlvbjogYXBwLmRlc2NyaXB0aW9uLFxuXHRcdGN1c3RvbUNvbmZpZzogbWFwQ3VzdG9tQ29uZmlnRnJvbVBsYXRmb3JtQXBwKGFwcCksXG5cdFx0aW50ZW50czogbWFwSW50ZW50c0Zyb21QbGF0Zm9ybUFwcChhcHApLFxuXHRcdGNhdGVnb3JpZXM6IGFwcC50YWdzID8/IFtdLFxuXHRcdHZlcnNpb246IGFwcC52ZXJzaW9uLFxuXHRcdHB1Ymxpc2hlcjogYXBwLnB1Ymxpc2hlciA/PyBcIlwiLFxuXHRcdGNvbnRhY3RFbWFpbDogYXBwLmNvbnRhY3RFbWFpbCxcblx0XHRzdXBwb3J0RW1haWw6IGFwcC5zdXBwb3J0RW1haWwsXG5cdFx0aWNvbnM6IG1hcEljb25zRnJvbVBsYXRmb3JtQXBwKGFwcCksXG5cdFx0aW1hZ2VzOiBtYXBJbWFnZXNGcm9tUGxhdGZvcm1BcHAoYXBwKSxcblx0XHR0b29sdGlwOiBhcHAudG9vbHRpcFxuXHR9O1xuXHRyZXR1cm4gZmRjM0FwcDtcbn1cblxuLyoqXG4gKiBNYXAgdGhlIHBsYXRmb3JtIGFwcCB0byBhcHAgbWV0YWRhdGEuXG4gKiBAcGFyYW0gYXBwIFRoZSBhcHBsaWNhdGlvbiB0byBtYXAuXG4gKiBAcmV0dXJucyBUaGUgYXBwIG1ldGFkYXRhLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwVG9BcHBNZXRhRGF0YShhcHA6IFBsYXRmb3JtQXBwKTogQXBwTWV0YWRhdGEge1xuXHRjb25zdCBpY29uczogc3RyaW5nW10gPSBbXTtcblx0Y29uc3QgaW1hZ2VzOiBzdHJpbmdbXSA9IFtdO1xuXHRpZiAoQXJyYXkuaXNBcnJheShhcHAuaWNvbnMpKSB7XG5cdFx0Zm9yIChjb25zdCBpY29uIG9mIGFwcC5pY29ucykge1xuXHRcdFx0aWYgKCFpc0VtcHR5KGljb24uc3JjKSkge1xuXHRcdFx0XHRpY29ucy5wdXNoKGljb24uc3JjKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0aWYgKEFycmF5LmlzQXJyYXkoYXBwLmltYWdlcykpIHtcblx0XHRmb3IgKGNvbnN0IGltYWdlIG9mIGFwcC5pbWFnZXMpIHtcblx0XHRcdGlmICghaXNFbXB0eShpbWFnZS5zcmMpKSB7XG5cdFx0XHRcdGltYWdlcy5wdXNoKGltYWdlLnNyYyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdGNvbnN0IGFwcE1ldGFEYXRhOiBBcHBNZXRhZGF0YSA9IHtcblx0XHRhcHBJZDogYXBwLmFwcElkLFxuXHRcdGRlc2NyaXB0aW9uOiBhcHAuZGVzY3JpcHRpb24sXG5cdFx0aWNvbnMsXG5cdFx0aW1hZ2VzLFxuXHRcdG5hbWU6IGFwcC5hcHBJZCxcblx0XHR0aXRsZTogYXBwLnRpdGxlLFxuXHRcdHRvb2x0aXA6IGFwcC50b29sdGlwLFxuXHRcdHZlcnNpb246IGFwcC52ZXJzaW9uXG5cdH07XG5cdHJldHVybiBhcHBNZXRhRGF0YTtcbn1cblxuLyoqXG4gKiBNYXAgdGhlIGFwcCBkZWZpbml0aW9uIGludGVyb3AgZGF0YSB0byBhcHAgaW50ZXJvcCBmb3JtYXQuXG4gKiBAcGFyYW0gaW50ZW50cyBUaGUgaW50ZW50cyB0byBtYXAuXG4gKiBAcmV0dXJucyBUaGUgYXBwIGludGVyb3AuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXBJbnRlcm9wRnJvbUZEQzMoaW50ZW50czogQXBwSW50ZW50c1tdIHwgdW5kZWZpbmVkKTogQXBwSW50ZXJvcCB8IHVuZGVmaW5lZCB7XG5cdGlmIChpc0VtcHR5KGludGVudHMpKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3QgbGlzdGVuc0ZvcjogeyBba2V5OiBzdHJpbmddOiBGREMzVHdvUG9pbnRaZXJvQXBwSW50ZW50cyB9ID0ge307XG5cblx0Zm9yIChjb25zdCBpbnRlbnQgb2YgaW50ZW50cykge1xuXHRcdGxpc3RlbnNGb3JbaW50ZW50Lm5hbWVdID0ge1xuXHRcdFx0Y29udGV4dHM6IGludGVudC5jb250ZXh0cyxcblx0XHRcdGN1c3RvbUNvbmZpZzogaW50ZW50LmN1c3RvbUNvbmZpZyxcblx0XHRcdGRpc3BsYXlOYW1lOiBpbnRlbnQuZGlzcGxheU5hbWVcblx0XHR9O1xuXHR9XG5cblx0Y29uc3QgaW50ZXJvcDogQXBwSW50ZXJvcCA9IHtcblx0XHRpbnRlbnRzOiB7IGxpc3RlbnNGb3IgfVxuXHR9O1xuXG5cdHJldHVybiBpbnRlcm9wO1xufVxuXG4vKipcbiAqIE1hcHMgdGhlIGludGVudHMgZnJvbSBhIHBsYXRmb3JtIGFwcCB0byBhbiBGREMzIDEuMiBpbnRlbnRzIGFycmF5LlxuICogQHBhcmFtIGFwcCBUaGUgcGxhdGZvcm0gYXBwIHRvIHVzZSBhcyBhIHNvdXJjZVxuICogQHJldHVybnMgYW4gQXJyYXkgb2YgSW50ZW50cyBpbiBGREMzIDEuMiBmb3JtYXRcbiAqL1xuZnVuY3Rpb24gbWFwSW50ZW50c0Zyb21QbGF0Zm9ybUFwcChhcHA6IFBsYXRmb3JtQXBwKTogQXBwSW50ZW50c1tdIHtcblx0Y29uc3QgaW50ZW50czogQXBwSW50ZW50c1tdID0gW107XG5cdGNvbnN0IHBhc3NlZEludGVudHMgPSBhcHAuaW50ZXJvcD8uaW50ZW50cz8ubGlzdGVuc0Zvcjtcblx0aWYgKCFpc0VtcHR5KHBhc3NlZEludGVudHMpKSB7XG5cdFx0Y29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHBhc3NlZEludGVudHMpO1xuXHRcdGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcblx0XHRcdGNvbnN0IGRpc3BsYXlOYW1lOiBzdHJpbmcgPSBwYXNzZWRJbnRlbnRzW2tleV0uZGlzcGxheU5hbWUgPz8ga2V5O1xuXHRcdFx0aW50ZW50cy5wdXNoKHtcblx0XHRcdFx0bmFtZToga2V5LFxuXHRcdFx0XHRkaXNwbGF5TmFtZSxcblx0XHRcdFx0Y29udGV4dHM6IHBhc3NlZEludGVudHNba2V5XS5jb250ZXh0cyxcblx0XHRcdFx0Y3VzdG9tQ29uZmlnOiBwYXNzZWRJbnRlbnRzW2tleV0uY3VzdG9tQ29uZmlnXG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0aWYgKGludGVudHMubGVuZ3RoID09PSAwICYmICFpc0VtcHR5KGFwcC5pbnRlbnRzKSkge1xuXHRcdHJldHVybiBhcHAuaW50ZW50cztcblx0fVxuXHRyZXR1cm4gaW50ZW50cztcbn1cblxuLyoqXG4gKiBUYWtlcyBhIHBsYXRmb3JtIGFwcCBhbmQgcmV0dXJucyBhbiBGREMzIGN1c3RvbSBjb25maWcgb2JqZWN0LlxuICogQHBhcmFtIGFwcCBUaGUgcGxhdGZvcm0gYXBwIHRvIG1hcCBpbnRvIGEgY3VzdG9tQ29uZmlnIG9iamVjdC5cbiAqIEByZXR1cm5zIGFuIEZEQzMgMS4yIGN1c3RvbUNvbmZpZyBvYmplY3QgYmFzZWQgb24gdGhlIHBsYXRmb3JtIGFwcCBzZXR0aW5ncy5cbiAqL1xuZnVuY3Rpb24gbWFwQ3VzdG9tQ29uZmlnRnJvbVBsYXRmb3JtQXBwKGFwcDogUGxhdGZvcm1BcHApOiBDdXN0b21Db25maWcge1xuXHRjb25zdCBjb25maWc6IEN1c3RvbUNvbmZpZyA9IHtcblx0XHRhdXRvc3RhcnQ6IG1hcEJvb2xlYW5WYWx1ZShhcHA/LmF1dG9zdGFydCwgZmFsc2UpLnRvU3RyaW5nKCksXG5cdFx0aW5zdGFuY2VNb2RlOiBhcHAuaW5zdGFuY2VNb2RlLFxuXHRcdHByaXZhdGU6IG1hcEJvb2xlYW5WYWx1ZShhcHAucHJpdmF0ZSwgZmFsc2UpLnRvU3RyaW5nKCksXG5cdFx0bGF1bmNoUHJlZmVyZW5jZTogYXBwLmxhdW5jaFByZWZlcmVuY2Vcblx0fTtcblx0cmV0dXJuIGNvbmZpZztcbn1cblxuLyoqXG4gKiBNYXAgdGhlIGljb24gZm9ybWF0LlxuICogQHBhcmFtIGljb25zIFRoZSBpY29ucyB0byBtYXAuXG4gKiBAcmV0dXJucyBUaGUgbWFwcGVkIGljb25zLlxuICovXG5mdW5jdGlvbiBtYXBJY29uc0Zyb21GREMzKGljb25zOiBBcHBJY29uW10gfCB1bmRlZmluZWQpOiBJbWFnZVtdIHtcblx0aWYgKCFBcnJheS5pc0FycmF5KGljb25zKSkge1xuXHRcdHJldHVybiBbXTtcblx0fVxuXHRjb25zdCBhcHBJY29uczogSW1hZ2VbXSA9IFtdO1xuXHRmb3IgKGNvbnN0IGFwcEljb24gb2YgaWNvbnMpIHtcblx0XHRhcHBJY29ucy5wdXNoKHsgc3JjOiBhcHBJY29uLmljb24gfSk7XG5cdH1cblx0cmV0dXJuIGFwcEljb25zO1xufVxuXG4vKipcbiAqIFRha2VzIGEgUGxhdGZvcm0gQXBwIGFuZCBjb252ZXJ0cyBpY29ucyBzbyB0aGV5IGFyZSBpbiBGREMzIDEuMiBmb3JtYXQuXG4gKiBAcGFyYW0gYXBwIFRoZSBwbGF0Zm9ybSBhcHAgdG8gdXNlIGFzIGEgc291cmNlLlxuICogQHJldHVybnMgVGhlIGFycmF5IG9mIGFwcCBpY29ucyBpbiBGREMzIDEuMiBmb3JtYXQuXG4gKi9cbmZ1bmN0aW9uIG1hcEljb25zRnJvbVBsYXRmb3JtQXBwKGFwcDogUGxhdGZvcm1BcHApOiBBcHBJY29uW10ge1xuXHRpZiAoIUFycmF5LmlzQXJyYXkoYXBwLmljb25zKSkge1xuXHRcdHJldHVybiBbXTtcblx0fVxuXHRjb25zdCBhcHBJY29uczogQXBwSWNvbltdID0gW107XG5cdGZvciAoY29uc3QgYXBwSWNvbiBvZiBhcHAuaWNvbnMpIHtcblx0XHRhcHBJY29ucy5wdXNoKHsgaWNvbjogYXBwSWNvbi5zcmMgfSk7XG5cdH1cblx0cmV0dXJuIGFwcEljb25zO1xufVxuXG4vKipcbiAqIE1hcCB0aGUgaW1hZ2UgZm9ybWF0LlxuICogQHBhcmFtIGltYWdlcyBUaGUgaW1hZ2VzIHRvIG1hcC5cbiAqIEByZXR1cm5zIFRoZSBtYXBwZWQgaW1hZ2VzLlxuICovXG5mdW5jdGlvbiBtYXBJbWFnZXNGcm9tRkRDMyhpbWFnZXM6IEFwcEltYWdlW10gfCB1bmRlZmluZWQpOiBJbWFnZVtdIHtcblx0aWYgKCFBcnJheS5pc0FycmF5KGltYWdlcykpIHtcblx0XHRyZXR1cm4gW107XG5cdH1cblx0Y29uc3QgYXBwSW1hZ2VzOiBJbWFnZVtdID0gW107XG5cdGZvciAoY29uc3QgYXBwSW1hZ2Ugb2YgaW1hZ2VzKSB7XG5cdFx0YXBwSW1hZ2VzLnB1c2goeyBzcmM6IGFwcEltYWdlLnVybCB9KTtcblx0fVxuXHRyZXR1cm4gYXBwSW1hZ2VzO1xufVxuXG4vKipcbiAqIFJldHVybnMgYW4gYXJyYXkgb2YgaW1hZ2VzIGluIEZEQzMgMS4yIGZvcm1hdCBmcm9tIGEgUGxhdGZvcm0gQXBwLlxuICogQHBhcmFtIGFwcCBUaGUgcGxhdGZvcm0gYXBwIHRvIHVzZSBhcyBhIHNvdXJjZS5cbiAqIEByZXR1cm5zIFRoZSBtYXBwZWQgaW1hZ2VzLlxuICovXG5mdW5jdGlvbiBtYXBJbWFnZXNGcm9tUGxhdGZvcm1BcHAoYXBwOiBQbGF0Zm9ybUFwcCk6IEFwcEltYWdlW10ge1xuXHRpZiAoIUFycmF5LmlzQXJyYXkoYXBwLmltYWdlcykpIHtcblx0XHRyZXR1cm4gW107XG5cdH1cblx0Y29uc3QgYXBwSW1hZ2VzOiBBcHBJbWFnZVtdID0gW107XG5cdGZvciAoY29uc3QgYXBwSW1hZ2Ugb2YgYXBwLmltYWdlcykge1xuXHRcdGFwcEltYWdlcy5wdXNoKHsgdXJsOiBhcHBJbWFnZS5zcmMgfSk7XG5cdH1cblx0cmV0dXJuIGFwcEltYWdlcztcbn1cblxuLyoqXG4gKiBHZXQgdGhlIG1hbmlmZXN0IHdoaWNoIGNhbiBiZSBwbGFpbiBzdHJpbmcgb3IgSlNPTi5cbiAqIEBwYXJhbSBhcHAgVGhlIGFwcCB0byBnZXQgdGhlIG1hbmlmZXN0IGZyb20uXG4gKiBAcmV0dXJucyBUaGUgbWFuaWZlc3QuXG4gKi9cbmZ1bmN0aW9uIGdldE1hbmlmZXN0RnJvbUZEQzMoYXBwOiBBcHBEZWZpbml0aW9uKTogdW5rbm93biB7XG5cdGlmIChpc1N0cmluZ1ZhbHVlKGFwcC5tYW5pZmVzdCkgJiYgYXBwLm1hbmlmZXN0LnN0YXJ0c1dpdGgoXCJ7XCIpKSB7XG5cdFx0cmV0dXJuIEpTT04ucGFyc2UoYXBwLm1hbmlmZXN0KTtcblx0fVxuXG5cdHJldHVybiBhcHAubWFuaWZlc3Q7XG59XG5cbi8qKlxuICogTWFwIHRoZSB0YWdzLlxuICogQHBhcmFtIGFwcCBUaGUgYXBwIGRlZmluaXRpb24gdG8gbWFwIHRoZSB0YWdzIGZvci5cbiAqIEByZXR1cm5zIFRoZSBtYXBwZWQgdGFncyxcbiAqL1xuZnVuY3Rpb24gbWFwVGFnc0Zyb21GREMzKGFwcDogQXBwRGVmaW5pdGlvbiAmIHsgdGFncz86IHN0cmluZ1tdIH0pOiBzdHJpbmdbXSB7XG5cdGNvbnN0IHRhZ3M6IHN0cmluZ1tdID0gYXBwLnRhZ3MgPz8gYXBwLmNhdGVnb3JpZXMgPz8gW107XG5cdGlmICh0YWdzLmxlbmd0aCA9PT0gMCkge1xuXHRcdHRhZ3MucHVzaChhcHAubWFuaWZlc3RUeXBlKTtcblx0fVxuXG5cdHJldHVybiB0YWdzO1xufVxuXG4vKipcbiAqIE1hcCB0aGUgcHJpdmF0ZSBmbGFnLlxuICogQHBhcmFtIGFwcCBUaGUgYXBwIGNvbnRhaW5pbmcgdGhlIGFwcC5cbiAqIEByZXR1cm5zIFRoZSBmbGFnIG9yIGZhbHNlIGlmIG5vdCBmb3VuZC5cbiAqL1xuZnVuY3Rpb24gbWFwUHJpdmF0ZUZyb21GREMzKGFwcDogQXBwRGVmaW5pdGlvbik6IGJvb2xlYW4ge1xuXHRyZXR1cm4gbWFwQm9vbGVhblZhbHVlKGFwcD8uY3VzdG9tQ29uZmlnPy5wcml2YXRlLCBmYWxzZSk7XG59XG5cbi8qKlxuICogTWFwIHRoZSBhdXRvc3RhcnQgZmxhZy5cbiAqIEBwYXJhbSBhcHAgVGhlIGFwcCBjb250YWluaW5nIHRoZSBhcHAuXG4gKiBAcmV0dXJucyBUaGUgZmxhZyBvciBmYWxzZSBpZiBub3QgZm91bmQuXG4gKi9cbmZ1bmN0aW9uIG1hcEF1dG9zdGFydEZyb21GREMzKGFwcDogQXBwRGVmaW5pdGlvbik6IGJvb2xlYW4ge1xuXHRyZXR1cm4gbWFwQm9vbGVhblZhbHVlKGFwcD8uY3VzdG9tQ29uZmlnPy5hdXRvc3RhcnQsIGZhbHNlKTtcbn1cblxuLyoqXG4gKiBNYXAgYSBib29sZWFuIG9yIHN0cmluZyB0byBhIHJlYWwgYm9vbGVhbiB2YWx1ZS5cbiAqIEBwYXJhbSBmbGFnIFRoZSBmbGFnIHRvIGNvbnZlcnQuXG4gKiBAcGFyYW0gZGVmYXVsdEZsYWcgVGhlIGRlZmF1bHQgdmFsdWUgaWYgbWlzc2luZy5cbiAqIEByZXR1cm5zIFRoZSBtYXBwZWQgZmxhZy5cbiAqL1xuZnVuY3Rpb24gbWFwQm9vbGVhblZhbHVlKGZsYWc6IHN0cmluZyB8IGJvb2xlYW4gfCB1bmRlZmluZWQsIGRlZmF1bHRGbGFnOiBib29sZWFuKTogYm9vbGVhbiB7XG5cdGlmIChpc1N0cmluZ1ZhbHVlKGZsYWcpIHx8IGlzQm9vbGVhbihmbGFnKSkge1xuXHRcdHN3aXRjaCAoZmxhZykge1xuXHRcdFx0Y2FzZSBcIkZhbHNlXCI6XG5cdFx0XHRjYXNlIFwiZmFsc2VcIjpcblx0XHRcdGNhc2UgZmFsc2U6XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdGNhc2UgXCJUcnVlXCI6XG5cdFx0XHRjYXNlIFwidHJ1ZVwiOlxuXHRcdFx0Y2FzZSB0cnVlOlxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdC8vIGlmIHNvbWVvbmUgaGFzIGRlZmluZWQgYSBmbGFnIHRoZW4gdGhlIGxpa2VseSBob29kIHdhcyB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCB2YWx1ZVxuXHRcdFx0XHRyZXR1cm4gIWRlZmF1bHRGbGFnO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gZGVmYXVsdEZsYWc7XG59XG4iLCJpbXBvcnQgdHlwZSB7IEFwcE1ldGFkYXRhIH0gZnJvbSBcIkBmaW5vcy9mZGMzXCI7XG5pbXBvcnQgdHlwZSB7IEFwcEludGVudCB9IGZyb20gXCJAb3BlbmZpbi93b3Jrc3BhY2VcIjtcbmltcG9ydCB0eXBlIHsgUGxhdGZvcm1BcHAgfSBmcm9tIFwiLi4vLi4vc2hhcGVzL2FwcC1zaGFwZXNcIjtcbmltcG9ydCB0eXBlIHtcblx0QXBwRGVmaW5pdGlvbixcblx0V2ViQXBwRGV0YWlscyxcblx0TmF0aXZlQXBwRGV0YWlscyxcblx0T25saW5lTmF0aXZlQXBwRGV0YWlscyxcblx0QXBwSW50ZXJvcCxcblx0QXBwRGVmaW5pdGlvblR5cGUsXG5cdEFwcEludGVudHMsXG5cdEhvc3RNYW5pZmVzdHNcbn0gZnJvbSBcIi4uLy4uL3NoYXBlcy9mZGMzLTItMC1zaGFwZXNcIjtcbmltcG9ydCB7IGlzRW1wdHksIGlzT2JqZWN0IH0gZnJvbSBcIi4uLy4uL3V0aWxzXCI7XG5cbi8qKlxuICogTWFwIHRoZSBhcHAgZGVmaW5pdGlvbiB0byBhIHBsYXRmb3JtIGFwcC5cbiAqIEBwYXJhbSBhcHAgVGhlIGFwcCBkZWZpbml0aW9uIHRvIG1hcC5cbiAqIEByZXR1cm5zIFRoZSBwbGF0Zm9ybSBhcHAuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXBUb1BsYXRmb3JtQXBwKGFwcDogQXBwRGVmaW5pdGlvbik6IFBsYXRmb3JtQXBwIHtcblx0Y29uc3QgcGxhdGZvcm1BcHA6IFBsYXRmb3JtQXBwID0ge1xuXHRcdGFwcElkOiBhcHAuYXBwSWQsXG5cdFx0bmFtZTogYXBwLm5hbWUgPz8gYXBwLmFwcElkLFxuXHRcdHRpdGxlOiBhcHAudGl0bGUgPz8gYXBwLm5hbWUsXG5cdFx0bWFuaWZlc3RUeXBlOiBtYXBNYW5pZmVzdFR5cGVGcm9tRkRDMyhhcHApLFxuXHRcdG1hbmlmZXN0OiBnZXRNYW5pZmVzdEZyb21GREMzKGFwcCkgYXMgc3RyaW5nLFxuXHRcdGRlc2NyaXB0aW9uOiBhcHAuZGVzY3JpcHRpb24sXG5cdFx0aW5zdGFuY2VNb2RlOiBhcHA/Lmhvc3RNYW5pZmVzdHM/Lk9wZW5GaW4/LmNvbmZpZz8uaW5zdGFuY2VNb2RlLFxuXHRcdGludGVudHM6IG1hcEludGVudHNGcm9tRkRDMyhhcHAuaW50ZXJvcCksXG5cdFx0aW50ZXJvcDogYXBwLmludGVyb3AsXG5cdFx0Y3VzdG9tQ29uZmlnOiBhcHAuY3VzdG9tQ29uZmlnLFxuXHRcdHRhZ3M6IGFwcC5jYXRlZ29yaWVzLFxuXHRcdHZlcnNpb246IGFwcC52ZXJzaW9uLFxuXHRcdHB1Ymxpc2hlcjogYXBwLnB1Ymxpc2hlciA/PyBcIlwiLFxuXHRcdGNvbnRhY3RFbWFpbDogYXBwLmNvbnRhY3RFbWFpbCxcblx0XHRzdXBwb3J0RW1haWw6IGFwcC5zdXBwb3J0RW1haWwsXG5cdFx0aWNvbnM6IGFwcC5pY29ucyA/PyBbXSxcblx0XHRpbWFnZXM6IGFwcC5zY3JlZW5zaG90cyxcblx0XHRwcml2YXRlOiBhcHA/Lmhvc3RNYW5pZmVzdHM/Lk9wZW5GaW4/LmNvbmZpZz8ucHJpdmF0ZSxcblx0XHRhdXRvc3RhcnQ6IGFwcD8uaG9zdE1hbmlmZXN0cz8uT3BlbkZpbj8uY29uZmlnPy5hdXRvc3RhcnQsXG5cdFx0bGF1bmNoUHJlZmVyZW5jZTogYXBwPy5ob3N0TWFuaWZlc3RzPy5PcGVuRmluPy5jb25maWc/LmxhdW5jaFByZWZlcmVuY2Vcblx0fTtcblx0cmV0dXJuIHBsYXRmb3JtQXBwO1xufVxuXG4vKipcbiAqIE1hcCBhIHBsYXRmb3JtIGFwcCB0byBhbiBGREMzIDIuMCBhcHAgZGVmaW5pdGlvbi5cbiAqIEBwYXJhbSBhcHAgVGhlIGFwcCBkZWZpbml0aW9uIHRvIG1hcC5cbiAqIEByZXR1cm5zIFRoZSBmZGMzIDIuMCBhcHAuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXBUb0ZEQzNBcHAoYXBwOiBQbGF0Zm9ybUFwcCk6IEFwcERlZmluaXRpb24ge1xuXHRjb25zdCBmZGMzQXBwOiBBcHBEZWZpbml0aW9uID0ge1xuXHRcdGFwcElkOiBhcHAuYXBwSWQsXG5cdFx0bmFtZTogYXBwLm5hbWUgPz8gYXBwLmFwcElkLFxuXHRcdHRpdGxlOiBhcHAudGl0bGUgPz8gYXBwLm5hbWUsXG5cdFx0dHlwZTogbWFwVHlwZUZyb21QbGF0Zm9ybUFwcChhcHApLFxuXHRcdGRldGFpbHM6IHt9LFxuXHRcdGRlc2NyaXB0aW9uOiBhcHAuZGVzY3JpcHRpb24sXG5cdFx0Y2F0ZWdvcmllczogYXBwLnRhZ3MgPz8gW10sXG5cdFx0dmVyc2lvbjogYXBwLnZlcnNpb24sXG5cdFx0cHVibGlzaGVyOiBhcHAucHVibGlzaGVyID8/IFwiXCIsXG5cdFx0Y29udGFjdEVtYWlsOiBhcHAuY29udGFjdEVtYWlsLFxuXHRcdHN1cHBvcnRFbWFpbDogYXBwLnN1cHBvcnRFbWFpbCxcblx0XHRpY29uczogYXBwLmljb25zLFxuXHRcdHNjcmVlbnNob3RzOiBhcHAuaW1hZ2VzLFxuXHRcdHRvb2x0aXA6IGFwcC50b29sdGlwLFxuXHRcdGludGVyb3A6IGdldEludGVyb3BGcm9tUGxhdGZvcm1BcHAoYXBwKSxcblx0XHRob3N0TWFuaWZlc3RzOiBnZXRIb3N0TWFuaWZlc3RzRnJvbVBsYXRmb3JtQXBwKGFwcClcblx0fTtcblx0cmV0dXJuIGZkYzNBcHA7XG59XG5cbi8qKlxuICogTWFwIHRoZSBwbGF0Zm9ybSBhcHAgdG8gYXBwIG1ldGFkYXRhLlxuICogQHBhcmFtIGFwcCBUaGUgYXBwbGljYXRpb24gdG8gbWFwLlxuICogQHBhcmFtIHJlc3VsdFR5cGUgVGhlIHJlc3VsdCB0eXBlIHRvIGluY2x1ZGUgaW4gdGhlIGRhdGEuXG4gKiBAcmV0dXJucyBUaGUgYXBwIG1ldGFkYXRhLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwVG9BcHBNZXRhRGF0YShhcHA6IFBsYXRmb3JtQXBwLCByZXN1bHRUeXBlPzogc3RyaW5nKTogQXBwTWV0YWRhdGEge1xuXHRjb25zdCBhcHBNZXRhRGF0YTogQXBwTWV0YWRhdGEgPSB7XG5cdFx0YXBwSWQ6IGFwcC5hcHBJZCxcblx0XHRkZXNjcmlwdGlvbjogYXBwLmRlc2NyaXB0aW9uLFxuXHRcdGljb25zOiBhcHAuaWNvbnMsXG5cdFx0bmFtZTogYXBwLm5hbWUsXG5cdFx0c2NyZWVuc2hvdHM6IGFwcC5pbWFnZXMsXG5cdFx0dGl0bGU6IGFwcC50aXRsZSxcblx0XHR0b29sdGlwOiBhcHAudG9vbHRpcCxcblx0XHR2ZXJzaW9uOiBhcHAudmVyc2lvbixcblx0XHRyZXN1bHRUeXBlXG5cdH07XG5cdHJldHVybiBhcHBNZXRhRGF0YTtcbn1cblxuLyoqXG4gKiBNYXAgdGhlIGFwcCBkZWZpbml0aW9uIGludGVyb3AgZGF0YSB0byBhcHAgaW50ZXJvcCBmb3JtYXQuXG4gKiBAcGFyYW0gaW50ZXJvcCBUaGUgaW50ZXJvcCB0byBtYXAuXG4gKiBAcmV0dXJucyBUaGUgYXBwIGludGVyb3AuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXBJbnRlbnRzRnJvbUZEQzMoaW50ZXJvcDogQXBwSW50ZXJvcCB8IHVuZGVmaW5lZCk6IEFwcEludGVudFtdIHtcblx0Y29uc3QgaW50ZW50czogQXBwSW50ZW50W10gPSBbXTtcblxuXHRjb25zdCBsaXN0ZW5zRm9yID0gaW50ZXJvcD8uaW50ZW50cz8ubGlzdGVuc0Zvcjtcblx0aWYgKGlzRW1wdHkobGlzdGVuc0ZvcikpIHtcblx0XHRyZXR1cm4gaW50ZW50cztcblx0fVxuXG5cdGNvbnN0IGludGVudElkcyA9IE9iamVjdC5rZXlzKGxpc3RlbnNGb3IpO1xuXHRmb3IgKGNvbnN0IGludGVudE5hbWUgb2YgaW50ZW50SWRzKSB7XG5cdFx0aW50ZW50cy5wdXNoKHtcblx0XHRcdG5hbWU6IGludGVudE5hbWUsXG5cdFx0XHRkaXNwbGF5TmFtZTogbGlzdGVuc0ZvcltpbnRlbnROYW1lXS5kaXNwbGF5TmFtZSA/PyBcIlwiLFxuXHRcdFx0Y29udGV4dHM6IGxpc3RlbnNGb3JbaW50ZW50TmFtZV0uY29udGV4dHNcblx0XHR9KTtcblx0fVxuXG5cdHJldHVybiBpbnRlbnRzO1xufVxuXG4vKipcbiAqIEdldCB0aGUgaW50ZXJvcCBkYXRhIGZyb20gYSBQbGF0Zm9ybSBBcHAgaW4gRkRDMyAyLjAgZm9ybWF0LlxuICogQHBhcmFtIGFwcCBUaGUgcGxhdGZvcm0gYXBwIHRvIHVzZSBhcyBhIHNvdXJjZS5cbiAqIEByZXR1cm5zIFRoZSBhcHAgaW50ZXJvcCBkZWZpbml0aW9uLlxuICovXG5mdW5jdGlvbiBnZXRJbnRlcm9wRnJvbVBsYXRmb3JtQXBwKGFwcDogUGxhdGZvcm1BcHApOiBBcHBJbnRlcm9wIHtcblx0aWYgKCFpc0VtcHR5KGFwcC5pbnRlcm9wKSkge1xuXHRcdHJldHVybiBhcHAuaW50ZXJvcDtcblx0fVxuXHRjb25zdCBpbnRlcm9wOiBBcHBJbnRlcm9wID0ge1xuXHRcdGludGVudHM6IHtcblx0XHRcdGxpc3RlbnNGb3I6IHt9XG5cdFx0fVxuXHR9O1xuXG5cdGlmIChBcnJheS5pc0FycmF5KGFwcC5pbnRlbnRzKSAmJiBhcHAuaW50ZW50cy5sZW5ndGggPiAwKSB7XG5cdFx0Y29uc3QgbGlzdGVuc0ZvcjogeyBba2V5OiBzdHJpbmddOiBBcHBJbnRlbnRzIH0gPSB7fTtcblx0XHRmb3IgKGNvbnN0IGludGVudCBvZiBhcHAuaW50ZW50cykge1xuXHRcdFx0bGlzdGVuc0ZvcltpbnRlbnQubmFtZV0gPSB7IGRpc3BsYXlOYW1lOiBpbnRlbnQuZGlzcGxheU5hbWUsIGNvbnRleHRzOiBpbnRlbnQuY29udGV4dHMgfTtcblx0XHR9XG5cdFx0aWYgKCFpc0VtcHR5KGludGVyb3AuaW50ZW50cykpIHtcblx0XHRcdGludGVyb3AuaW50ZW50cy5saXN0ZW5zRm9yID0gbGlzdGVuc0Zvcjtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gaW50ZXJvcDtcbn1cblxuLyoqXG4gKiBNYXAgdGhlIG1hbmlmZXN0IHR5cGUuXG4gKiBAcGFyYW0gYXBwIFRoZSBhcHAgZGVmaW5pdGlvbiB0byBtYXAgdGhlIG1hbmlmZXN0IHR5cGUgZm9yLlxuICogQHJldHVybnMgVGhlIG1hcHBlZCBtYW5pZmVzdCB0eXBlLlxuICovXG5mdW5jdGlvbiBtYXBNYW5pZmVzdFR5cGVGcm9tRkRDMyhhcHA6IEFwcERlZmluaXRpb24pOiBzdHJpbmcge1xuXHRsZXQgbWFuaWZlc3RUeXBlOiBzdHJpbmc7XG5cblx0c3dpdGNoIChhcHAudHlwZSkge1xuXHRcdGNhc2UgXCJ3ZWJcIjoge1xuXHRcdFx0bWFuaWZlc3RUeXBlID0gXCJpbmxpbmUtdmlld1wiO1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdGNhc2UgXCJuYXRpdmVcIjoge1xuXHRcdFx0bWFuaWZlc3RUeXBlID0gXCJpbmxpbmUtZXh0ZXJuYWxcIjtcblx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHRjYXNlIFwib25saW5lTmF0aXZlXCI6IHtcblx0XHRcdG1hbmlmZXN0VHlwZSA9IFwiZGVza3RvcC1icm93c2VyXCI7XG5cdFx0XHRicmVhaztcblx0XHR9XG5cdFx0Y2FzZSBcIm90aGVyXCI6IHtcblx0XHRcdG1hbmlmZXN0VHlwZSA9IGFwcC5ob3N0TWFuaWZlc3RzPy5PcGVuRmluPy50eXBlID8/IFwiXCI7XG5cdFx0XHRicmVhaztcblx0XHR9XG5cdFx0ZGVmYXVsdDoge1xuXHRcdFx0bWFuaWZlc3RUeXBlID0gYXBwLnR5cGU7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBtYW5pZmVzdFR5cGU7XG59XG5cbi8qKlxuICogTWFwcyB0byBhbiBGREMzIDIuMCB0eXBlIGZyb20gdGhlIG1hbmlmZXN0IHR5cGUgc3BlY2lmaWVkIGJ5IGEgcGxhdGZvcm0gYXBwLlxuICogQHBhcmFtIGFwcCB0aGUgcGxhdGZvcm0gYXBwIHRvIHVzZSBhcyBhIHNvdXJjZVxuICogQHJldHVybnMgdGhlIEZEQzMgMi4wIGFwcCBkZWZpbml0aW9uIHR5cGVcbiAqL1xuZnVuY3Rpb24gbWFwVHlwZUZyb21QbGF0Zm9ybUFwcChhcHA6IFBsYXRmb3JtQXBwKTogQXBwRGVmaW5pdGlvblR5cGUge1xuXHRsZXQgdHlwZTogQXBwRGVmaW5pdGlvblR5cGUgPSBcIm90aGVyXCI7XG5cdGlmIChpc0VtcHR5KGFwcC5tYW5pZmVzdFR5cGUpKSB7XG5cdFx0cmV0dXJuIHR5cGU7XG5cdH1cblx0c3dpdGNoIChhcHAubWFuaWZlc3RUeXBlKSB7XG5cdFx0Y2FzZSBcImlubGluZS12aWV3XCI6IHtcblx0XHRcdHR5cGUgPSBcIndlYlwiO1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdGNhc2UgXCJpbmxpbmUtZXh0ZXJuYWxcIjoge1xuXHRcdFx0dHlwZSA9IFwibmF0aXZlXCI7XG5cdFx0XHRicmVhaztcblx0XHR9XG5cdFx0Y2FzZSBcImRlc2t0b3AtYnJvd3NlclwiOiB7XG5cdFx0XHR0eXBlID0gXCJvbmxpbmVOYXRpdmVcIjtcblx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gdHlwZTtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIG1hbmlmZXN0IHdoaWNoIGNhbiBiZSBwbGFpbiBzdHJpbmcgb3IgSlNPTi5cbiAqIEBwYXJhbSBhcHAgVGhlIGFwcCB0byBnZXQgdGhlIG1hbmlmZXN0IGZyb20uXG4gKiBAcmV0dXJucyBUaGUgbWFuaWZlc3QuXG4gKi9cbmZ1bmN0aW9uIGdldE1hbmlmZXN0RnJvbUZEQzMoYXBwOiBBcHBEZWZpbml0aW9uKTogc3RyaW5nIHwgdW5rbm93biB7XG5cdGxldCBtYW5pZmVzdDogc3RyaW5nIHwgdW5rbm93bjtcblxuXHRzd2l0Y2ggKGFwcC50eXBlKSB7XG5cdFx0Y2FzZSBcIndlYlwiOiB7XG5cdFx0XHRpZiAoIWlzRW1wdHkoYXBwPy5kZXRhaWxzKSkge1xuXHRcdFx0XHRjb25zdCBob3N0RGV0YWlscyA9IGFwcC5ob3N0TWFuaWZlc3RzPy5PcGVuRmluPy5kZXRhaWxzO1xuXHRcdFx0XHRpZiAoaXNPYmplY3QoaG9zdERldGFpbHMpKSB7XG5cdFx0XHRcdFx0bWFuaWZlc3QgPSB7XG5cdFx0XHRcdFx0XHR1cmw6IChhcHA/LmRldGFpbHMgYXMgV2ViQXBwRGV0YWlscykudXJsLFxuXHRcdFx0XHRcdFx0ZmRjM0ludGVyb3BBcGk6IFwiMi4wXCIsXG5cdFx0XHRcdFx0XHQuLi5ob3N0RGV0YWlsc1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bWFuaWZlc3QgPSB7XG5cdFx0XHRcdFx0XHR1cmw6IChhcHA/LmRldGFpbHMgYXMgV2ViQXBwRGV0YWlscykudXJsLFxuXHRcdFx0XHRcdFx0ZmRjM0ludGVyb3BBcGk6IFwiMi4wXCJcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHR9XG5cdFx0Y2FzZSBcIm5hdGl2ZVwiOiB7XG5cdFx0XHRpZiAoIWlzRW1wdHkoYXBwPy5kZXRhaWxzKSkge1xuXHRcdFx0XHQvLyBvdXIgbmF0aXZlIGFwaSBzdXBwb3J0cyBwYXRoIGFuZCBhcmd1bWVudHMuXG5cdFx0XHRcdG1hbmlmZXN0ID0gYXBwLmRldGFpbHMgYXMgTmF0aXZlQXBwRGV0YWlscztcblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHRjYXNlIFwib25saW5lTmF0aXZlXCI6IHtcblx0XHRcdGlmICghaXNFbXB0eShhcHA/LmRldGFpbHMpKSB7XG5cdFx0XHRcdG1hbmlmZXN0ID0gKGFwcD8uZGV0YWlscyBhcyBPbmxpbmVOYXRpdmVBcHBEZXRhaWxzKS51cmw7XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHR9XG5cdFx0Y2FzZSBcIm90aGVyXCI6IHtcblx0XHRcdG1hbmlmZXN0ID0gYXBwLmhvc3RNYW5pZmVzdHM/Lk9wZW5GaW4/LmRldGFpbHM7XG5cdFx0XHRicmVhaztcblx0XHR9XG5cdFx0ZGVmYXVsdDoge1xuXHRcdFx0bWFuaWZlc3QgPSBhcHAuZGV0YWlscztcblx0XHR9XG5cdH1cblx0cmV0dXJuIG1hbmlmZXN0O1xufVxuXG4vKipcbiAqIEdldCB0aGUgSG9zdCBEZXRhaWxzIGZyb20gdGhlIHBsYXRmb3JtIGFwcCBmb3IgdGhpcyBGREMzIDIuMCBBcHAgRGVmaW5pdGlvbi5cbiAqIEBwYXJhbSBhcHAgVGhlIHBsYXRmb3JtIGFwcCB0byBnZXQgdGhlIGluZm9ybWF0aW9uIGZyb20uXG4gKiBAcmV0dXJucyBUaGUgaG9zdCBzcGVjaWZpYyBkZXRhaWxzLlxuICovXG5mdW5jdGlvbiBnZXRIb3N0TWFuaWZlc3RzRnJvbVBsYXRmb3JtQXBwKGFwcDogUGxhdGZvcm1BcHApOiBIb3N0TWFuaWZlc3RzIHtcblx0Y29uc3QgaG9zdE1hbmlmZXN0czogSG9zdE1hbmlmZXN0cyA9IHtcblx0XHRPcGVuRmluOiB7XG5cdFx0XHR0eXBlOiBhcHAubWFuaWZlc3RUeXBlLFxuXHRcdFx0ZGV0YWlsczogYXBwLm1hbmlmZXN0LFxuXHRcdFx0Y29uZmlnOiB7XG5cdFx0XHRcdGF1dG9zdGFydDogYXBwLmF1dG9zdGFydCxcblx0XHRcdFx0cHJpdmF0ZTogYXBwLnByaXZhdGUsXG5cdFx0XHRcdGluc3RhbmNlTW9kZTogYXBwLmluc3RhbmNlTW9kZSxcblx0XHRcdFx0bGF1bmNoUHJlZmVyZW5jZTogYXBwLmxhdW5jaFByZWZlcmVuY2Vcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cdHJldHVybiBob3N0TWFuaWZlc3RzO1xufVxuIiwiLyoqIENvbnN0YW50cyByZXByZXNlbnRpbmcgdGhlIGVycm9ycyB0aGF0IGNhbiBiZSBlbmNvdW50ZXJlZCB3aGVuIGNhbGxpbmcgdGhlIGBvcGVuYCBtZXRob2Qgb24gdGhlIERlc2t0b3BBZ2VudCBvYmplY3QgKGBmZGMzYCkuICovXG5leHBvcnQgY29uc3QgT1BFTl9FUlJPUiA9IHtcblx0LyoqIFJldHVybmVkIGlmIHRoZSBzcGVjaWZpZWQgYXBwbGljYXRpb24gaXMgbm90IGZvdW5kLiovXG5cdEFwcE5vdEZvdW5kOiBcIkFwcE5vdEZvdW5kXCIsXG5cdC8qKiBSZXR1cm5lZCBpZiB0aGUgc3BlY2lmaWVkIGFwcGxpY2F0aW9uIGZhaWxzIHRvIGxhdW5jaCBjb3JyZWN0bHkuKi9cblx0RXJyb3JPbkxhdW5jaDogXCJFcnJvck9uTGF1bmNoXCIsXG5cdC8qKiBSZXR1cm5lZCBpZiB0aGUgc3BlY2lmaWVkIGFwcGxpY2F0aW9uIGxhdW5jaGVzIGJ1dCBmYWlscyB0byBhZGQgYSBjb250ZXh0IGxpc3RlbmVyIGluIG9yZGVyIHRvIHJlY2VpdmUgdGhlIGNvbnRleHQgcGFzc2VkIHRvIHRoZSBgZmRjMy5vcGVuYCBjYWxsLiovXG5cdEFwcFRpbWVvdXQ6IFwiQXBwVGltZW91dFwiLFxuXHQvKiogUmV0dXJuZWQgaWYgdGhlIEZEQzMgZGVza3RvcCBhZ2VudCBpbXBsZW1lbnRhdGlvbiBpcyBub3QgY3VycmVudGx5IGFibGUgdG8gaGFuZGxlIHRoZSByZXF1ZXN0LiovXG5cdFJlc29sdmVyVW5hdmFpbGFibGU6IFwiUmVzb2x2ZXJVbmF2YWlsYWJsZVwiLFxuXHQvKiogUmV0dXJuZWQgaWYgYSBjYWxsIHRvIHRoZSBgb3BlbmAgZnVuY3Rpb24gaXMgbWFkZSB3aXRoIGFuIGludmFsaWQgY29udGV4dCBhcmd1bWVudC4gQ29udGV4dHMgc2hvdWxkIGJlIE9iamVjdHMgd2l0aCBhdCBsZWFzdCBhIGB0eXBlYCBmaWVsZCB0aGF0IGhhcyBhIGBzdHJpbmdgIHZhbHVlLiovXG5cdE1hbGZvcm1lZENvbnRleHQ6IFwiTWFsZm9ybWVkQ29udGV4dFwiXG59O1xuLyoqIENvbnN0YW50cyByZXByZXNlbnRpbmcgdGhlIGVycm9ycyB0aGF0IGNhbiBiZSBlbmNvdW50ZXJlZCB3aGVuIGNhbGxpbmcgdGhlIGBmaW5kSW50ZW50YCwgYGZpbmRJbnRlbnRzQnlDb250ZXh0YCwgYHJhaXNlSW50ZW50YCBvciBgcmFpc2VJbnRlbnRGb3JDb250ZXh0YCBtZXRob2RzIG9uIHRoZSBEZXNrdG9wQWdlbnQgKGBmZGMzYCkuICovXG5leHBvcnQgY29uc3QgUkVTT0xWRV9FUlJPUiA9IHtcblx0LyoqIFNIT1VMRCBiZSByZXR1cm5lZCBpZiBubyBhcHBzIGFyZSBhdmFpbGFibGUgdGhhdCBjYW4gcmVzb2x2ZSB0aGUgaW50ZW50IGFuZCBjb250ZXh0IGNvbWJpbmF0aW9uLiovXG5cdE5vQXBwc0ZvdW5kOiBcIk5vQXBwc0ZvdW5kXCIsXG5cdC8qKiBSZXR1cm5lZCBpZiB0aGUgRkRDMyBkZXNrdG9wIGFnZW50IGltcGxlbWVudGF0aW9uIGlzIG5vdCBjdXJyZW50bHkgYWJsZSB0byBoYW5kbGUgdGhlIHJlcXVlc3QuKi9cblx0UmVzb2x2ZXJVbmF2YWlsYWJsZTogXCJSZXNvbHZlclVuYXZhaWxhYmxlXCIsXG5cdC8qKiBSZXR1cm5lZCBpZiB0aGUgdXNlciBjYW5jZWxsZWQgdGhlIHJlc29sdXRpb24gcmVxdWVzdCwgZm9yIGV4YW1wbGUgYnkgY2xvc2luZyBvciBjYW5jZWxsaW5nIGEgcmVzb2x2ZXIgVUkuKi9cblx0VXNlckNhbmNlbGxlZDogXCJVc2VyQ2FuY2VsbGVkUmVzb2x1dGlvblwiLFxuXHQvKiogU0hPVUxEIGJlIHJldHVybmVkIGlmIGEgdGltZW91dCBjYW5jZWxzIGFuIGludGVudCByZXNvbHV0aW9uIHRoYXQgcmVxdWlyZWQgdXNlciBpbnRlcmFjdGlvbi4gUGxlYXNlIHVzZSBgUmVzb2x2ZXJVbmF2YWlsYWJsZWAgaW5zdGVhZCBmb3Igc2l0dWF0aW9ucyB3aGVyZSBhIHJlc29sdmVyIFVJIG9yIHNpbWlsYXIgZmFpbHMuKi9cblx0UmVzb2x2ZXJUaW1lb3V0OiBcIlJlc29sdmVyVGltZW91dFwiLFxuXHQvKiogUmV0dXJuZWQgaWYgYSBzcGVjaWZpZWQgdGFyZ2V0IGFwcGxpY2F0aW9uIGlzIG5vdCBhdmFpbGFibGUgb3IgYSBuZXcgaW5zdGFuY2Ugb2YgaXQgY2Fubm90IGJlIG9wZW5lZC4gKi9cblx0VGFyZ2V0QXBwVW5hdmFpbGFibGU6IFwiVGFyZ2V0QXBwVW5hdmFpbGFibGVcIixcblx0LyoqIFJldHVybmVkIGlmIGEgc3BlY2lmaWVkIHRhcmdldCBhcHBsaWNhdGlvbiBpbnN0YW5jZSBpcyBub3QgYXZhaWxhYmxlLCBmb3IgZXhhbXBsZSBiZWNhdXNlIGl0IGhhcyBiZWVuIGNsb3NlZC4gKi9cblx0VGFyZ2V0SW5zdGFuY2VVbmF2YWlsYWJsZTogXCJUYXJnZXRJbnN0YW5jZVVuYXZhaWxhYmxlXCIsXG5cdC8qKiBSZXR1cm5lZCBpZiB0aGUgaW50ZW50IGFuZCBjb250ZXh0IGNvdWxkIG5vdCBiZSBkZWxpdmVyZWQgdG8gdGhlIHNlbGVjdGVkIGFwcGxpY2F0aW9uIG9yIGluc3RhbmNlLCBmb3IgZXhhbXBsZSBiZWNhdXNlIGl0IGhhcyBub3QgYWRkZWQgYW4gaW50ZW50IGhhbmRsZXIgd2l0aGluIGEgdGltZW91dC4qL1xuXHRJbnRlbnREZWxpdmVyeUZhaWxlZDogXCJJbnRlbnREZWxpdmVyeUZhaWxlZFwiLFxuXHQvKiogUmV0dXJuZWQgaWYgYSBjYWxsIHRvIG9uZSBvZiB0aGUgYHJhaXNlSW50ZW50YCBmdW5jdGlvbnMgaXMgbWFkZSB3aXRoIGFuIGludmFsaWQgY29udGV4dCBhcmd1bWVudC4gQ29udGV4dHMgc2hvdWxkIGJlIE9iamVjdHMgd2l0aCBhdCBsZWFzdCBhIGB0eXBlYCBmaWVsZCB0aGF0IGhhcyBhIGBzdHJpbmdgIHZhbHVlLiovXG5cdE1hbGZvcm1lZENvbnRleHQ6IFwiTWFsZm9ybWVkQ29udGV4dFwiXG59O1xuIiwiaW1wb3J0IHR5cGUgeyBNYW5pZmVzdFR5cGVzIH0gZnJvbSBcIi4vc2hhcGVzL2FwcC1zaGFwZXNcIjtcblxuZXhwb3J0IGNvbnN0IE1BTklGRVNUX1RZUEVTOiBNYW5pZmVzdFR5cGVzID0ge1xuXHRWaWV3OiB7XG5cdFx0aWQ6IFwidmlld1wiLFxuXHRcdGxhYmVsOiBcIlZpZXdcIixcblx0XHRkZXNjcmlwdGlvbjpcblx0XHRcdFwiVGhpcyBtYW5pZmVzdCB0eXBlIGV4cGVjdHMgdGhlIG1hbmlmZXN0IHNldHRpbmcgdG8gYmUgcG9pbnRlZCB0byBhIGpzb24gZmlsZSB0aGF0IGNvbnRhaW5zIHZpZXcgb3B0aW9ucy5cIlxuXHR9LFxuXHRJbmxpbmVWaWV3OiB7XG5cdFx0aWQ6IFwiaW5saW5lLXZpZXdcIixcblx0XHRsYWJlbDogXCJWaWV3XCIsXG5cdFx0ZGVzY3JpcHRpb246XG5cdFx0XHRcIlRoaXMgbWFuaWZlc3QgdHlwZSBleHBlY3RzIHRoZSBtYW5pZmVzdCBzZXR0aW5nIHRvIGhhdmUgdGhlIG9wdGlvbnMgaW5saW5lIHJhdGhlciB0aGFuIGEgdXJsIHRvIGEganNvbiBmaWxlLlwiXG5cdH0sXG5cdFdpbmRvdzoge1xuXHRcdGlkOiBcIndpbmRvd1wiLFxuXHRcdGxhYmVsOiBcIldpbmRvd1wiLFxuXHRcdGRlc2NyaXB0aW9uOlxuXHRcdFx0XCJUaGlzIG1hbmlmZXN0IHR5cGUgZXhwZWN0cyB0aGUgbWFuaWZlc3Qgc2V0dGluZyB0byBwb2ludCB0byBhIGpzb24gZmlsZSB0aGF0IGNvbnRhaW5zIGNsYXNzaWMgd2luZG93IG9wdGlvbnMuXCJcblx0fSxcblx0SW5saW5lV2luZG93OiB7XG5cdFx0aWQ6IFwiaW5saW5lLXdpbmRvd1wiLFxuXHRcdGxhYmVsOiBcIldpbmRvd1wiLFxuXHRcdGRlc2NyaXB0aW9uOlxuXHRcdFx0XCJUaGlzIG1hbmlmZXN0IHR5cGUgZXhwZWN0cyB0aGUgbWFuaWZlc3Qgc2V0dGluZyB0byBoYXZlIHRoZSBjbGFzc2ljIHdpbmRvdyBvcHRpb25zIGlubGluZSByYXRoZXIgdGhhbiBhIHVybCB0byBhIGpzb24gZmlsZS5cIlxuXHR9LFxuXHRTbmFwc2hvdDoge1xuXHRcdGlkOiBcInNuYXBzaG90XCIsXG5cdFx0bGFiZWw6IFwiU25hcHNob3RcIixcblx0XHRkZXNjcmlwdGlvbjpcblx0XHRcdFwiVGhpcyBtYW5pZmVzdCB0eXBlIGV4cGVjdHMgdGhlIG1hbmlmZXN0IHNldHRpbmcgdG8gcG9pbnQgdG8gYSBqc29uIGZpbGUgdGhhdCBjb250YWlucyBhIHNuYXBzaG90IChvbmUgb3IgbW9yZSB3aW5kb3dzKVwiXG5cdH0sXG5cdElubGluZVNuYXBzaG90OiB7XG5cdFx0aWQ6IFwiaW5saW5lLXNuYXBzaG90XCIsXG5cdFx0bGFiZWw6IFwiU25hcHNob3RcIixcblx0XHRkZXNjcmlwdGlvbjpcblx0XHRcdFwiVGhpcyBtYW5pZmVzdCB0eXBlIGV4cGVjdHMgdGhlIG1hbmlmZXN0IHNldHRpbmcgdG8gaGF2ZSBhIHNuYXBzaG90IGlubGluZSByYXRoZXIgdGhhbiBhIHVybCB0byBhIGpzb24gZmlsZSB0aGF0IGNvbnRhaW5zIGEgc25hcHNob3QgKG9uZSBvciBtb3JlIHdpbmRvd3MpXCJcblx0fSxcblx0TWFuaWZlc3Q6IHtcblx0XHRpZDogXCJtYW5pZmVzdFwiLFxuXHRcdGxhYmVsOiBcIkFwcFwiLFxuXHRcdGRlc2NyaXB0aW9uOlxuXHRcdFx0XCJUaGlzIG1hbmlmZXN0IHR5cGUgZXhwZWN0cyB0aGUgbWFuaWZlc3Qgc2V0dGluZyB0byBwb2ludCB0byBhIGpzb24gZmlsZSB0aGF0IGlzIGFuIG9wZW5maW4gbWFuaWZlc3QuIEFuIG9wZW5maW4gYXBwLlwiXG5cdH0sXG5cdEV4dGVybmFsOiB7XG5cdFx0aWQ6IFwiZXh0ZXJuYWxcIixcblx0XHRsYWJlbDogXCJOYXRpdmUgQXBwXCIsXG5cdFx0ZGVzY3JpcHRpb246IFwiVGhpcyBtYW5pZmVzdCB0eXBlIGV4cGVjdHMgdGhlIG1hbmlmZXN0IHNldHRpbmcgdG8gcG9pbnQgdG8gYW4gZXhlLlwiXG5cdH0sXG5cdElubGluZUV4dGVybmFsOiB7XG5cdFx0aWQ6IFwiaW5saW5lLWV4dGVybmFsXCIsXG5cdFx0bGFiZWw6IFwiTmF0aXZlIEFwcFwiLFxuXHRcdGRlc2NyaXB0aW9uOlxuXHRcdFx0XCJUaGlzIG1hbmlmZXN0IHR5cGUgZXhwZWN0cyB0aGUgbWFuaWZlc3Qgc2V0dGluZyB0byBwb2ludCB0byBhbiBleGUgdXNpbmcgYW4gaW5saW5lIGxhdW5jaCBleHRlcm5hbCBwcm9jZXNzIHJlcXVlc3QuXCJcblx0fSxcblx0QXBwYXNzZXQ6IHtcblx0XHRpZDogXCJhcHBhc3NldFwiLFxuXHRcdGxhYmVsOiBcIk5hdGl2ZSBBcHBcIixcblx0XHRkZXNjcmlwdGlvbjogXCJUaGlzIG1hbmlmZXN0IHR5cGUgZXhwZWN0cyB0aGUgbWFuaWZlc3Qgc2V0dGluZyB0byBwb2ludCB0byBhbiBhcHAgYXNzZXQgbmFtZS5cIlxuXHR9LFxuXHRJbmxpbmVBcHBBc3NldDoge1xuXHRcdGlkOiBcImlubGluZS1hcHBhc3NldFwiLFxuXHRcdGxhYmVsOiBcIk5hdGl2ZSBBcHBcIixcblx0XHRkZXNjcmlwdGlvbjpcblx0XHRcdFwiVGhpcyBtYW5pZmVzdCB0eXBlIGV4cGVjdHMgdGhlIG1hbmlmZXN0IHNldHRpbmcgdG8gcG9pbnQgdG8gYW4gYXBwIGFzc2V0IGNvbmZpZyB1c2luZyBhbiBpbmxpbmUgbGF1bmNoIGV4dGVybmFsIHByb2Nlc3MgcmVxdWVzdC5cIlxuXHR9LFxuXHREZXNrdG9wQnJvd3Nlcjoge1xuXHRcdGlkOiBcImRlc2t0b3AtYnJvd3NlclwiLFxuXHRcdGxhYmVsOiBcIkRlc2t0b3AgQnJvd3NlclwiLFxuXHRcdGRlc2NyaXB0aW9uOlxuXHRcdFx0XCJUaGlzIG1hbmlmZXN0IHR5cGUgZXhwZWN0cyB0aGUgbWFuaWZlc3Qgc2V0dGluZyB0byBwb2ludCB0byBhIHVybCB3aGljaCB3aWxsIGJlIGxhdW5jaGVkIGluIHRoZSBkZWZhdWx0IGRlc2t0b3AgYnJvd3Nlci5cIlxuXHR9LFxuXHRFbmRwb2ludDoge1xuXHRcdGlkOiBcImVuZHBvaW50XCIsXG5cdFx0bGFiZWw6IFwiRW5kcG9pbnRcIixcblx0XHRkZXNjcmlwdGlvbjpcblx0XHRcdFwiVGhpcyBtYW5pZmVzdCB0eXBlIGV4cGVjdHMgdGhlIG1hbmlmZXN0IHNldHRpbmcgdG8gcG9pbnQgdG8gYW4gZW5kcG9pbnQgKHdoaWNoIHNob3VsZCBiZSBkZWZpbmVkIGluIHRoZSBlbmRwb2ludFByb3ZpZGVyKS4gQWN0aW9uIHdpbGwgYmUgY2FsbGVkIG9uIHRoYXQgZW5kcG9pbnQgYW5kIHBhc3NlZCB0aGUgc3BlY2lmaWVkIGFwcC5cIlxuXHR9LFxuXHRDb25uZWN0aW9uOiB7XG5cdFx0aWQ6IFwiY29ubmVjdGlvblwiLFxuXHRcdGxhYmVsOiBcIkNvbm5lY3RlZCBBcHBcIixcblx0XHRkZXNjcmlwdGlvbjpcblx0XHRcdFwiVGhpcyBtYW5pZmVzdCB0eXBlIGV4cGVjdHMgdGhlIG1hbmlmZXN0IHNldHRpbmcgdG8gaGF2ZSBhIHV1aWQuIFRoaXMgbXVzdCBtYXRjaCB0byBhIGNvbm5lY3Rpb24gcmVnaXN0ZXJlZCBpbiB0aGUgY29ubmVjdGlvblByb3ZpZGVyIHdpdGggYXBwIHN1cHBvcnQuXCJcblx0fSxcblx0VW5yZWdpc3RlcmVkQXBwOiB7XG5cdFx0aWQ6IFwidW5yZWdpc3RlcmVkLWFwcFwiLFxuXHRcdGxhYmVsOiBcIlVucmVnaXN0ZXJlZCBBcHBcIixcblx0XHRkZXNjcmlwdGlvbjpcblx0XHRcdFwiVGhpcyBtYW5pZmVzdCB0eXBlIHJlcHJlc2VudHMgd2ViIHBhZ2UgaW5zdGFuY2VzIHRoYXQgaGF2ZSBiZWVuIGxhdW5jaGVkIHRoYXQgYXJlIG5vdCBsaW5rZWQgdG8gYW4gYXBwLiBUaGlzIG1hbmlmZXN0IHR5cGUgc2hvdWxkIG5vdCBiZSBpbiB0aGUgcGVybWl0dGVkIG1hbmlmZXN0IHR5cGUgbGlzdCBmb3IgYXBwIGZlZWRzIGFzIGl0IGlzIGZvciBkeW5hbWljIHVybHMuXCJcblx0fVxufTtcbiIsImltcG9ydCB0eXBlIE9wZW5GaW4gZnJvbSBcIkBvcGVuZmluL2NvcmVcIjtcbmltcG9ydCB0eXBlIHsgQnJvd3NlclByb3ZpZGVyT3B0aW9ucywgV2luZG93UG9zaXRpb25pbmdPcHRpb25zIH0gZnJvbSBcIi4vc2hhcGVzL2Jyb3dzZXItc2hhcGVzXCI7XG5pbXBvcnQgeyBpc0VtcHR5IH0gZnJvbSBcIi4vdXRpbHNcIjtcblxuLyoqXG4gKiBQcm92aWRlcyB4IGFuZCB5IGNvLW9yZGluYXRlcyB0byBwb3NpdGlvbiBhIHdpbmRvdyBvZiBhIGdpdmVuIHNpemUgaW4gcmVsYXRpb24gdG8gYW5vdGhlciB3aW5kb3cvdmlldy5cbiAqIEBwYXJhbSBjbGllbnRJZGVudGl0eSBUaGUgaWRlbnRpdHkgb2YgdGhlIHZpZXcvd2luZG93IHRoZXNlIHgveSBjby1vcmRpbmF0ZXMgc2hvdWxkIGJlIGluIHJlbGF0aW9uIHRvLlxuICogQHBhcmFtIGRpbWVuc2lvbnMgVGhlIGRpbWVuc2lvbnMgb2YgdGhlIHdpbmRvdyB0aGF0IHdpbGwgYmUgcGxhY2VkIGluIHRoZSBjZW50ZXIgb2YgdGhlIHNjcmVlbi5cbiAqIEBwYXJhbSBkaW1lbnNpb25zLndpZHRoIFRoZSB3aWR0aCBvZiB0aGUgd2luZG93IHRoYXQgaXMgZ29pbmcgdG8gYmUgcGxhY2VkLlxuICogQHBhcmFtIGRpbWVuc2lvbnMuaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHdpbmRvdyB0aGF0IGlzIGdvaW5nIHRvIGJlIHBsYWNlZC5cbiAqIEByZXR1cm5zIFRoZSB4LCB5IGNvLW9yZGluYXRlcyB0byBwb3NpdGlvbiB0aGUgd2luZG93XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjZW50ZXJDb250ZW50SW5JZGVudGl0eShcblx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uSWRlbnRpdHksXG5cdGRpbWVuc2lvbnM6IHsgd2lkdGg6IG51bWJlcjsgaGVpZ2h0OiBudW1iZXIgfVxuKTogUHJvbWlzZTx7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0gfCB1bmRlZmluZWQ+IHtcblx0Y29uc3QgYm91bmRzID0gYXdhaXQgZ2V0SWRlbnRpdHlCb3VuZHMoY2xpZW50SWRlbnRpdHkpO1xuXHRjb25zdCBib3VuZHNDZW50ZXIgPSBnZXRCb3VuZHNDZW50ZXIoYm91bmRzKTtcblx0Y29uc3QgbW9uaXRvckluZm8gPSBhd2FpdCBmaW5kTW9uaXRvckNvbnRhaW5pbmdQb2ludChib3VuZHNDZW50ZXIpO1xuXHRyZXR1cm4gY2VudGVyQ29udGVudEluUmVjdChtb25pdG9ySW5mby5hdmFpbGFibGVSZWN0LCBkaW1lbnNpb25zKTtcbn1cblxuLyoqXG4gKiBQcm92aWRlcyB4IGFuZCB5IGNvLW9yZGluYXRlcyB0byBwb3NpdGlvbiBjb250ZW50IG9mIGEgZ2l2ZW4gc2l6ZSBpbiByZWxhdGlvbiB0byBhIHJlY3QuXG4gKiBAcGFyYW0gYXZhaWxhYmxlUmVjdCBUaGUgYXZhaWxhYmxlIHJlY3QgdG8gcG9zaXRpb24gdGhlIGNvbnRlbnQgaW4uXG4gKiBAcGFyYW0gYXZhaWxhYmxlUmVjdC5sZWZ0IFRoZSBhdmFpbGFibGUgcmVjdCBsZWZ0IHRvIHBvc2l0aW9uIHRoZSBjb250ZW50IGluLlxuICogQHBhcmFtIGF2YWlsYWJsZVJlY3QudG9wIFRoZSBhdmFpbGFibGUgcmVjdCB0b3AgdG8gcG9zaXRpb24gdGhlIGNvbnRlbnQgaW4uXG4gKiBAcGFyYW0gYXZhaWxhYmxlUmVjdC5yaWdodCBUaGUgYXZhaWxhYmxlIHJlY3QgcmlnaHQgdG8gcG9zaXRpb24gdGhlIGNvbnRlbnQgaW4uXG4gKiBAcGFyYW0gYXZhaWxhYmxlUmVjdC5ib3R0b20gVGhlIGF2YWlsYWJsZSByZWN0IGJvdHRvbSB0byBwb3NpdGlvbiB0aGUgY29udGVudCBpbi5cbiAqIEBwYXJhbSBjb250ZW50RGltZW5zaW9ucyBUaGUgZGltZW5zaW9ucyBvZiB0aGUgY29udGVudCB0aGF0IHdpbGwgYmUgcGxhY2VkIGluIHRoZSBjZW50ZXIgb2YgdGhlIHNjcmVlbi5cbiAqIEBwYXJhbSBjb250ZW50RGltZW5zaW9ucy53aWR0aCBUaGUgd2lkdGggb2YgdGhlIGNvbnRlbnQgdGhhdCBpcyBnb2luZyB0byBiZSBwbGFjZWQuXG4gKiBAcGFyYW0gY29udGVudERpbWVuc2lvbnMuaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIGNvbnRlbnQgdGhhdCBpcyBnb2luZyB0byBiZSBwbGFjZWQuXG4gKiBAcmV0dXJucyBUaGUgeCwgeSBjby1vcmRpbmF0ZXMgdG8gcG9zaXRpb24gdGhlIGNvbnRlbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNlbnRlckNvbnRlbnRJblJlY3QoXG5cdGF2YWlsYWJsZVJlY3Q6IHsgbGVmdDogbnVtYmVyOyB0b3A6IG51bWJlcjsgcmlnaHQ6IG51bWJlcjsgYm90dG9tOiBudW1iZXIgfSxcblx0Y29udGVudERpbWVuc2lvbnM6IHsgd2lkdGg6IG51bWJlcjsgaGVpZ2h0OiBudW1iZXIgfVxuKTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9IHtcblx0Y29uc3QgaGVpZ2h0ID0gYXZhaWxhYmxlUmVjdC5ib3R0b20gLSBhdmFpbGFibGVSZWN0LnRvcDtcblx0Y29uc3Qgd2lkdGggPSBhdmFpbGFibGVSZWN0LnJpZ2h0IC0gYXZhaWxhYmxlUmVjdC5sZWZ0O1xuXHRjb25zdCBkaXZpZGVkUmVjdFdpZHRoID0gd2lkdGggLyAyO1xuXHRjb25zdCBkaXZpZGVkUmVjdEhlaWdodCA9IGhlaWdodCAvIDI7XG5cdGNvbnN0IGRpdmlkZWREaW1lbnNpb25XaWR0aCA9IGNvbnRlbnREaW1lbnNpb25zLndpZHRoIC8gMjtcblx0Y29uc3QgZGl2aWRlZERpbWVuc2lvbkhlaWdodCA9IGNvbnRlbnREaW1lbnNpb25zLmhlaWdodCAvIDI7XG5cdGNvbnN0IHggPSBhdmFpbGFibGVSZWN0LmxlZnQgKyBkaXZpZGVkUmVjdFdpZHRoIC0gZGl2aWRlZERpbWVuc2lvbldpZHRoO1xuXHRjb25zdCB5ID0gYXZhaWxhYmxlUmVjdC50b3AgKyBkaXZpZGVkUmVjdEhlaWdodCAtIGRpdmlkZWREaW1lbnNpb25IZWlnaHQ7XG5cblx0cmV0dXJuIHsgeDogTWF0aC5yb3VuZCh4KSwgeTogTWF0aC5yb3VuZCh5KSB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIG1vbml0b3IgZGV0YWlscyBmb3IgdGhlIG1vbml0b3IgYSB2aWV3L3dpbmRvdyBpcyBwbGFjZWQgb24uXG4gKiBAcGFyYW0gY2xpZW50SWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIHRoZSB2aWV3L3dpbmRvdyB0byBjaGVjayBhZ2FpbnN0LlxuICogQHJldHVybnMgVGhlIG1vbml0b3IgdGhlIHZpZXcvd2luZG93IGxpdmVzIG9uIG9yIHVuZGVmaW5lZCBpZiBubyBtYXRjaCB3YXMgZm91bmQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRJZGVudGl0eUJvdW5kcyhcblx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uSWRlbnRpdHlcbik6IFByb21pc2U8T3BlbkZpbi5Cb3VuZHMgfCB1bmRlZmluZWQ+IHtcblx0bGV0IGJvdW5kczogT3BlbkZpbi5Cb3VuZHMgfCB1bmRlZmluZWQ7XG5cdGxldCBjdXJyZW50V2luZG93OiBPcGVuRmluLldpbmRvdyB8IHVuZGVmaW5lZDtcblxuXHR0cnkge1xuXHRcdGNvbnN0IHRhcmdldFZpZXcgPSBmaW4uVmlldy53cmFwU3luYyhjbGllbnRJZGVudGl0eSk7XG5cdFx0Y3VycmVudFdpbmRvdyA9IGF3YWl0IHRhcmdldFZpZXcuZ2V0Q3VycmVudFdpbmRvdygpO1xuXHR9IGNhdGNoIHtcblx0XHQvLyB3ZSB3ZXJlIG5vdCBwYXNzZWQgYSB2aWV3LlxuXHR9XG5cblx0aWYgKGlzRW1wdHkoYm91bmRzKSkge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCB0YXJnZXRXaW5kb3cgPSBjdXJyZW50V2luZG93ID8/IGZpbi5XaW5kb3cud3JhcFN5bmMoY2xpZW50SWRlbnRpdHkpO1xuXHRcdFx0Ym91bmRzID0gYXdhaXQgdGFyZ2V0V2luZG93LmdldEJvdW5kcygpO1xuXHRcdH0gY2F0Y2gge1xuXHRcdFx0Ly8gaXQgd2Fzbid0IGEgd2luZG93XG5cdFx0fVxuXHR9XG5cblx0aWYgKGlzRW1wdHkoYm91bmRzKSkge1xuXHRcdHRyeSB7XG5cdFx0XHRib3VuZHMgPSBhd2FpdCBmaW4ubWUuZ2V0Qm91bmRzKCk7XG5cdFx0fSBjYXRjaCB7XG5cdFx0XHQvLyB1bmFibGUgdG8gZ2V0IG93biBib3VuZHNcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gYm91bmRzO1xufVxuXG4vKipcbiAqIEZpbmQgdGhlIG1vbml0b3Igd2hpY2ggY29udGFpbnMgdGhlIHBvaW50IGFuZCByZXR1cm5zIGl0LlxuICogQHBhcmFtIHBvaW50IFRoZSBwb2ludCBjb29yZCB0byBsb2NhdGUuXG4gKiBAcGFyYW0gcG9pbnQueCBUaGUgeCBjb29yZFxuICogQHBhcmFtIHBvaW50LnkgVGhlIHkgY29vcmRcbiAqIEByZXR1cm5zIFRoZSBtb25pdG9yIGNvbnRhaW5pbmcgdGhlIHBvaW50LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmluZE1vbml0b3JDb250YWluaW5nUG9pbnQocG9pbnQ6IHtcblx0eD86IG51bWJlcjtcblx0eT86IG51bWJlcjtcbn0pOiBQcm9taXNlPE9wZW5GaW4uTW9uaXRvckRldGFpbHM+IHtcblx0Y29uc3QgbW9uaXRvckluZm8gPSBhd2FpdCBmaW4uU3lzdGVtLmdldE1vbml0b3JJbmZvKCk7XG5cblx0Y29uc3QgeCA9IHBvaW50Lng7XG5cdGNvbnN0IHkgPSBwb2ludC55O1xuXHRpZiAoIWlzRW1wdHkoeCkgJiYgIWlzRW1wdHkoeSkpIHtcblx0XHRmb3IgKGNvbnN0IG1vbml0b3Igb2YgbW9uaXRvckluZm8ubm9uUHJpbWFyeU1vbml0b3JzKSB7XG5cdFx0XHRpZiAocG9pbnRJblJlY3QoeyB4LCB5IH0sIG1vbml0b3IubW9uaXRvclJlY3QpKSB7XG5cdFx0XHRcdHJldHVybiBtb25pdG9yO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiBtb25pdG9ySW5mby5wcmltYXJ5TW9uaXRvcjtcbn1cblxuLyoqXG4gKiBJcyB0aGUgcG9pbnQgaW4gdGhlIHJlY3RhbmdsZS5cbiAqIEBwYXJhbSBwb2ludCBUaGUgY29vcmQgdG8gbWF0Y2guXG4gKiBAcGFyYW0gcG9pbnQueCBUaGUgeCBjb29yZC5cbiAqIEBwYXJhbSBwb2ludC55IFRoZSB5IGNvb3JkLlxuICogQHBhcmFtIHJlY3QgVGhlIHJlY3QuXG4gKiBAcGFyYW0gcmVjdC50b3AgVGhlIHJlY3QgdG9wLlxuICogQHBhcmFtIHJlY3QubGVmdCBUaGUgcmVjdCBsZWZ0LlxuICogQHBhcmFtIHJlY3QuYm90dG9tIFRoZSByZWN0IGJvdHRvbS5cbiAqIEBwYXJhbSByZWN0LnJpZ2h0IFRoZSByZWN0IHJpZ2h0LlxuICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgcG9pbnQgaXMgaW4gdGhlIHJlY3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwb2ludEluUmVjdChcblx0cG9pbnQ6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSxcblx0cmVjdDoge1xuXHRcdHRvcDogbnVtYmVyO1xuXHRcdGxlZnQ6IG51bWJlcjtcblx0XHRib3R0b206IG51bWJlcjtcblx0XHRyaWdodDogbnVtYmVyO1xuXHR9XG4pOiBib29sZWFuIHtcblx0cmV0dXJuIHBvaW50LnggPj0gcmVjdC5sZWZ0ICYmIHBvaW50LnggPD0gcmVjdC5yaWdodCAmJiBwb2ludC55ID49IHJlY3QudG9wICYmIHBvaW50LnkgPD0gcmVjdC5ib3R0b207XG59XG5cbi8qKlxuICogR2V0IHRoZSBjZW50ZXIgZm9yIGEgYm91bmRpbmcgcmVjdGFuZ2xlLlxuICogQHBhcmFtIGJvdW5kcyBUaGUgcmVjdFxuICogQHBhcmFtIGJvdW5kcy50b3AgVGhlIHJlY3QgdG9wXG4gKiBAcGFyYW0gYm91bmRzLmxlZnQgVGhlIHJlY3QgbGVmdFxuICogQHBhcmFtIGJvdW5kcy53aWR0aCBUaGUgcmVjdCB3aWR0aFxuICogQHBhcmFtIGJvdW5kcy5oZWlnaHQgVGhlIHJlY3QgaGVpZ2h0XG4gKiBAcmV0dXJucyB0aGUgeCBhbmQgeSBvZiB0aGUgYm91bmRzIGNlbnRlciBvciBhbiBvYmplY3Qgbm90IGNvbnRhaW5pbmcgeCBvciB5LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Qm91bmRzQ2VudGVyKGJvdW5kcz86IE9wZW5GaW4uQm91bmRzKTogeyB4PzogbnVtYmVyOyB5PzogbnVtYmVyIH0ge1xuXHRsZXQgYm91bmRzQ2VudGVyWDogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXHRsZXQgYm91bmRzQ2VudGVyWTogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXHRpZiAoIWlzRW1wdHkoYm91bmRzKSkge1xuXHRcdGNvbnN0IGhhbGZXaWR0aCA9IGJvdW5kcy53aWR0aCAvIDI7XG5cdFx0Y29uc3QgaGFsZkhlaWdodCA9IGJvdW5kcy5oZWlnaHQgLyAyO1xuXHRcdGJvdW5kc0NlbnRlclggPSBib3VuZHMubGVmdCArIGhhbGZXaWR0aDtcblx0XHRib3VuZHNDZW50ZXJZID0gYm91bmRzLnRvcCArIGhhbGZIZWlnaHQ7XG5cdFx0cmV0dXJuIHsgeDogTWF0aC5yb3VuZChib3VuZHNDZW50ZXJYKSwgeTogTWF0aC5yb3VuZChib3VuZHNDZW50ZXJZKSB9O1xuXHR9XG5cdHJldHVybiB7fTtcbn1cblxuLyoqXG4gKiBHaXZlbiBicm93c2VyIHNldHRpbmdzIHdoYXQgd2luZG93IHBvc2l0aW9uaW5nIG9wdGlvbnMgc2hvdWxkIGJlIHVzZWQ/XG4gKiBAcGFyYW0gc2V0dGluZ3MgVGhlIGJyb3dzZXIgc2V0dGluZ3MgdGhhdCBoYXZlIGJlZW4gcHJvdmlkZWQuXG4gKiBAcmV0dXJucyBhIHNldCBvZiB3aW5kb3cgcG9zaXRpb25pbmcgb3B0aW9ucy5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFdpbmRvd1Bvc2l0aW9uT3B0aW9ucyhcblx0c2V0dGluZ3M/OiBCcm93c2VyUHJvdmlkZXJPcHRpb25zXG4pOiBQcm9taXNlPFdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucz4ge1xuXHRjb25zdCB3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnM6IFdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucyA9IHt9O1xuXHR3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnMuZGVmYXVsdHMgPSB7fTtcblx0aWYgKCFpc0VtcHR5KHNldHRpbmdzKSkge1xuXHRcdHdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucy53aW5kb3dQb3NpdGlvbmluZ1N0cmF0ZWd5ID0gc2V0dGluZ3Mud2luZG93UG9zaXRpb25pbmdTdHJhdGVneTtcblx0XHR3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnMuZGlzYWJsZVdpbmRvd1Bvc2l0aW9uaW5nU3RyYXRlZ3kgPSBzZXR0aW5ncy5kaXNhYmxlV2luZG93UG9zaXRpb25pbmdTdHJhdGVneTtcblx0XHRpZiAoIWlzRW1wdHkoc2V0dGluZ3M/LmRlZmF1bHRXaW5kb3dPcHRpb25zPy5kZWZhdWx0TGVmdCkpIHtcblx0XHRcdHdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucy5kZWZhdWx0cy5sZWZ0ID0gc2V0dGluZ3MuZGVmYXVsdFdpbmRvd09wdGlvbnMuZGVmYXVsdExlZnQ7XG5cdFx0fVxuXHRcdGlmICghaXNFbXB0eShzZXR0aW5ncz8uZGVmYXVsdFdpbmRvd09wdGlvbnM/LmRlZmF1bHRUb3ApKSB7XG5cdFx0XHR3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnMuZGVmYXVsdHMudG9wID0gc2V0dGluZ3MuZGVmYXVsdFdpbmRvd09wdGlvbnMuZGVmYXVsdFRvcDtcblx0XHR9XG5cdH1cblx0aWYgKGlzRW1wdHkod2luZG93UG9zaXRpb25pbmdPcHRpb25zLmRlZmF1bHRzLmxlZnQpIHx8IGlzRW1wdHkod2luZG93UG9zaXRpb25pbmdPcHRpb25zLmRlZmF1bHRzLnRvcCkpIHtcblx0XHRjb25zdCBhcHAgPSBhd2FpdCBmaW4uQXBwbGljYXRpb24uZ2V0Q3VycmVudCgpO1xuXHRcdGNvbnN0IHBsYXRmb3JtTWFuaWZlc3Q6IE9wZW5GaW4uTWFuaWZlc3QgPSBhd2FpdCBhcHAuZ2V0TWFuaWZlc3QoKTtcblx0XHRpZiAoIWlzRW1wdHkocGxhdGZvcm1NYW5pZmVzdD8ucGxhdGZvcm0/LmRlZmF1bHRXaW5kb3dPcHRpb25zPy5kZWZhdWx0TGVmdCkpIHtcblx0XHRcdHdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucy5kZWZhdWx0cy5sZWZ0ID0gcGxhdGZvcm1NYW5pZmVzdC5wbGF0Zm9ybS5kZWZhdWx0V2luZG93T3B0aW9ucy5kZWZhdWx0TGVmdDtcblx0XHR9XG5cdFx0aWYgKCFpc0VtcHR5KHBsYXRmb3JtTWFuaWZlc3Q/LnBsYXRmb3JtPy5kZWZhdWx0V2luZG93T3B0aW9ucz8uZGVmYXVsdFRvcCkpIHtcblx0XHRcdHdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucy5kZWZhdWx0cy50b3AgPSBwbGF0Zm9ybU1hbmlmZXN0LnBsYXRmb3JtLmRlZmF1bHRXaW5kb3dPcHRpb25zLmRlZmF1bHRUb3A7XG5cdFx0fVxuXHR9XG5cdHJldHVybiB3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnM7XG59XG5cbi8qKlxuICogR2V0IHRoZSB3aW5kb3cgcG9zaXRpb24gdXNpbmcgYSBzdHJhdGVneS5cbiAqIEBwYXJhbSB3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnMgVGhlIG9wdGlvbnMgZm9yIHdpbmRvdyBwb3NpdGlvbmluZy5cbiAqIEBwYXJhbSB3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnMud2luZG93UG9zaXRpb25pbmdTdHJhdGVneSBUaGUgc3RyYXRlZ3kgZm9yIHdpbmRvdyBwb3NpdGlvbmluZy5cbiAqIEBwYXJhbSB3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnMud2luZG93UG9zaXRpb25pbmdTdHJhdGVneS54IFRoZSB4IGNvb3JkaW5hdGUuXG4gKiBAcGFyYW0gd2luZG93UG9zaXRpb25pbmdPcHRpb25zLndpbmRvd1Bvc2l0aW9uaW5nU3RyYXRlZ3kueSBUaGUgeSBjb29yZGluYXRlLlxuICogQHBhcmFtIHdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucy5kaXNhYmxlV2luZG93UG9zaXRpb25pbmdTdHJhdGVneSBXaGV0aGVyIHRvIGRpc2FibGUgdGhlIHdpbmRvdyBwb3NpdGlvbmluZyBzdHJhdGVneS5cbiAqIEBwYXJhbSByZWxhdGVkVG8gVGhlIHJlbGF0ZWQgbW9uaXRvciBvciBpZGVudGl0eSBvciB4L3kgcG9zaXRpb24uXG4gKiBAcmV0dXJucyBUaGUgeCBhbmQgeSBjb29yZGluYXRlcyBvZiB0aGUgd2luZG93IHBvc2l0aW9uLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0V2luZG93UG9zaXRpb25Vc2luZ1N0cmF0ZWd5KFxuXHR3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnM/OiBXaW5kb3dQb3NpdGlvbmluZ09wdGlvbnMsXG5cdHJlbGF0ZWRUbz86IE9wZW5GaW4uTW9uaXRvckRldGFpbHMgfCBPcGVuRmluLklkZW50aXR5IHwgeyB4OiBudW1iZXI7IHk6IG51bWJlciB9XG4pOiBQcm9taXNlPHsgbGVmdDogbnVtYmVyOyB0b3A6IG51bWJlciB9IHwgdW5kZWZpbmVkPiB7XG5cdGlmICh3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnM/LmRpc2FibGVXaW5kb3dQb3NpdGlvbmluZ1N0cmF0ZWd5ID09PSB0cnVlKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGxldCB0YXJnZXRNb25pdG9yOiBPcGVuRmluLk1vbml0b3JEZXRhaWxzIHwgdW5kZWZpbmVkO1xuXG5cdGlmIChpc0VtcHR5KHJlbGF0ZWRUbykpIHtcblx0XHRjb25zdCBtb25pdG9ycyA9IGF3YWl0IGZpbi5TeXN0ZW0uZ2V0TW9uaXRvckluZm8oKTtcblx0XHR0YXJnZXRNb25pdG9yID0gbW9uaXRvcnMucHJpbWFyeU1vbml0b3I7XG5cdH0gZWxzZSBpZiAoIWlzRW1wdHkocmVsYXRlZFRvKSAmJiBcIm1vbml0b3JSZWN0XCIgaW4gcmVsYXRlZFRvKSB7XG5cdFx0dGFyZ2V0TW9uaXRvciA9IHJlbGF0ZWRUbztcblx0fSBlbHNlIGlmICghaXNFbXB0eShyZWxhdGVkVG8pICYmIFwieFwiIGluIHJlbGF0ZWRUbykge1xuXHRcdHRhcmdldE1vbml0b3IgPSBhd2FpdCBmaW5kTW9uaXRvckNvbnRhaW5pbmdQb2ludChyZWxhdGVkVG8pO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnN0IGJvdW5kcyA9IGF3YWl0IGdldElkZW50aXR5Qm91bmRzKHJlbGF0ZWRUbyk7XG5cdFx0aWYgKGlzRW1wdHkoYm91bmRzKSkge1xuXHRcdFx0Y29uc3QgbW9uaXRvcnMgPSBhd2FpdCBmaW4uU3lzdGVtLmdldE1vbml0b3JJbmZvKCk7XG5cdFx0XHR0YXJnZXRNb25pdG9yID0gbW9uaXRvcnMucHJpbWFyeU1vbml0b3I7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRhcmdldE1vbml0b3IgPSBhd2FpdCBmaW5kTW9uaXRvckNvbnRhaW5pbmdQb2ludCh7IHg6IGJvdW5kcy5sZWZ0LCB5OiBib3VuZHMudG9wIH0pO1xuXHRcdH1cblx0fVxuXHRjb25zdCB3aW5kb3dEZWZhdWx0TGVmdCA9IHdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucz8uZGVmYXVsdHM/LmxlZnQgPz8gMDtcblx0Y29uc3Qgd2luZG93RGVmYXVsdFRvcCA9IHdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucz8uZGVmYXVsdHM/LnRvcCA/PyAwO1xuXG5cdC8vIEdldCB0aGUgYXZhaWxhYmxlIHJlY3QgZm9yIHRoZSBkaXNwbGF5IHNvIHdlIGNhbiB0YWtlIGluIHRvIGFjY291bnRcblx0Ly8gT1MgbWVudXMsIHRhc2sgYmFyIGV0Y1xuXHRjb25zdCBhdmFpbGFibGVMZWZ0ID0gdGFyZ2V0TW9uaXRvci5hdmFpbGFibGVSZWN0LmxlZnQ7XG5cdGNvbnN0IGF2YWlsYWJsZVRvcCA9IHRhcmdldE1vbml0b3IuYXZhaWxhYmxlUmVjdC50b3A7XG5cdGNvbnN0IHdpbmRvd09mZnNldHNYOiBudW1iZXIgPSB3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnM/LndpbmRvd1Bvc2l0aW9uaW5nU3RyYXRlZ3k/LnggPz8gMzA7XG5cdGNvbnN0IHdpbmRvd09mZnNldHNZOiBudW1iZXIgPSB3aW5kb3dQb3NpdGlvbmluZ09wdGlvbnM/LndpbmRvd1Bvc2l0aW9uaW5nU3RyYXRlZ3k/LnkgPz8gMzA7XG5cdGNvbnN0IHdpbmRvd09mZnNldHNNYXhJbmNyZW1lbnRzOiBudW1iZXIgPVxuXHRcdHdpbmRvd1Bvc2l0aW9uaW5nT3B0aW9ucz8ud2luZG93UG9zaXRpb25pbmdTdHJhdGVneT8ubWF4SW5jcmVtZW50cyA/PyA4O1xuXHRjb25zdCB2aXNpYmxlV2luZG93cyA9IGF3YWl0IGdldEFsbFZpc2libGVXaW5kb3dzKCk7XG5cdC8vIEdldCB0aGUgdG9wIGxlZnQgYm91bmRzIGZvciBhbGwgdGhlIHZpc2libGUgd2luZG93c1xuXHRjb25zdCB0b3BMZWZ0Qm91bmRzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG5cdFx0dmlzaWJsZVdpbmRvd3MubWFwKGFzeW5jICh3aW4pID0+IHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnN0IGJvdW5kcyA9IGF3YWl0IHdpbi5nZXRCb3VuZHMoKTtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRsZWZ0OiBib3VuZHMubGVmdCxcblx0XHRcdFx0XHR0b3A6IGJvdW5kcy50b3AsXG5cdFx0XHRcdFx0cmlnaHQ6IGJvdW5kcy5sZWZ0ICsgd2luZG93T2Zmc2V0c1gsXG5cdFx0XHRcdFx0Ym90dG9tOiBib3VuZHMudG9wICsgd2luZG93T2Zmc2V0c1lcblx0XHRcdFx0fTtcblx0XHRcdH0gY2F0Y2gge1xuXHRcdFx0XHQvLyByZXR1cm4gYSBkdW1teSBlbnRyeS5cblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRsZWZ0OiAwLFxuXHRcdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0XHRyaWdodDogMCxcblx0XHRcdFx0XHRib3R0b206IDBcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9KVxuXHQpO1xuXG5cdGxldCBtaW5Db3VudFZhbDogbnVtYmVyID0gMTAwMDtcblx0bGV0IG1pbkNvdW50SW5kZXggPSB3aW5kb3dPZmZzZXRzTWF4SW5jcmVtZW50cztcblxuXHQvLyBOb3cgc2VlIGhvdyBtYW55IHdpbmRvd3MgYXBwZWFyIGluIGVhY2ggaW5jcmVtZW50IHNsb3Rcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCB3aW5kb3dPZmZzZXRzTWF4SW5jcmVtZW50czsgaSsrKSB7XG5cdFx0Y29uc3QgeFBvcyA9IGkgKiB3aW5kb3dPZmZzZXRzWDtcblx0XHRjb25zdCB5UG9zID0gaSAqIHdpbmRvd09mZnNldHNZO1xuXHRcdGNvbnN0IGxlZnRQb3MgPSB3aW5kb3dEZWZhdWx0TGVmdCArIHhQb3M7XG5cdFx0Y29uc3QgdG9wUG9zID0gd2luZG93RGVmYXVsdFRvcCArIHlQb3M7XG5cdFx0Y29uc3QgZm91bmRXaW5zID0gdG9wTGVmdEJvdW5kcy5maWx0ZXIoXG5cdFx0XHQodG9wTGVmdFdpbkJvdW5kcykgPT5cblx0XHRcdFx0dG9wTGVmdFdpbkJvdW5kcy5sZWZ0ID49IGxlZnRQb3MgKyBhdmFpbGFibGVMZWZ0ICYmXG5cdFx0XHRcdHRvcExlZnRXaW5Cb3VuZHMucmlnaHQgPD0gbGVmdFBvcyArIHdpbmRvd09mZnNldHNYICsgYXZhaWxhYmxlTGVmdCAmJlxuXHRcdFx0XHR0b3BMZWZ0V2luQm91bmRzLnRvcCA+PSB0b3BQb3MgKyBhdmFpbGFibGVUb3AgJiZcblx0XHRcdFx0dG9wTGVmdFdpbkJvdW5kcy5ib3R0b20gPD0gdG9wUG9zICsgd2luZG93T2Zmc2V0c1kgKyBhdmFpbGFibGVUb3Bcblx0XHQpO1xuXHRcdC8vIElmIHRoaXMgc2xvdCBoYXMgbGVzcyB0aGFuIHRoZSBjdXJyZW50IG1pbmltdW0gdXNlIHRoaXMgc2xvdFxuXHRcdGlmIChmb3VuZFdpbnMubGVuZ3RoIDwgbWluQ291bnRWYWwpIHtcblx0XHRcdG1pbkNvdW50VmFsID0gZm91bmRXaW5zLmxlbmd0aDtcblx0XHRcdG1pbkNvdW50SW5kZXggPSBpO1xuXHRcdH1cblx0fVxuXG5cdGNvbnN0IHhPZmZzZXQgPSBtaW5Db3VudEluZGV4ICogd2luZG93T2Zmc2V0c1g7XG5cdGNvbnN0IHggPSB3aW5kb3dEZWZhdWx0TGVmdCArIHhPZmZzZXQgKyBhdmFpbGFibGVMZWZ0O1xuXHRjb25zdCB5T2Zmc2V0ID0gbWluQ291bnRJbmRleCAqIHdpbmRvd09mZnNldHNZO1xuXHRjb25zdCB5ID0gd2luZG93RGVmYXVsdFRvcCArIHlPZmZzZXQgKyBhdmFpbGFibGVUb3A7XG5cblx0cmV0dXJuIHsgbGVmdDogeCwgdG9wOiB5IH07XG59XG5cbi8qKlxuICogR2V0IGEgbGlzdCBvZiBhbGwgdGhlIHZpc2libGUgd2luZG93cyBpbiB0aGUgcGxhdGZvcm0uXG4gKiBAcmV0dXJucyBUaGUgbGlzdCBvZiB2aXNpYmxlIHdpbmRvd3MuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxWaXNpYmxlV2luZG93cygpOiBQcm9taXNlPE9wZW5GaW4uV2luZG93W10+IHtcblx0Y29uc3QgcGxhdGZvcm0gPSBmaW4uUGxhdGZvcm0uZ2V0Q3VycmVudFN5bmMoKTtcblx0Y29uc3Qgd2luZG93cyA9IGF3YWl0IHBsYXRmb3JtLkFwcGxpY2F0aW9uLmdldENoaWxkV2luZG93cygpO1xuXHRjb25zdCBhdmFpbGFibGVXaW5kb3dzOiBPcGVuRmluLldpbmRvd1tdID0gW107XG5cdGZvciAoY29uc3QgY3VycmVudFdpbmRvdyBvZiB3aW5kb3dzKSB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGlzU2hvd2luZyA9IGF3YWl0IGN1cnJlbnRXaW5kb3cuaXNTaG93aW5nKCk7XG5cdFx0XHRpZiAoaXNTaG93aW5nKSB7XG5cdFx0XHRcdGF2YWlsYWJsZVdpbmRvd3MucHVzaChjdXJyZW50V2luZG93KTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIHtcblx0XHRcdC8vIGlmIHRoZSB3aW5kb3cgaXMgZGVzdHJveWVkIGJlZm9yZSBkZXRlcm1pbmluZyBpZiBpdCBpcyBzaG93aW5nIHRoZW5cblx0XHRcdC8vIHdlIHNob3VsZCBtb3ZlIHRvIHRoZSBuZXh0IHdpbmRvdyBidXQgbm90IHRocm93LlxuXHRcdH1cblx0fVxuXHRyZXR1cm4gYXZhaWxhYmxlV2luZG93cztcbn1cbiIsImltcG9ydCB0eXBlIHsgQXBwc0ZvckludGVudCwgUGxhdGZvcm1BcHAgfSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvc2hhcGVzL2FwcC1zaGFwZXNcIjtcbmltcG9ydCB0eXBlIHsgQXBwSW50ZW50cyB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci9zaGFwZXMvZmRjMy0yLTAtc2hhcGVzXCI7XG5pbXBvcnQgdHlwZSB7IExvZ2dlciB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci9zaGFwZXMvbG9nZ2VyLXNoYXBlc1wiO1xuaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci91dGlsc1wiO1xuXG4vKipcbiAqIFRoZSBBcHAgSW50ZW50IEhlbHBlciBpbnNwZWN0cyBhcHAgY2F0YWxvZ3MgdG8gZGlzY292ZXIgc3VwcG9ydGVkIGludGVudHMgYW5kIGNvbnRleHRzLlxuICovXG5leHBvcnQgY2xhc3MgQXBwSW50ZW50SGVscGVyIHtcblx0cHJpdmF0ZSByZWFkb25seSBfZ2V0QXBwczogKCkgPT4gUHJvbWlzZTxQbGF0Zm9ybUFwcFtdPjtcblxuXHRwcml2YXRlIHJlYWRvbmx5IF9sb2dnZXI6IExvZ2dlcjtcblxuXHQvKipcblx0ICogQ3JlYXRlIGFuIGluc3RhbmNlIG9mIHRoZSBBcHAgSW50ZW50IEhlbHBlci5cblx0ICogQHBhcmFtIGdldEFwcHMgcmV0dXJucyBhbiBhcnJheSBvZiBBcHBzXG5cdCAqIEBwYXJhbSBsb2dnZXIgdGhlIGxvZ2dlciB0byB1c2UuXG5cdCAqL1xuXHRjb25zdHJ1Y3RvcihnZXRBcHBzOiAoKSA9PiBQcm9taXNlPFBsYXRmb3JtQXBwW10+LCBsb2dnZXI6IExvZ2dlcikge1xuXHRcdHRoaXMuX2dldEFwcHMgPSBnZXRBcHBzO1xuXHRcdHRoaXMuX2xvZ2dlciA9IGxvZ2dlcjtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgdGhlIGFwcGxpY2F0aW9uIHRoYXQgc3VwcG9ydCB0aGUgcmVxdWVzdGVkIGludGVudC5cblx0ICogQHBhcmFtIGludGVudCBUaGUgaW50ZW50IHRoZSBhcHBsaWNhdGlvbiBtdXN0IHN1cHBvcnQuXG5cdCAqIEByZXR1cm5zIFRoZSBsaXN0IG9mIGFwcGxpY2F0aW9uIHRoYXQgc3VwcG9ydCB0aGUgaW50ZW50LlxuXHQgKi9cblx0cHVibGljIGFzeW5jIGdldEFwcHNCeUludGVudChpbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8UGxhdGZvcm1BcHBbXT4ge1xuXHRcdGNvbnN0IGFwcHMgPSBhd2FpdCB0aGlzLl9nZXRBcHBzKCk7XG5cdFx0cmV0dXJuIGFwcHMuZmlsdGVyKChhcHApID0+IHtcblx0XHRcdGNvbnN0IGxpc3RlbnNGb3IgPSBhcHAuaW50ZXJvcD8uaW50ZW50cz8ubGlzdGVuc0ZvcjtcblxuXHRcdFx0aWYgKGlzRW1wdHkobGlzdGVuc0ZvcikpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0Y29uc3QgaW50ZW50TmFtZXMgPSBPYmplY3Qua2V5cyhsaXN0ZW5zRm9yKTtcblx0XHRcdGZvciAoY29uc3QgaW50ZW50TmFtZSBvZiBpbnRlbnROYW1lcykge1xuXHRcdFx0XHRpZiAoaW50ZW50TmFtZS50b0xvd2VyQ2FzZSgpID09PSBpbnRlbnQudG9Mb3dlckNhc2UoKSkge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGFuIGludGVudCBhbmQgdGhlIGFwcHMgdGhhdCBzdXBwb3J0IGl0LlxuXHQgKiBAcGFyYW0gaW50ZW50IFRoZSBpbnRlbnQgdG8gbG9vayBmb3IuXG5cdCAqIEBwYXJhbSBjb250ZXh0VHlwZSBPcHRpb25hbCBjb250ZXh0IHR5cGUgdG8gbG9vayBmb3IuXG5cdCAqIEBwYXJhbSByZXN1bHRUeXBlIE9wdGlvbmFsIHJlc3VsdCB0eXBlIHRvIGxvb2sgZm9yLlxuXHQgKiBAcmV0dXJucyBUaGUgaW50ZW50IGFuZCBpdHMgc3VwcG9ydGluZyBhcHBzIGlmIGZvdW5kLlxuXHQgKi9cblx0cHVibGljIGFzeW5jIGdldEludGVudChcblx0XHRpbnRlbnQ6IHN0cmluZyxcblx0XHRjb250ZXh0VHlwZT86IHN0cmluZyxcblx0XHRyZXN1bHRUeXBlPzogc3RyaW5nXG5cdCk6IFByb21pc2U8QXBwc0ZvckludGVudCB8IHVuZGVmaW5lZD4ge1xuXHRcdGNvbnN0IGFwcHMgPSBhd2FpdCB0aGlzLl9nZXRBcHBzKCk7XG5cblx0XHRpZiAoYXBwcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuX2xvZ2dlci53YXJuKFwiVGhlcmUgd2FzIG5vIGFwcHMgcmV0dXJuZWQgc28gd2UgYXJlIHVuYWJsZSB0byBmaW5kIGFwcHMgdGhhdCBzdXBwb3J0IGFuIGludGVudFwiKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb25zdCBpbnRlbnRzTWFwOiB7IFtrZXk6IHN0cmluZ106IEFwcHNGb3JJbnRlbnQgfSA9IHt9O1xuXG5cdFx0Zm9yIChjb25zdCBhcHAgb2YgYXBwcykge1xuXHRcdFx0aWYgKGFwcC5pbnRlcm9wPy5pbnRlbnRzPy5saXN0ZW5zRm9yICYmICFpc0VtcHR5KGFwcC5pbnRlcm9wLmludGVudHMubGlzdGVuc0ZvcltpbnRlbnRdKSkge1xuXHRcdFx0XHRjb25zdCBhcHBJbnRlbnQgPSBhcHAuaW50ZXJvcC5pbnRlbnRzLmxpc3RlbnNGb3JbaW50ZW50XTtcblx0XHRcdFx0Y29uc3QgaW5jbHVkZSA9IHRoaXMuYXBwSW50ZW50Q29udGFpbnMoYXBwSW50ZW50LCBjb250ZXh0VHlwZSwgcmVzdWx0VHlwZSk7XG5cdFx0XHRcdGlmIChpbmNsdWRlKSB7XG5cdFx0XHRcdFx0Ly8gcmUtdXNlIGFwcHJvYWNoIHVzZWQgYnkgZ2V0dGluZyBpbnRlbnRzIGJ5IGNvbnRleHQgZm9yIHRoZSBjb250ZXh0IG1hcCBhbHRob3VnaCB0aGlzIHdpbGwgb25seSBoYXZlIG9uZVxuXHRcdFx0XHRcdHRoaXMudXBkYXRlQXBwSW50ZW50c01hcChpbnRlbnRzTWFwLCBpbnRlbnQsIGFwcEludGVudC5kaXNwbGF5TmFtZSwgYXBwKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3VsdHMgPSBPYmplY3QudmFsdWVzKGludGVudHNNYXApO1xuXHRcdGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5fbG9nZ2VyLmluZm8oXG5cdFx0XHRcdGBObyByZXN1bHRzIGZvdW5kIGZvciBmaW5kSW50ZW50IGZvciBpbnRlbnQgJHtpbnRlbnR9IGFuZCBjb250ZXh0ICR7Y29udGV4dFR5cGV9IGFuZCByZXN1bHRUeXBlICR7cmVzdWx0VHlwZX1gXG5cdFx0XHQpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH0gZWxzZSBpZiAocmVzdWx0cy5sZW5ndGggPT09IDEpIHtcblx0XHRcdHJldHVybiByZXN1bHRzWzBdO1xuXHRcdH1cblxuXHRcdHRoaXMuX2xvZ2dlci53YXJuKFxuXHRcdFx0YFJlY2VpdmVkIG1vcmUgdGhhbiBvbmUgcmVzdWx0IGZvciBmaW5kSW50ZW50IGZvciBpbnRlbnQgJHtpbnRlbnR9IGFuZCBjb250ZXh0ICR7Y29udGV4dFR5cGV9IGFuZCByZXN1bHRUeXBlICR7cmVzdWx0VHlwZX0uIFJldHVybmluZyB0aGUgZmlyc3QgZW50cnkuYFxuXHRcdCk7XG5cdFx0cmV0dXJuIHJlc3VsdHNbMF07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IHRoZSBhcHBzIHRoYXQgc3VwcG9ydCBpbnRlbnRzIGJ5IHRoZSBjb250ZXh0IHR5cGUuXG5cdCAqIEBwYXJhbSBjb250ZXh0VHlwZSBUaGUgY29udGV4dCB0eXBlIHRoZSBhcHAgbXVzdCBzdXBwb3J0LlxuXHQgKiBAcGFyYW0gcmVzdWx0VHlwZSBUaGUgb3B0aW9uYWwgcmVzdWx0IHR5cGUgdG8gbWF0Y2ggYXMgd2VsbC5cblx0ICogQHJldHVybnMgVGhlIGFwcHMgZm9yIHRoZSBzcGVjaWZpZWQgaW50ZW50LlxuXHQgKi9cblx0cHVibGljIGFzeW5jIGdldEludGVudHNCeUNvbnRleHQoY29udGV4dFR5cGU6IHN0cmluZywgcmVzdWx0VHlwZT86IHN0cmluZyk6IFByb21pc2U8QXBwc0ZvckludGVudFtdPiB7XG5cdFx0Y29uc3QgYXBwcyA9IGF3YWl0IHRoaXMuX2dldEFwcHMoKTtcblxuXHRcdGlmIChhcHBzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5fbG9nZ2VyLndhcm4oXG5cdFx0XHRcdFwiVW5hYmxlIHRvIGdldCBhcHBzIHNvIHdlIGNhbiBub3QgZ2V0IGFwcHMgYW5kIGludGVudHMgdGhhdCBzdXBwb3J0IGEgcGFydGljdWxhciBjb250ZXh0XCJcblx0XHRcdCk7XG5cdFx0XHRyZXR1cm4gW107XG5cdFx0fVxuXG5cdFx0Y29uc3QgaW50ZW50czogeyBba2V5OiBzdHJpbmddOiBBcHBzRm9ySW50ZW50IH0gPSB7fTtcblxuXHRcdGZvciAoY29uc3QgYXBwIG9mIGFwcHMpIHtcblx0XHRcdGNvbnN0IGxpc3RlbnNGb3IgPSBhcHAuaW50ZXJvcD8uaW50ZW50cz8ubGlzdGVuc0ZvcjtcblxuXHRcdFx0aWYgKCFpc0VtcHR5KGxpc3RlbnNGb3IpKSB7XG5cdFx0XHRcdGNvbnN0IHN1cHBvcnRlZEludGVudHMgPSBPYmplY3Qua2V5cyhsaXN0ZW5zRm9yKTtcblx0XHRcdFx0Zm9yIChjb25zdCBzdXBwb3J0ZWRJbnRlbnQgb2Ygc3VwcG9ydGVkSW50ZW50cykge1xuXHRcdFx0XHRcdGNvbnN0IGFwcEludGVudCA9IGxpc3RlbnNGb3Jbc3VwcG9ydGVkSW50ZW50XTtcblx0XHRcdFx0XHRjb25zdCBpbmNsdWRlID0gdGhpcy5hcHBJbnRlbnRDb250YWlucyhhcHBJbnRlbnQsIGNvbnRleHRUeXBlLCByZXN1bHRUeXBlKTtcblx0XHRcdFx0XHRpZiAoaW5jbHVkZSkge1xuXHRcdFx0XHRcdFx0dGhpcy51cGRhdGVBcHBJbnRlbnRzTWFwKGludGVudHMsIHN1cHBvcnRlZEludGVudCwgYXBwSW50ZW50LmRpc3BsYXlOYW1lLCBhcHApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBPYmplY3QudmFsdWVzKGludGVudHMpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIHRvIHNlZSBpZiB0aGUgc3VwcGxpZWQgYXBwSW50ZW50IHN1cHBvcnRzIHRoZSBjb250ZXh0IGFuZCByZXN1bHQgdHlwZXMuXG5cdCAqIEBwYXJhbSBhcHBJbnRlbnQgVGhlIGFwcCBpbnRlbnQgdG8gY2hlY2suXG5cdCAqIEBwYXJhbSBjb250ZXh0VHlwZSBUaGUgb3B0aW9uYWwgY29udGV4dCB0eXBlIHRvIGxvb2sgZm9yLlxuXHQgKiBAcGFyYW0gcmVzdWx0VHlwZSBUaGUgb3B0aW9uYWwgcmVzdWx0IHR5cGUgdG8gbG9vayBmb3IuXG5cdCAqIEByZXR1cm5zIFRydWUgaWYgdGhlIGFwcCBpbnRlbnQgbWF0Y2hlcy5cblx0ICovXG5cdHByaXZhdGUgYXBwSW50ZW50Q29udGFpbnMoXG5cdFx0YXBwSW50ZW50OiBBcHBJbnRlbnRzLFxuXHRcdGNvbnRleHRUeXBlOiBzdHJpbmcgfCB1bmRlZmluZWQsXG5cdFx0cmVzdWx0VHlwZTogc3RyaW5nIHwgdW5kZWZpbmVkXG5cdCk6IGJvb2xlYW4ge1xuXHRcdGlmICghaXNFbXB0eShjb250ZXh0VHlwZSkgJiYgIWlzRW1wdHkocmVzdWx0VHlwZSkpIHtcblx0XHRcdGlmICghYXBwSW50ZW50Py5jb250ZXh0cz8uaW5jbHVkZXMoY29udGV4dFR5cGUpIHx8ICFhcHBJbnRlbnQucmVzdWx0VHlwZT8uaW5jbHVkZXMocmVzdWx0VHlwZSkpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoIWlzRW1wdHkoY29udGV4dFR5cGUpICYmICFhcHBJbnRlbnQ/LmNvbnRleHRzPy5pbmNsdWRlcyhjb250ZXh0VHlwZSkpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9IGVsc2UgaWYgKCFpc0VtcHR5KHJlc3VsdFR5cGUpICYmICFhcHBJbnRlbnQ/LnJlc3VsdFR5cGU/LmluY2x1ZGVzKHJlc3VsdFR5cGUpKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSB0aGUgbWFwIGNvbnRhaW5pbmcgdGhlIGludGVudCB0byBhcHBzLlxuXHQgKiBAcGFyYW0gaW50ZW50c01hcCBUaGUgbWFwIHRvIHVwZGF0ZS5cblx0ICogQHBhcmFtIG5hbWUgVGhlIG5hbWUgb2YgdGhlIGludGVudC5cblx0ICogQHBhcmFtIGRpc3BsYXlOYW1lIFRoZSBPcHRpb25zIGRpc3BsYXkgbmFtZSB0byB1cGRhdGUgd2l0aC5cblx0ICogQHBhcmFtIGFwcCBUaGUgYXBwbGljYXRpb24gdG8gdXBkYXRlLlxuXHQgKi9cblx0cHJpdmF0ZSB1cGRhdGVBcHBJbnRlbnRzTWFwKFxuXHRcdGludGVudHNNYXA6IHtcblx0XHRcdFtrZXk6IHN0cmluZ106IEFwcHNGb3JJbnRlbnQ7XG5cdFx0fSxcblx0XHRuYW1lOiBzdHJpbmcsXG5cdFx0ZGlzcGxheU5hbWU6IHN0cmluZyB8IHVuZGVmaW5lZCxcblx0XHRhcHA6IFBsYXRmb3JtQXBwXG5cdCk6IHZvaWQge1xuXHRcdGlmIChpc0VtcHR5KGludGVudHNNYXBbbmFtZV0pKSB7XG5cdFx0XHQvLyBpbiBhIHByb2R1Y3Rpb24gYXBwIHlvdSB3b3VsZCBlaXRoZXIgbmVlZCB0byBlbnN1cmUgdGhhdCBldmVyeSBhcHAgd2FzIHBvcHVsYXRlZCB3aXRoIHRoZSBzYW1lIG5hbWUgJiBkaXNwbGF5TmFtZSBmb3IgYW4gaW50ZW50IGZyb20gYSBnb2xkZW4gc291cmNlIChlLmcuIGludGVudHMgdGFibGUpIHNvIHBpY2tpbmcgdGhlIGZpcnN0IGVudHJ5IHdvdWxkbid0IG1ha2UgYSBkaWZmZXJlbmNlLlxuXHRcdFx0Ly8gb3IgeW91IGNvdWxkIHB1bGwgaW4gYSBnb2xkZW4gc291cmNlIG9mIGludGVudHMgZnJvbSBhIHNlcnZpY2UgYW5kIHRoZW4gZG8gYSBsb29rdXAgdXNpbmcgdGhlIGludGVudCBuYW1lIHRvIGdldCBhbiBvYmplY3Qgd2l0aCBpbnRlbnQgbmFtZSBhbmQgb2ZmaWNpYWwgZGlzcGxheSBuYW1lLlxuXHRcdFx0aW50ZW50c01hcFtuYW1lXSA9IHtcblx0XHRcdFx0aW50ZW50OiB7XG5cdFx0XHRcdFx0bmFtZSxcblx0XHRcdFx0XHRkaXNwbGF5TmFtZVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRhcHBzOiBbXVxuXHRcdFx0fTtcblx0XHR9XG5cdFx0aW50ZW50c01hcFtuYW1lXS5hcHBzLnB1c2goYXBwKTtcblx0fVxufVxuIiwiaW1wb3J0IHR5cGUgeyBBcHBJZGVudGlmaWVyIH0gZnJvbSBcIkBmaW5vcy9mZGMzXCI7XG5pbXBvcnQgdHlwZSBPcGVuRmluIGZyb20gXCJAb3BlbmZpbi9jb3JlXCI7XG5pbXBvcnQge1xuXHRPUEVOX0VSUk9SIGFzIE9wZW5FcnJvcixcblx0UkVTT0xWRV9FUlJPUiBhcyBSZXNvbHZlRXJyb3Jcbn0gZnJvbSBcIndvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyL2ZkYzMvZXJyb3JzXCI7XG5pbXBvcnQgdHlwZSB7XG5cdEludGVudFJlZ2lzdHJhdGlvbkVudHJ5LFxuXHRDb250ZXh0UmVnaXN0cmF0aW9uRW50cnksXG5cdEJyb2tlckNsaWVudENvbm5lY3Rpb24sXG5cdEludGVudFJlZ2lzdHJhdGlvblBheWxvYWQsXG5cdENhcHR1cmVBcGlQYXlsb2FkLFxuXHRBcGlNZXRhZGF0YVxufSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvc2hhcGVzL2ludGVyb3Bicm9rZXItc2hhcGVzXCI7XG5pbXBvcnQgdHlwZSB7IExvZ2dlciB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci9zaGFwZXMvbG9nZ2VyLXNoYXBlc1wiO1xuaW1wb3J0IHsgaXNFbXB0eSwgaXNTdHJpbmdWYWx1ZSB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci91dGlsc1wiO1xuXG4vKipcbiAqIFVzZWQgdG8gdHJhY2sgY2xpZW50IGludGVyYWN0aW9ucyB3aXRoIGEgYnJva2VyLlxuICovXG5leHBvcnQgY2xhc3MgQ2xpZW50UmVnaXN0cmF0aW9uSGVscGVyIHtcblx0cHJpdmF0ZSByZWFkb25seSBfbG9nZ2VyOiBMb2dnZXI7XG5cblx0cHJpdmF0ZSByZWFkb25seSBfbG9va3VwQXBwSWQ6IChjbGllbnRJZGVudGl0eTogT3BlbkZpbi5DbGllbnRJZGVudGl0eSkgPT4gUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+O1xuXG5cdHByaXZhdGUgcmVhZG9ubHkgX2NsaWVudFJlYWR5UmVxdWVzdHM6IHsgW2tleTogc3RyaW5nXTogKGluc3RhbmNlSWQ6IHN0cmluZykgPT4gdm9pZCB9O1xuXG5cdHByaXZhdGUgcmVhZG9ubHkgX3RyYWNrZWRDbGllbnRDb25uZWN0aW9uczogeyBba2V5OiBzdHJpbmddOiBCcm9rZXJDbGllbnRDb25uZWN0aW9uIH07XG5cblx0cHJpdmF0ZSByZWFkb25seSBfdHJhY2tlZENvbnRleHRIYW5kbGVyczogeyBba2V5OiBzdHJpbmddOiBDb250ZXh0UmVnaXN0cmF0aW9uRW50cnlbXSB9O1xuXG5cdHByaXZhdGUgcmVhZG9ubHkgX3RyYWNrZWRJbnRlbnRIYW5kbGVyczogeyBba2V5OiBzdHJpbmddOiBJbnRlbnRSZWdpc3RyYXRpb25FbnRyeVtdIH07XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiB0aGUgQ2xpZW50IFJlZ2lzdHJhdGlvbiBIZWxwZXIuXG5cdCAqIEBwYXJhbSBsb29rdXBBcHBJZCBkZXRlcm1pbmUgYXBwSWQgYmFzZWQgb24gY2xpZW50SWRlbnRpdHlcblx0ICogQHBhcmFtIGxvZ2dlciB0aGUgbG9nZ2VyIHRvIHVzZS5cblx0ICovXG5cdGNvbnN0cnVjdG9yKFxuXHRcdGxvb2t1cEFwcElkOiAoY2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHkpID0+IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPixcblx0XHRsb2dnZXI6IExvZ2dlclxuXHQpIHtcblx0XHR0aGlzLl9sb2dnZXIgPSBsb2dnZXI7XG5cdFx0dGhpcy5fbG9va3VwQXBwSWQgPSBsb29rdXBBcHBJZDtcblx0XHR0aGlzLl9jbGllbnRSZWFkeVJlcXVlc3RzID0ge307XG5cdFx0dGhpcy5fdHJhY2tlZENsaWVudENvbm5lY3Rpb25zID0ge307XG5cdFx0dGhpcy5fdHJhY2tlZENvbnRleHRIYW5kbGVycyA9IHt9O1xuXHRcdHRoaXMuX3RyYWNrZWRJbnRlbnRIYW5kbGVycyA9IHt9O1xuXHR9XG5cblx0LyoqXG5cdCAqIFRoZSBjbGllbnQgaGFzIGRpc2Nvbm5lY3RlZCBmb3JtIHRoZSBicm9rZXIuXG5cdCAqIEBwYXJhbSBjbGllbnRJZGVudGl0eSBUaGUgaWRlbnRpdHkgb2YgdGhlIGNsaWVudCB0aGF0IGRpc2Nvbm5lY3RlZC5cblx0ICovXG5cdHB1YmxpYyBhc3luYyBjbGllbnREaXNjb25uZWN0ZWQoY2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHkpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHR0aGlzLl9sb2dnZXIuaW5mbyhcIkNsaWVudCBEaXNjb25uZWN0ZWQuXCIsIGNsaWVudElkZW50aXR5KTtcblxuXHRcdGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuX3RyYWNrZWRJbnRlbnRIYW5kbGVycykpIHtcblx0XHRcdHRoaXMuX3RyYWNrZWRJbnRlbnRIYW5kbGVyc1trZXldID0gdmFsdWUuZmlsdGVyKFxuXHRcdFx0XHQoZW50cnkpID0+IGVudHJ5LmNsaWVudElkZW50aXR5LmVuZHBvaW50SWQgIT09IGNsaWVudElkZW50aXR5LmVuZHBvaW50SWRcblx0XHRcdCk7XG5cdFx0fVxuXG5cdFx0Zm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModGhpcy5fdHJhY2tlZENvbnRleHRIYW5kbGVycykpIHtcblx0XHRcdHRoaXMuX3RyYWNrZWRDb250ZXh0SGFuZGxlcnNba2V5XSA9IHZhbHVlLmZpbHRlcihcblx0XHRcdFx0KGVudHJ5KSA9PiBlbnRyeS5jbGllbnRJZGVudGl0eS5lbmRwb2ludElkICE9PSBjbGllbnRJZGVudGl0eS5lbmRwb2ludElkXG5cdFx0XHQpO1xuXHRcdH1cblx0XHR0aGlzLnJlbW92ZVRyYWNrZWRDbGllbnRDb25uZWN0aW9uKGNsaWVudElkZW50aXR5KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgYW4gaW50ZW50IGhhbmRsZXIgYmVpbmcgcmVnaXN0ZXJlZC5cblx0ICogQHBhcmFtIHBheWxvYWQgVGhlIHBheWxvYWQuXG5cdCAqIEBwYXJhbSBjbGllbnRJZGVudGl0eSBUaGUgY2xpZW50IGlkZW50aXR5LlxuXHQgKiBAcmV0dXJucyBOb3RoaW5nLlxuXHQgKi9cblx0cHVibGljIGFzeW5jIGludGVudEhhbmRsZXJSZWdpc3RlcmVkKFxuXHRcdHBheWxvYWQ6IEludGVudFJlZ2lzdHJhdGlvblBheWxvYWQsXG5cdFx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHlcblx0KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dGhpcy5fbG9nZ2VyLmluZm8oXCJpbnRlbnRIYW5kbGVyUmVnaXN0ZXJlZDpcIiwgcGF5bG9hZCwgY2xpZW50SWRlbnRpdHkpO1xuXHRcdGlmICghaXNFbXB0eShwYXlsb2FkKSkge1xuXHRcdFx0Y29uc3QgaW50ZW50TmFtZTogc3RyaW5nID0gcGF5bG9hZC5oYW5kbGVySWQucmVwbGFjZShcImludGVudC1oYW5kbGVyLVwiLCBcIlwiKTtcblxuXHRcdFx0bGV0IHRyYWNrZWRJbnRlbnRIYW5kbGVyID0gdGhpcy5fdHJhY2tlZEludGVudEhhbmRsZXJzW2ludGVudE5hbWVdO1xuXG5cdFx0XHRpZiAoaXNFbXB0eSh0cmFja2VkSW50ZW50SGFuZGxlcikpIHtcblx0XHRcdFx0dHJhY2tlZEludGVudEhhbmRsZXIgPSBbXTtcblx0XHRcdFx0dGhpcy5fdHJhY2tlZEludGVudEhhbmRsZXJzW2ludGVudE5hbWVdID0gdHJhY2tlZEludGVudEhhbmRsZXI7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHRyYWNrZWRIYW5kbGVyID0gdGhpcy5fdHJhY2tlZEludGVudEhhbmRsZXJzW2ludGVudE5hbWVdLmZpbmQoXG5cdFx0XHRcdChlbnRyeSkgPT4gZW50cnkuY2xpZW50SWRlbnRpdHkuZW5kcG9pbnRJZCA9PT0gY2xpZW50SWRlbnRpdHkuZW5kcG9pbnRJZFxuXHRcdFx0KTtcblxuXHRcdFx0aWYgKGlzRW1wdHkodHJhY2tlZEhhbmRsZXIpKSB7XG5cdFx0XHRcdHRoaXMuX2xvZ2dlci5pbmZvKFxuXHRcdFx0XHRcdGBpbnRlbnRIYW5kbGVyIGVuZHBvaW50IG5vdCByZWdpc3RlcmVkLiBSZWdpc3RlcmluZyAke2NsaWVudElkZW50aXR5LmVuZHBvaW50SWR9IGFnYWluc3QgaW50ZW50ICR7aW50ZW50TmFtZX0gYW5kIGxvb2tpbmcgdXAgYXBwIG5hbWUuYFxuXHRcdFx0XHQpO1xuXHRcdFx0XHRjb25zdCBhcHBJZCA9IGF3YWl0IHRoaXMuX2xvb2t1cEFwcElkKGNsaWVudElkZW50aXR5KTtcblxuXHRcdFx0XHRpZiAoaXNFbXB0eShhcHBJZCkpIHtcblx0XHRcdFx0XHR0aGlzLl9sb2dnZXIud2Fybihcblx0XHRcdFx0XHRcdFwiVW5hYmxlIHRvIGRldGVybWluZSBhcHAgaWQgYmFzZWQgb24gbmFtZS4gVGhpcyBhcHAgd2lsbCBub3QgYmUgdHJhY2tlZCB2aWEgaW50ZW50IGhhbmRsZXIgcmVnaXN0cmF0aW9uLlwiXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5fdHJhY2tlZEludGVudEhhbmRsZXJzW2ludGVudE5hbWVdLnB1c2goe1xuXHRcdFx0XHRcdGZkYzNWZXJzaW9uOiBwYXlsb2FkLmZkYzNWZXJzaW9uLFxuXHRcdFx0XHRcdGNsaWVudElkZW50aXR5LFxuXHRcdFx0XHRcdGFwcElkXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHR0aGlzLl9sb2dnZXIuaW5mbyhcblx0XHRcdFx0XHRgaW50ZW50SGFuZGxlciBlbmRwb2ludDogJHtjbGllbnRJZGVudGl0eS5lbmRwb2ludElkfSByZWdpc3RlcmVkIGFnYWluc3QgaW50ZW50OiAke2ludGVudE5hbWV9IGFuZCBhcHAgSWQ6ICR7YXBwSWR9LmBcblx0XHRcdFx0KTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgY2xpZW50UmVhZHlLZXkgPSB0aGlzLmdldENsaWVudFJlYWR5S2V5KGNsaWVudElkZW50aXR5LCBcImludGVudFwiLCBpbnRlbnROYW1lKTtcblx0XHRcdGlmICghaXNFbXB0eSh0aGlzLl9jbGllbnRSZWFkeVJlcXVlc3RzW2NsaWVudFJlYWR5S2V5XSkpIHtcblx0XHRcdFx0dGhpcy5fbG9nZ2VyLmluZm8oXCJSZXNvbHZpbmcgY2xpZW50IHJlYWR5IHJlcXVlc3QuXCIpO1xuXHRcdFx0XHR0aGlzLl9jbGllbnRSZWFkeVJlcXVlc3RzW2NsaWVudFJlYWR5S2V5XShjbGllbnRJZGVudGl0eS5lbmRwb2ludElkKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQSBjb250ZXh0IGhhbmRsZXIgaGFzIGJlZW4gcmVnaXN0ZXJlZCBhZ2FpbnN0IHRoZSBicm9rZXIuXG5cdCAqIEBwYXJhbSBwYXlsb2FkIFRoZSBwYXlsb2FkIGZyb20gYSBjb250ZXh0IGxpc3RlbmVyIHJlZ2lzdHJhdGlvbi5cblx0ICogQHBhcmFtIHBheWxvYWQuY29udGV4dFR5cGUgVGhlIGNvbnRleHQgdHlwZSB0aGF0IHRoZSBjbGllbnQgaXMgbGlzdGVuaW5nIGZvci5cblx0ICogQHBhcmFtIHBheWxvYWQuaGFuZGxlcklkIFRoZSBoYW5kbGVyIElkIGZvciB0aGlzIGxpc3RlbmVyLlxuXHQgKiBAcGFyYW0gY2xpZW50SWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIHRoZSBhcHBsaWNhdGlvbiB0aGF0IGlzIGFkZGluZyB0aGUgY29udGV4dCBoYW5kbGVyLlxuXHQgKi9cblx0cHVibGljIGFzeW5jIGNvbnRleHRIYW5kbGVyUmVnaXN0ZXJlZChcblx0XHRwYXlsb2FkOiB7IGNvbnRleHRUeXBlOiBzdHJpbmcgfCB1bmRlZmluZWQ7IGhhbmRsZXJJZDogc3RyaW5nIH0sXG5cdFx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHlcblx0KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dGhpcy5fbG9nZ2VyLmluZm8oXCJjb250ZXh0SGFuZGxlclJlZ2lzdGVyZWQ6XCIsIHBheWxvYWQsIGNsaWVudElkZW50aXR5KTtcblx0XHRpZiAoIWlzRW1wdHkocGF5bG9hZD8uaGFuZGxlcklkKSkge1xuXHRcdFx0Y29uc3QgY29udGV4dFR5cGVOYW1lOiBzdHJpbmcgPSBwYXlsb2FkPy5jb250ZXh0VHlwZSA/PyBcIipcIjtcblx0XHRcdGNvbnN0IGhhbmRsZXJJZCA9IHBheWxvYWQuaGFuZGxlcklkO1xuXHRcdFx0bGV0IHRyYWNrZWRDb250ZXh0SGFuZGxlciA9IHRoaXMuX3RyYWNrZWRDb250ZXh0SGFuZGxlcnNbY29udGV4dFR5cGVOYW1lXTtcblxuXHRcdFx0aWYgKGlzRW1wdHkodHJhY2tlZENvbnRleHRIYW5kbGVyKSkge1xuXHRcdFx0XHR0cmFja2VkQ29udGV4dEhhbmRsZXIgPSBbXTtcblx0XHRcdFx0dGhpcy5fdHJhY2tlZENvbnRleHRIYW5kbGVyc1tjb250ZXh0VHlwZU5hbWVdID0gdHJhY2tlZENvbnRleHRIYW5kbGVyO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCB0cmFja2VkSGFuZGxlciA9IHRoaXMuX3RyYWNrZWRDb250ZXh0SGFuZGxlcnNbY29udGV4dFR5cGVOYW1lXS5maW5kKFxuXHRcdFx0XHQoZW50cnkpID0+IGVudHJ5LmNsaWVudElkZW50aXR5LmVuZHBvaW50SWQgPT09IGNsaWVudElkZW50aXR5LmVuZHBvaW50SWRcblx0XHRcdCk7XG5cblx0XHRcdGlmIChpc0VtcHR5KHRyYWNrZWRIYW5kbGVyKSkge1xuXHRcdFx0XHR0aGlzLl9sb2dnZXIuaW5mbyhcblx0XHRcdFx0XHRgY29udGV4dEhhbmRsZXIgZW5kcG9pbnQgbm90IHJlZ2lzdGVyZWQuIFJlZ2lzdGVyaW5nICR7Y2xpZW50SWRlbnRpdHkuZW5kcG9pbnRJZH0gYWdhaW5zdCBjb250ZXh0IGhhbmRsZXIgZm9yIGNvbnRleHQgdHlwZSAke2NvbnRleHRUeXBlTmFtZX0gYW5kIGxvb2tpbmcgdXAgYXBwIG5hbWUuYFxuXHRcdFx0XHQpO1xuXHRcdFx0XHRjb25zdCBhcHBJZCA9IGF3YWl0IHRoaXMuX2xvb2t1cEFwcElkKGNsaWVudElkZW50aXR5KTtcblxuXHRcdFx0XHRpZiAoaXNFbXB0eShhcHBJZCkpIHtcblx0XHRcdFx0XHR0aGlzLl9sb2dnZXIud2Fybihcblx0XHRcdFx0XHRcdFwiVW5hYmxlIHRvIGRldGVybWluZSBhcHAgaWQgYmFzZWQgb24gbmFtZS4gVGhpcyBhcHAgd2lsbCBub3QgYmUgdHJhY2tlZCB2aWEgY29udGV4dCBoYW5kbGVyIHJlZ2lzdHJhdGlvbi5cIlxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuX3RyYWNrZWRDb250ZXh0SGFuZGxlcnNbY29udGV4dFR5cGVOYW1lXS5wdXNoKHtcblx0XHRcdFx0XHRjbGllbnRJZGVudGl0eSxcblx0XHRcdFx0XHRhcHBJZCxcblx0XHRcdFx0XHRoYW5kbGVySWRcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHRoaXMuX2xvZ2dlci5pbmZvKFxuXHRcdFx0XHRcdGBjb250ZXh0SGFuZGxlciBlbmRwb2ludDogJHtjbGllbnRJZGVudGl0eS5lbmRwb2ludElkfSByZWdpc3RlcmVkIGFnYWluc3QgY29udGV4dCB0eXBlOiAke2NvbnRleHRUeXBlTmFtZX0gYW5kIGFwcCBJZDogJHthcHBJZH0uYFxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBjbGllbnRSZWFkeUtleSA9IHRoaXMuZ2V0Q2xpZW50UmVhZHlLZXkoY2xpZW50SWRlbnRpdHksIFwiY29udGV4dFwiLCBjb250ZXh0VHlwZU5hbWUpO1xuXHRcdFx0aWYgKCFpc0VtcHR5KHRoaXMuX2NsaWVudFJlYWR5UmVxdWVzdHNbY2xpZW50UmVhZHlLZXldKSkge1xuXHRcdFx0XHR0aGlzLl9sb2dnZXIuaW5mbyhcIlJlc29sdmluZyBjbGllbnQgcmVhZHkgcmVxdWVzdC5cIik7XG5cdFx0XHRcdHRoaXMuX2NsaWVudFJlYWR5UmVxdWVzdHNbY2xpZW50UmVhZHlLZXldKGNsaWVudElkZW50aXR5LmVuZHBvaW50SWQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDYXB0dXJlIHRoZSBjb25uZWN0aW9uIGFuZCBBUEkgdmVyc2lvbi5cblx0ICogQHBhcmFtIGlkIFRoZSBjbGllbnQgaWRlbnRpdHkgdG8gY2FwdHVyZSBmcm9tLlxuXHQgKiBAcGFyYW0gcGF5bG9hZCBUaGUgcGF5bG9hZC5cblx0ICovXG5cdHB1YmxpYyBhc3luYyBjbGllbnRDb25uZWN0aW9uUmVnaXN0ZXJlZChcblx0XHRpZDogT3BlbkZpbi5DbGllbnRJZGVudGl0eSAmIHsgY29ubmVjdGlvblVybD86IHN0cmluZzsgZW50aXR5VHlwZT86IHN0cmluZyB9LFxuXHRcdHBheWxvYWQ/OiBDYXB0dXJlQXBpUGF5bG9hZFxuXHQpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBrZXkgPSBgJHtpZC51dWlkfS0ke2lkLm5hbWV9YDtcblx0XHRsZXQgYXBpVmVyc2lvbjogQXBpTWV0YWRhdGEgfCB1bmRlZmluZWQ7XG5cdFx0aWYgKGlzRW1wdHkodGhpcy5fdHJhY2tlZENsaWVudENvbm5lY3Rpb25zW2tleV0pKSB7XG5cdFx0XHRpZiAoaWQudXVpZCAhPT0gZmluLm1lLmlkZW50aXR5LnV1aWQpIHtcblx0XHRcdFx0Y29uc3QgcGF5bG9hZEFwaVZlcnNpb24gPSBwYXlsb2FkPy5hcGlWZXJzaW9uO1xuXHRcdFx0XHRpZiAoIWlzRW1wdHkocGF5bG9hZEFwaVZlcnNpb24pICYmICFpc0VtcHR5KHBheWxvYWRBcGlWZXJzaW9uPy50eXBlKSkge1xuXHRcdFx0XHRcdGFwaVZlcnNpb24gPSBwYXlsb2FkQXBpVmVyc2lvbjtcblx0XHRcdFx0fSBlbHNlIGlmIChpc1N0cmluZ1ZhbHVlKGlkLmNvbm5lY3Rpb25VcmwpKSB7XG5cdFx0XHRcdFx0Ly8gaWYgdGhleSBoYXZlbid0IHNwZWNpZmllZCBhcGlWZXJzaW9uIG1ldGEgZGF0YSBhbmQgaXQgaXMgZXh0ZXJuYWwgYW5kIGhhcyBhIHVybCB0aGVuIHdlIHdpbGwgYXNzdW1lIGZkYzMgMi4wXG5cdFx0XHRcdFx0YXBpVmVyc2lvbiA9IHsgdHlwZTogXCJmZGMzXCIsIHZlcnNpb246IFwiMi4wXCIgfTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBpZiBhIG5hdGl2ZSBhcHAgaGFzIHNwZWNpZmllZCBhIHByZWZlcmVuY2UgdGhyb3VnaCBhcGlWZXJzaW9uIHRoZW4gd2UgYXNzdW1lIGludGVyb3Bcblx0XHRcdFx0XHRhcGlWZXJzaW9uID0geyB0eXBlOiBcImludGVyb3BcIiB9O1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zdCBlbnRpdHlUeXBlID0gaWQuZW50aXR5VHlwZTtcblx0XHRcdFx0aWYgKCFpc0VtcHR5KGVudGl0eVR5cGUpKSB7XG5cdFx0XHRcdFx0c3dpdGNoIChlbnRpdHlUeXBlKSB7XG5cdFx0XHRcdFx0XHRjYXNlIFwid2luZG93XCI6IHtcblx0XHRcdFx0XHRcdFx0YXBpVmVyc2lvbiA9IGF3YWl0IHRoaXMuY2FwdHVyZVdpbmRvd0FwaVVzYWdlKGlkKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRjYXNlIFwidmlld1wiOiB7XG5cdFx0XHRcdFx0XHRcdGFwaVZlcnNpb24gPSBhd2FpdCB0aGlzLmNhcHR1cmVWaWV3QXBpVXNhZ2UoaWQpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGRlZmF1bHQ6IHtcblx0XHRcdFx0XHRcdFx0dGhpcy5fbG9nZ2VyLndhcm4oXG5cdFx0XHRcdFx0XHRcdFx0YFdlIGN1cnJlbnRseSBkbyBub3QgY2hlY2sgZm9yIGVudGl0eSB0eXBlcyB0aGF0IGFyZSBub3Qgdmlld3Mgb3Igd2luZG93cy4gRW50aXR5IHR5cGU6ICR7ZW50aXR5VHlwZX1gXG5cdFx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGFwaVZlcnNpb24gPSBhd2FpdCB0aGlzLmNhcHR1cmVWaWV3QXBpVXNhZ2UoaWQpO1xuXHRcdFx0XHRcdGlmIChpc0VtcHR5KGFwaVZlcnNpb24pKSB7XG5cdFx0XHRcdFx0XHQvLyBwZXJoYXBzIGl0IGlzIGEgd2luZG93XG5cdFx0XHRcdFx0XHRhcGlWZXJzaW9uID0gYXdhaXQgdGhpcy5jYXB0dXJlV2luZG93QXBpVXNhZ2UoaWQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y29uc3QgYnJva2VyQ2xpZW50Q29ubmVjdGlvbjogQnJva2VyQ2xpZW50Q29ubmVjdGlvbiA9IHtcblx0XHRcdFx0Y2xpZW50SWRlbnRpdHk6IGlkLFxuXHRcdFx0XHRhcGlNZXRhZGF0YTogYXBpVmVyc2lvblxuXHRcdFx0fTtcblxuXHRcdFx0dGhpcy5fdHJhY2tlZENsaWVudENvbm5lY3Rpb25zW2tleV0gPSBicm9rZXJDbGllbnRDb25uZWN0aW9uO1xuXHRcdFx0Y29uc3QgY2xpZW50UmVhZHlLZXkgPSB0aGlzLmdldENsaWVudFJlYWR5S2V5KGlkLCBcImNvbm5lY3Rpb25cIik7XG5cdFx0XHRpZiAoIWlzRW1wdHkodGhpcy5fY2xpZW50UmVhZHlSZXF1ZXN0c1tjbGllbnRSZWFkeUtleV0pKSB7XG5cdFx0XHRcdHRoaXMuX2xvZ2dlci5pbmZvKFwiUmVzb2x2aW5nIGNsaWVudCByZWFkeSByZXF1ZXN0LlwiKTtcblx0XHRcdFx0dGhpcy5fY2xpZW50UmVhZHlSZXF1ZXN0c1tjbGllbnRSZWFkeUtleV0oaWQuZW5kcG9pbnRJZCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhIGNvbnRleHQgaGFuZGxlciB0aGF0IG1hdGNoZXMgdGhlIGNvbnRleHQgdHlwZSBuYW1lIGFuZCBpbnN0YW5jZSBpZC5cblx0ICogQHBhcmFtIGNvbnRleHRUeXBlTmFtZSB0aGUgbmFtZSBvZiB0aGUgY29udGV4dCB0aGUgbGlzdGVuZXIgaXMgcmVnaXN0ZXJlZCBmb3IuXG5cdCAqIEBwYXJhbSBpbnN0YW5jZUlkIHRoZSBpbnN0YW5jZUlkIHlvdSB3aXNoIHRvIGNoZWNrIGZvci5cblx0ICogQHJldHVybnMgVGhlIENvbnRleHRSZWdpc3RyYXRpb25FbnRyeSBvciB1bmRlZmluZWQuXG5cdCAqL1xuXHRwdWJsaWMgZ2V0UmVnaXN0ZXJlZENvbnRleHRIYW5kbGVyKFxuXHRcdGNvbnRleHRUeXBlTmFtZTogc3RyaW5nLFxuXHRcdGluc3RhbmNlSWQ6IHN0cmluZ1xuXHQpOiBDb250ZXh0UmVnaXN0cmF0aW9uRW50cnkgfCB1bmRlZmluZWQge1xuXHRcdGNvbnN0IHRyYWNrZWRIYW5kbGVyID0gdGhpcy5fdHJhY2tlZENvbnRleHRIYW5kbGVyc1tjb250ZXh0VHlwZU5hbWVdPy5maW5kKFxuXHRcdFx0KGVudHJ5KSA9PiBlbnRyeS5jbGllbnRJZGVudGl0eS5lbmRwb2ludElkID09PSBpbnN0YW5jZUlkXG5cdFx0KTtcblx0XHRyZXR1cm4gdHJhY2tlZEhhbmRsZXI7XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIEZEQzMgZmluZCBpbnN0YW5jZXMgZm9yIGFwcCBpbnN0YW5jZXMgdGhhdCBoYXZlIHJlZ2lzdGVyZWQgZm9yIGFuIGludGVudC5cblx0ICogQHBhcmFtIGFwcCBUaGUgYXBwIGlkZW50aWZpZXIgdG8gZmluZC5cblx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgaWRlbnRpdHkuXG5cdCAqIEBwYXJhbSB0eXBlIHRoZSB0eXBlIG9mIGFwcCBpbnN0YW5jZXMgeW91IGFyZSBhZnRlci4gQ09OTkVDVEVEID0gYW55dGhpbmcgdGhhdCBoYXMgY29ubmVjdGVkIHRvIHRoZSBicm9rZXIgYW5kIElOVEVOVCBtZWFucyBhbiBBUFAgdGhhdCBoYXMgcmVnaXN0ZXJlZCBhbiBJbnRlbnQgSGFuZGxlci5cblx0ICogQHJldHVybnMgVGhlIGluc3RhbmNlIG9mIHRoZSBhcHAuXG5cdCAqL1xuXHRwdWJsaWMgYXN5bmMgZmluZEFwcEluc3RhbmNlcyhcblx0XHRhcHA6IEFwcElkZW50aWZpZXIsXG5cdFx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHksXG5cdFx0dHlwZTogXCJjb25uZWN0ZWRcIiB8IFwiaW50ZW50XCIgPSBcImNvbm5lY3RlZFwiXG5cdCk6IFByb21pc2U8QXBwSWRlbnRpZmllcltdPiB7XG5cdFx0Y29uc3QgZW5kcG9pbnRBcHBzOiB7IFtrZXk6IHN0cmluZ106IEFwcElkZW50aWZpZXIgfSA9IHt9O1xuXG5cdFx0aWYgKHR5cGUgPT09IFwiaW50ZW50XCIpIHtcblx0XHRcdGZvciAoY29uc3QgWywgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuX3RyYWNrZWRJbnRlbnRIYW5kbGVycykpIHtcblx0XHRcdFx0Y29uc3QgZW50cmllcyA9IHZhbHVlLmZpbHRlcigoZW50cnkpID0+IGVudHJ5LmFwcElkID09PSBhcHAuYXBwSWQpO1xuXHRcdFx0XHRmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMpIHtcblx0XHRcdFx0XHRlbmRwb2ludEFwcHNbZW50cnkuY2xpZW50SWRlbnRpdHkuZW5kcG9pbnRJZF0gPSB7XG5cdFx0XHRcdFx0XHRhcHBJZDogZW50cnkuYXBwSWQgPz8gXCJcIixcblx0XHRcdFx0XHRcdGluc3RhbmNlSWQ6IGVudHJ5LmNsaWVudElkZW50aXR5LmVuZHBvaW50SWRcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gT2JqZWN0LnZhbHVlcyhlbmRwb2ludEFwcHMpO1xuXHRcdH1cblxuXHRcdGZvciAoY29uc3QgWywgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuX3RyYWNrZWRDbGllbnRDb25uZWN0aW9ucykpIHtcblx0XHRcdGNvbnN0IHRyYWNrZWRBcHBJZCA9IGF3YWl0IHRoaXMuX2xvb2t1cEFwcElkKHZhbHVlLmNsaWVudElkZW50aXR5KTtcblx0XHRcdGlmICh0cmFja2VkQXBwSWQgPT09IGFwcC5hcHBJZCAmJiBpc0VtcHR5KGVuZHBvaW50QXBwc1t2YWx1ZS5jbGllbnRJZGVudGl0eS5lbmRwb2ludElkXSkpIHtcblx0XHRcdFx0ZW5kcG9pbnRBcHBzW3ZhbHVlLmNsaWVudElkZW50aXR5LmVuZHBvaW50SWRdID0ge1xuXHRcdFx0XHRcdGFwcElkOiBhcHAuYXBwSWQgPz8gXCJcIixcblx0XHRcdFx0XHRpbnN0YW5jZUlkOiB2YWx1ZS5jbGllbnRJZGVudGl0eS5lbmRwb2ludElkXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIE9iamVjdC52YWx1ZXMoZW5kcG9pbnRBcHBzKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgdGhlIGFwaSB2ZXJzaW9uIGZvciB0aGUgaWRlbnRpdHkuXG5cdCAqIEBwYXJhbSBpZCBUaGUgaWRlbnRpdHkgdG8gZ2V0IHRoZSBhcGkgdmVyc2lvbiBmb3IuXG5cdCAqIEByZXR1cm5zIFRoZSBhcGkgbWV0YWRhdGEuXG5cdCAqL1xuXHRwdWJsaWMgZ2V0QXBpVmVyc2lvbihpZDogT3BlbkZpbi5JZGVudGl0eSk6IEFwaU1ldGFkYXRhIHwgdW5kZWZpbmVkIHtcblx0XHRjb25zdCBrZXkgPSBgJHtpZC51dWlkfS0ke2lkLm5hbWV9YDtcblx0XHRjb25zdCBhcGlWZXJzaW9uOiBBcGlNZXRhZGF0YSB8IHVuZGVmaW5lZCA9IHRoaXMuX3RyYWNrZWRDbGllbnRDb25uZWN0aW9uc1trZXldPy5hcGlNZXRhZGF0YTtcblx0XHRyZXR1cm4gYXBpVmVyc2lvbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgY2xpZW50IHJlYWR5IGV2ZW50IGZvciBvcGVuaW5nIGFuZCBhd2FpdGluZyBhIGNvbm5lY3Rpb24gdG8gdGhlIGJyb2tlci5cblx0ICogQHBhcmFtIGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiB0aGUgY2xpZW50LlxuXHQgKiBAcGFyYW0gdGltZW91dCBUaGUgdGltZW91dCB0byB3YWl0IGZvciB0aGUgY2xpZW50LlxuXHQgKiBAcmV0dXJucyBUaGUgaW5zdGFuY2UgaWQuXG5cdCAqL1xuXHRwdWJsaWMgYXN5bmMgb25Db25uZWN0aW9uQ2xpZW50UmVhZHkoaWRlbnRpdHk6IE9wZW5GaW4uSWRlbnRpdHksIHRpbWVvdXQ6IG51bWJlciA9IDE1MDAwKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2U8c3RyaW5nPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRjb25zdCBjbGllbnRJZGVudGl0eSA9IHRoaXMuZ2V0Q2xpZW50SWRlbnRpdHkoaWRlbnRpdHkpO1xuXHRcdFx0aWYgKCFpc0VtcHR5KGNsaWVudElkZW50aXR5KSkge1xuXHRcdFx0XHRyZXNvbHZlKGNsaWVudElkZW50aXR5LmVuZHBvaW50SWQpO1xuXHRcdFx0fVxuXHRcdFx0Y29uc3Qga2V5ID0gdGhpcy5nZXRDbGllbnRSZWFkeUtleShpZGVudGl0eSwgXCJjb25uZWN0aW9uXCIpO1xuXHRcdFx0Y29uc3QgdGltZXJJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRpZiAoIWlzRW1wdHkodGhpcy5fY2xpZW50UmVhZHlSZXF1ZXN0c1trZXldKSkge1xuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLl9jbGllbnRSZWFkeVJlcXVlc3RzW2tleV07XG5cdFx0XHRcdFx0cmVqZWN0KFJlc29sdmVFcnJvci5UYXJnZXRJbnN0YW5jZVVuYXZhaWxhYmxlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgdGltZW91dCk7XG5cdFx0XHR0aGlzLl9jbGllbnRSZWFkeVJlcXVlc3RzW2tleV0gPSAoaW5zdGFuY2VJZDogc3RyaW5nKTogdm9pZCA9PiB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcklkKTtcblx0XHRcdFx0Ly8gY2xlYXIgdGhlIGNhbGxiYWNrIGFzeW5jaHJvbm91c2x5XG5cdFx0XHRcdGRlbGV0ZSB0aGlzLl9jbGllbnRSZWFkeVJlcXVlc3RzW2tleV07XG5cdFx0XHRcdHJlc29sdmUoaW5zdGFuY2VJZCk7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBjbGllbnQgcmVhZHkgZXZlbnQgZm9yIGludGVudCBoYW5kbGluZy5cblx0ICogQHBhcmFtIGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiB0aGUgY2xpZW50LlxuXHQgKiBAcGFyYW0gaW50ZW50TmFtZSBUaGUgaW50ZW50IG5hbWUuXG5cdCAqIEBwYXJhbSB0aW1lb3V0IFRoZSB0aW1lb3V0IHRvIHdhaXQgZm9yIHRoZSBjbGllbnQuXG5cdCAqIEByZXR1cm5zIFRoZSBpbnN0YW5jZSBpZC5cblx0ICovXG5cdHB1YmxpYyBhc3luYyBvbkludGVudENsaWVudFJlYWR5KFxuXHRcdGlkZW50aXR5OiBPcGVuRmluLklkZW50aXR5LFxuXHRcdGludGVudE5hbWU6IHN0cmluZyxcblx0XHR0aW1lb3V0OiBudW1iZXIgPSAxNTAwMFxuXHQpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZTxzdHJpbmc+KChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdGNvbnN0IHJlZ2lzdGVyZWRIYW5kbGVycyA9IHRoaXMuX3RyYWNrZWRJbnRlbnRIYW5kbGVyc1tpbnRlbnROYW1lXTtcblx0XHRcdGxldCBleGlzdGluZ0luc3RhbmNlSWQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcblx0XHRcdGlmICghaXNFbXB0eShyZWdpc3RlcmVkSGFuZGxlcnMpKSB7XG5cdFx0XHRcdGZvciAoY29uc3QgaGFuZGxlciBvZiByZWdpc3RlcmVkSGFuZGxlcnMpIHtcblx0XHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0XHRoYW5kbGVyLmNsaWVudElkZW50aXR5LnV1aWQgPT09IGlkZW50aXR5LnV1aWQgJiZcblx0XHRcdFx0XHRcdGhhbmRsZXIuY2xpZW50SWRlbnRpdHkubmFtZSA9PT0gaWRlbnRpdHkubmFtZVxuXHRcdFx0XHRcdCkge1xuXHRcdFx0XHRcdFx0ZXhpc3RpbmdJbnN0YW5jZUlkID0gaGFuZGxlci5jbGllbnRJZGVudGl0eS5lbmRwb2ludElkO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAoIWlzRW1wdHkoZXhpc3RpbmdJbnN0YW5jZUlkKSkge1xuXHRcdFx0XHRyZXNvbHZlKGV4aXN0aW5nSW5zdGFuY2VJZCk7XG5cdFx0XHR9XG5cdFx0XHRjb25zdCBrZXkgPSB0aGlzLmdldENsaWVudFJlYWR5S2V5KGlkZW50aXR5LCBcImludGVudFwiLCBpbnRlbnROYW1lKTtcblx0XHRcdGNvbnN0IHRpbWVySWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYgKCFpc0VtcHR5KHRoaXMuX2NsaWVudFJlYWR5UmVxdWVzdHNba2V5XSkpIHtcblx0XHRcdFx0XHRkZWxldGUgdGhpcy5fY2xpZW50UmVhZHlSZXF1ZXN0c1trZXldO1xuXHRcdFx0XHRcdHJlamVjdChSZXNvbHZlRXJyb3IuSW50ZW50RGVsaXZlcnlGYWlsZWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCB0aW1lb3V0KTtcblx0XHRcdHRoaXMuX2NsaWVudFJlYWR5UmVxdWVzdHNba2V5XSA9IChpbnN0YW5jZUlkOiBzdHJpbmcpOiB2b2lkID0+IHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRpbWVySWQpO1xuXHRcdFx0XHQvLyBjbGVhciB0aGUgY2FsbGJhY2sgYXN5bmNocm9ub3VzbHlcblx0XHRcdFx0ZGVsZXRlIHRoaXMuX2NsaWVudFJlYWR5UmVxdWVzdHNba2V5XTtcblx0XHRcdFx0cmVzb2x2ZShpbnN0YW5jZUlkKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGNsaWVudCByZWFkeSBldmVudCBmb3IgY29udGV4dCBoYW5kbGluZy5cblx0ICogQHBhcmFtIGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiB0aGUgY2xpZW50LlxuXHQgKiBAcGFyYW0gY29udGV4dFR5cGVOYW1lIFRoZSBjb250ZXh0VHlwZSBuYW1lLlxuXHQgKiBAcGFyYW0gdGltZW91dCBUaGUgdGltZW91dCB0byB3YWl0IGZvciB0aGUgY2xpZW50LlxuXHQgKiBAcmV0dXJucyBUaGUgaW5zdGFuY2UgaWQuXG5cdCAqL1xuXHRwdWJsaWMgYXN5bmMgb25Db250ZXh0Q2xpZW50UmVhZHkoXG5cdFx0aWRlbnRpdHk6IE9wZW5GaW4uSWRlbnRpdHksXG5cdFx0Y29udGV4dFR5cGVOYW1lOiBzdHJpbmcsXG5cdFx0dGltZW91dDogbnVtYmVyID0gMTUwMDBcblx0KTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2U8c3RyaW5nPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRjb25zdCBjb250ZXh0UmVnaXN0ZXJlZEhhbmRsZXJzID0gdGhpcy5fdHJhY2tlZENvbnRleHRIYW5kbGVyc1tjb250ZXh0VHlwZU5hbWVdO1xuXHRcdFx0Y29uc3QgZ2xvYmFsUmVnaXN0ZXJlZEhhbmRsZXJzID0gdGhpcy5fdHJhY2tlZENvbnRleHRIYW5kbGVyc1tcIipcIl07XG5cdFx0XHRsZXQgZXhpc3RpbmdDb250ZXh0SGFuZGxlckluc3RhbmNlSWQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuXHRcdFx0aWYgKCFpc0VtcHR5KGNvbnRleHRSZWdpc3RlcmVkSGFuZGxlcnMpKSB7XG5cdFx0XHRcdGZvciAoY29uc3QgaGFuZGxlciBvZiBjb250ZXh0UmVnaXN0ZXJlZEhhbmRsZXJzKSB7XG5cdFx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdFx0aGFuZGxlci5jbGllbnRJZGVudGl0eS51dWlkID09PSBpZGVudGl0eS51dWlkICYmXG5cdFx0XHRcdFx0XHRoYW5kbGVyLmNsaWVudElkZW50aXR5Lm5hbWUgPT09IGlkZW50aXR5Lm5hbWVcblx0XHRcdFx0XHQpIHtcblx0XHRcdFx0XHRcdGV4aXN0aW5nQ29udGV4dEhhbmRsZXJJbnN0YW5jZUlkID0gaGFuZGxlci5jbGllbnRJZGVudGl0eS5lbmRwb2ludElkO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmICghaXNFbXB0eShnbG9iYWxSZWdpc3RlcmVkSGFuZGxlcnMpICYmIGlzRW1wdHkoZXhpc3RpbmdDb250ZXh0SGFuZGxlckluc3RhbmNlSWQpKSB7XG5cdFx0XHRcdGZvciAoY29uc3QgaGFuZGxlciBvZiBnbG9iYWxSZWdpc3RlcmVkSGFuZGxlcnMpIHtcblx0XHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0XHRoYW5kbGVyLmNsaWVudElkZW50aXR5LnV1aWQgPT09IGlkZW50aXR5LnV1aWQgJiZcblx0XHRcdFx0XHRcdGhhbmRsZXIuY2xpZW50SWRlbnRpdHkubmFtZSA9PT0gaWRlbnRpdHkubmFtZVxuXHRcdFx0XHRcdCkge1xuXHRcdFx0XHRcdFx0ZXhpc3RpbmdDb250ZXh0SGFuZGxlckluc3RhbmNlSWQgPSBoYW5kbGVyLmNsaWVudElkZW50aXR5LmVuZHBvaW50SWQ7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmICghaXNFbXB0eShleGlzdGluZ0NvbnRleHRIYW5kbGVySW5zdGFuY2VJZCkpIHtcblx0XHRcdFx0cmVzb2x2ZShleGlzdGluZ0NvbnRleHRIYW5kbGVySW5zdGFuY2VJZCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgY29udGV4dEtleSA9IHRoaXMuZ2V0Q2xpZW50UmVhZHlLZXkoaWRlbnRpdHksIFwiY29udGV4dFwiLCBjb250ZXh0VHlwZU5hbWUpO1xuXHRcdFx0Y29uc3QgZ2xvYmFsS2V5ID0gdGhpcy5nZXRDbGllbnRSZWFkeUtleShpZGVudGl0eSwgXCJjb250ZXh0XCIsIFwiKlwiKTtcblx0XHRcdGNvbnN0IHRpbWVySWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0Y29uc3QgaGFzQ29udGV4dFJlcXVlc3QgPSAhaXNFbXB0eSh0aGlzLl9jbGllbnRSZWFkeVJlcXVlc3RzW2NvbnRleHRLZXldKTtcblx0XHRcdFx0Y29uc3QgaGFzR2xvYmFsUmVxdWVzdCA9ICFpc0VtcHR5KHRoaXMuX2NsaWVudFJlYWR5UmVxdWVzdHNbZ2xvYmFsS2V5XSk7XG5cblx0XHRcdFx0aWYgKGhhc0NvbnRleHRSZXF1ZXN0IHx8IGhhc0dsb2JhbFJlcXVlc3QpIHtcblx0XHRcdFx0XHRkZWxldGUgdGhpcy5fY2xpZW50UmVhZHlSZXF1ZXN0c1tjb250ZXh0S2V5XTtcblx0XHRcdFx0XHRkZWxldGUgdGhpcy5fY2xpZW50UmVhZHlSZXF1ZXN0c1tnbG9iYWxLZXldO1xuXHRcdFx0XHRcdHJlamVjdChPcGVuRXJyb3IuQXBwVGltZW91dCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIHRpbWVvdXQpO1xuXHRcdFx0bGV0IGlzUmVzb2x2ZWQgPSBmYWxzZTtcblx0XHRcdHRoaXMuX2NsaWVudFJlYWR5UmVxdWVzdHNbY29udGV4dEtleV0gPSAoaW5zdGFuY2VJZDogc3RyaW5nKTogdm9pZCA9PiB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcklkKTtcblx0XHRcdFx0aWYgKCFpc1Jlc29sdmVkKSB7XG5cdFx0XHRcdFx0aXNSZXNvbHZlZCA9IHRydWU7XG5cdFx0XHRcdFx0Ly8gY2xlYXIgdGhlIGNhbGxiYWNrIGFzeW5jaHJvbm91c2x5XG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMuX2NsaWVudFJlYWR5UmVxdWVzdHNbY29udGV4dEtleV07XG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMuX2NsaWVudFJlYWR5UmVxdWVzdHNbZ2xvYmFsS2V5XTtcblx0XHRcdFx0XHRyZXNvbHZlKGluc3RhbmNlSWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5fY2xpZW50UmVhZHlSZXF1ZXN0c1tnbG9iYWxLZXldID0gKGluc3RhbmNlSWQ6IHN0cmluZyk6IHZvaWQgPT4ge1xuXHRcdFx0XHRjbGVhclRpbWVvdXQodGltZXJJZCk7XG5cdFx0XHRcdGlmICghaXNSZXNvbHZlZCkge1xuXHRcdFx0XHRcdGlzUmVzb2x2ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdC8vIGNsZWFyIHRoZSBjYWxsYmFjayBhc3luY2hyb25vdXNseVxuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLl9jbGllbnRSZWFkeVJlcXVlc3RzW2NvbnRleHRLZXldO1xuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLl9jbGllbnRSZWFkeVJlcXVlc3RzW2dsb2JhbEtleV07XG5cdFx0XHRcdFx0cmVzb2x2ZShpbnN0YW5jZUlkKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgdGhlIGNsaWVudCBpZGVudGl0eSBnaXZlbiBhIHN0YW5kYXJkIGlkZW50aXR5LlxuXHQgKiBAcGFyYW0gaWQgVGhlIGlkZW50aXR5IHRvIGdldCB0aGUgY2xpZW50IGlkZW50aXR5IGZvci5cblx0ICogQHJldHVybnMgVGhlIGNsaWVudCBpZGVudGl0eSBpZiBhdmFpbGFibGUuXG5cdCAqL1xuXHRwcml2YXRlIGdldENsaWVudElkZW50aXR5KGlkOiBPcGVuRmluLklkZW50aXR5KTogT3BlbkZpbi5DbGllbnRJZGVudGl0eSB8IHVuZGVmaW5lZCB7XG5cdFx0Y29uc3Qga2V5ID0gYCR7aWQudXVpZH0tJHtpZC5uYW1lfWA7XG5cdFx0Y29uc3QgY2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHkgfCB1bmRlZmluZWQgPVxuXHRcdFx0dGhpcy5fdHJhY2tlZENsaWVudENvbm5lY3Rpb25zW2tleV0/LmNsaWVudElkZW50aXR5O1xuXHRcdHJldHVybiBjbGllbnRJZGVudGl0eTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZW1vdmUgdGhlIHRyYWNraW5nIGZvciB0aGUgaWRlbnRpdHkuXG5cdCAqIEBwYXJhbSBpZCBUaGUgaWRlbnRpdHkgdG8gcmVtb3ZlIHRoZSBjb25uZWN0aW9uIGluZm9ybWF0aW9uIGZvci5cblx0ICovXG5cdHByaXZhdGUgcmVtb3ZlVHJhY2tlZENsaWVudENvbm5lY3Rpb24oaWQ6IE9wZW5GaW4uSWRlbnRpdHkpOiB2b2lkIHtcblx0XHRjb25zdCBrZXkgPSBgJHtpZC51dWlkfS0ke2lkLm5hbWV9YDtcblx0XHRkZWxldGUgdGhpcy5fdHJhY2tlZENsaWVudENvbm5lY3Rpb25zW2tleV07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IHRoZSBmZGMzIHVzYWdlIGZyb20gYSB3aW5kb3cuXG5cdCAqIEBwYXJhbSBpZCBUaGUgaWYgb2YgdGhlIHZpZXcgdG8gZ2V0IHRoZSBpbmZvIGZyb20uXG5cdCAqIEByZXR1cm5zIFRoZSBhcGkgbWV0YWRhdGEuXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGNhcHR1cmVXaW5kb3dBcGlVc2FnZShpZDogT3BlbkZpbi5DbGllbnRJZGVudGl0eSk6IFByb21pc2U8QXBpTWV0YWRhdGEgfCB1bmRlZmluZWQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgdGFyZ2V0ID0gZmluLldpbmRvdy53cmFwU3luYyhpZCk7XG5cdFx0XHRjb25zdCBvcHRpb25zID0gYXdhaXQgdGFyZ2V0LmdldE9wdGlvbnMoKTtcblx0XHRcdGlmICghaXNFbXB0eShvcHRpb25zLmZkYzNJbnRlcm9wQXBpKSkge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHR5cGU6IFwiZmRjM1wiLFxuXHRcdFx0XHRcdHZlcnNpb246IG9wdGlvbnMuZmRjM0ludGVyb3BBcGlcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIHt9XG5cdH1cblxuXHQvKipcblx0ICogR2V0IHRoZSBkYzMgdXNhZ2UgZnJvbSBhIHZpZXcuXG5cdCAqIEBwYXJhbSBpZCBUaGUgaWQgb2YgdGhlIHdpbmRvdyB0byBnZXQgdGhlIGluZm8gZnJvbS5cblx0ICogQHJldHVybnMgVGhlIGFwaSBtZXRhZGF0YS5cblx0ICovXG5cdHByaXZhdGUgYXN5bmMgY2FwdHVyZVZpZXdBcGlVc2FnZShpZDogT3BlbkZpbi5DbGllbnRJZGVudGl0eSk6IFByb21pc2U8QXBpTWV0YWRhdGEgfCB1bmRlZmluZWQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgdGFyZ2V0ID0gZmluLlZpZXcud3JhcFN5bmMoaWQpO1xuXHRcdFx0Y29uc3Qgb3B0aW9ucyA9IGF3YWl0IHRhcmdldC5nZXRPcHRpb25zKCk7XG5cdFx0XHRpZiAoIWlzRW1wdHkob3B0aW9ucy5mZGMzSW50ZXJvcEFwaSkpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHR0eXBlOiBcImZkYzNcIixcblx0XHRcdFx0XHR2ZXJzaW9uOiBvcHRpb25zLmZkYzNJbnRlcm9wQXBpXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCB7fVxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhIGtleSB0aGF0IGNhbiBiZSB1c2VkIGZvciBhbiBpZGVudGl0eSBhbmQgY2xpZW50LlxuXHQgKiBAcGFyYW0gaWRlbnRpdHkgVGhlIGlkZW50aXR5IHRvIHVzZSBpbiB0aGUga2V5LlxuXHQgKiBAcGFyYW0gdHlwZSBUaGUgdHlwZSBvZiByZWFkeSBldmVudCB5b3UgYXJlIGxvb2tpbmcgZm9yXG5cdCAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIG9mIHRoZSB0eXBlIGlmIHJlcXVpcmVkIHRvIHVzZSBpbiB0aGUga2V5XG5cdCAqIEByZXR1cm5zIFRoZSBrZXkuXG5cdCAqL1xuXHRwcml2YXRlIGdldENsaWVudFJlYWR5S2V5KFxuXHRcdGlkZW50aXR5OiBPcGVuRmluLklkZW50aXR5LFxuXHRcdHR5cGU6IFwiY29ubmVjdGlvblwiIHwgXCJjb250ZXh0XCIgfCBcImludGVudFwiLFxuXHRcdG5hbWU/OiBzdHJpbmdcblx0KTogc3RyaW5nIHtcblx0XHRpZiAoaXNFbXB0eShuYW1lKSkge1xuXHRcdFx0cmV0dXJuIGAke2lkZW50aXR5LnV1aWR9LyR7aWRlbnRpdHkubmFtZX0vJHt0eXBlfWA7XG5cdFx0fVxuXHRcdHJldHVybiBgJHtpZGVudGl0eS51dWlkfS8ke2lkZW50aXR5Lm5hbWV9LyR7dHlwZX0vJHtuYW1lfWA7XG5cdH1cbn1cbiIsImltcG9ydCB0eXBlIE9wZW5GaW4gZnJvbSBcIkBvcGVuZmluL2NvcmVcIjtcbmltcG9ydCB0eXBlIHsgQXBwSW50ZW50IH0gZnJvbSBcIkBvcGVuZmluL3dvcmtzcGFjZS1wbGF0Zm9ybVwiO1xuaW1wb3J0IHsgUkVTT0xWRV9FUlJPUiBhcyBSZXNvbHZlRXJyb3IgfSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvZmRjMy9lcnJvcnNcIjtcbmltcG9ydCB0eXBlIHsgUGxhdGZvcm1BcHAgfSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvc2hhcGVzL2FwcC1zaGFwZXNcIjtcbmltcG9ydCB0eXBlIHtcblx0SW50ZW50UmVzb2x2ZXJSZXNwb25zZSxcblx0SW50ZW50UmVzb2x2ZXJPcHRpb25zXG59IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci9zaGFwZXMvaW50ZXJvcGJyb2tlci1zaGFwZXNcIjtcbmltcG9ydCB0eXBlIHsgTG9nZ2VyIH0gZnJvbSBcIndvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyL3NoYXBlcy9sb2dnZXItc2hhcGVzXCI7XG5pbXBvcnQgeyBmb3JtYXRFcnJvciwgaXNFbXB0eSB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci91dGlsc1wiO1xuaW1wb3J0IHsgY2VudGVyQ29udGVudEluSWRlbnRpdHkgfSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvdXRpbHMtcG9zaXRpb25cIjtcblxuLyoqXG4gKiBBbiBJbnRlbnQgUmVzb2x2ZXIgVXNlZCBmb3IgcmVzb2x2aW5nIGludGVudCBzZWxlY3Rpb24uXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnRlbnRSZXNvbHZlckhlbHBlciB7XG5cdHByaXZhdGUgcmVhZG9ubHkgX2xvZ2dlcjogTG9nZ2VyO1xuXG5cdHByaXZhdGUgcmVhZG9ubHkgX2ludGVudFJlc29sdmVyT3B0aW9ucz86IEludGVudFJlc29sdmVyT3B0aW9ucztcblxuXHRwcml2YXRlIHJlYWRvbmx5IF91bnJlZ2lzdGVyZWRBcHBJZD86IHN0cmluZztcblxuXHRwcml2YXRlIHJlYWRvbmx5IF9kZWZhdWx0SW50ZW50UmVzb2x2ZXJIZWlnaHQ6IG51bWJlcjtcblxuXHRwcml2YXRlIHJlYWRvbmx5IF9kZWZhdWx0SW50ZW50UmVzb2x2ZXJXaWR0aDogbnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgdGhlIEludGVudCBSZXNvbHZlciBIZWxwZXIuXG5cdCAqIEBwYXJhbSBpbnRlbnRSZXNvbHZlck9wdGlvbnMgb3B0aW9ucyBmb3IgdGhlIGhlbHBlclxuXHQgKiBAcGFyYW0gbG9nZ2VyIHRoZSBsb2dnZXIgdG8gdXNlLlxuXHQgKiBAcGFyYW0gdW5yZWdpc3RlcmVkQXBwSWQgaWYgeW91IHN1cHBvcnQgdW5yZWdpc3RlcmVkIGFwcHMgd2hhdCBJZCBzaG91bGQgdGhleSBiZSBhc3NpZ25lZCBhZ2FpbnN0LlxuXHQgKi9cblx0Y29uc3RydWN0b3IoaW50ZW50UmVzb2x2ZXJPcHRpb25zOiBJbnRlbnRSZXNvbHZlck9wdGlvbnMsIGxvZ2dlcjogTG9nZ2VyLCB1bnJlZ2lzdGVyZWRBcHBJZD86IHN0cmluZykge1xuXHRcdHRoaXMuX2RlZmF1bHRJbnRlbnRSZXNvbHZlckhlaWdodCA9IDcxNTtcblx0XHR0aGlzLl9kZWZhdWx0SW50ZW50UmVzb2x2ZXJXaWR0aCA9IDY2NTtcblx0XHR0aGlzLl9pbnRlbnRSZXNvbHZlck9wdGlvbnMgPSB7XG5cdFx0XHRoZWlnaHQ6IHRoaXMuX2RlZmF1bHRJbnRlbnRSZXNvbHZlckhlaWdodCxcblx0XHRcdHdpZHRoOiB0aGlzLl9kZWZhdWx0SW50ZW50UmVzb2x2ZXJXaWR0aCxcblx0XHRcdGZkYzNJbnRlcm9wQXBpOiBcIjIuMFwiLFxuXHRcdFx0dGl0bGU6IFwiSW50ZW50IFJlc29sdmVyXCIsXG5cdFx0XHQuLi5pbnRlbnRSZXNvbHZlck9wdGlvbnNcblx0XHR9O1xuXHRcdHRoaXMuX2xvZ2dlciA9IGxvZ2dlcjtcblx0fVxuXG5cdC8qKlxuXHQgKiBMYXVuY2ggdGhlIGludGVudCByZXNvbHZlci5cblx0ICogQHBhcmFtIGxhdW5jaE9wdGlvbnMgVGhlIG9wdGlvbnMgZm9yIGxhdW5jaGluZyB0aGUgcmVzb2x2ZXIuXG5cdCAqIEBwYXJhbSBsYXVuY2hPcHRpb25zLmFwcHMgVGhlIGFwcHMgdG8gcGljayBmcm9tLlxuXHQgKiBAcGFyYW0gbGF1bmNoT3B0aW9ucy5pbnRlbnQgVGhlIGludGVudCB0byBwaWNrLlxuXHQgKiBAcGFyYW0gbGF1bmNoT3B0aW9ucy5pbnRlbnRzIFRoZSBpbnRlbnRzIHRvIHBpY2sgZnJvbS5cblx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgdGhhdCB0cmlnZ2VyZWQgdGhpcyByZXF1ZXN0LlxuXHQgKiBAcmV0dXJucyBUaGUgcmVzcG9uc2UgZnJvbSB0aGUgaW50ZW50IHJlc29sdmVyLlxuXHQgKi9cblx0cHVibGljIGFzeW5jIGxhdW5jaEludGVudFJlc29sdmVyKFxuXHRcdGxhdW5jaE9wdGlvbnM6IHtcblx0XHRcdGFwcHM/OiBQbGF0Zm9ybUFwcFtdO1xuXHRcdFx0aW50ZW50PzogUGFydGlhbDxBcHBJbnRlbnQ+O1xuXHRcdFx0aW50ZW50cz86IHsgaW50ZW50OiBQYXJ0aWFsPEFwcEludGVudD47IGFwcHM6IFBsYXRmb3JtQXBwW10gfVtdO1xuXHRcdH0sXG5cdFx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHlcblx0KTogUHJvbWlzZTxJbnRlbnRSZXNvbHZlclJlc3BvbnNlPiB7XG5cdFx0Ly8gbGF1bmNoIGEgbmV3IHdpbmRvdyBhbmQgb3B0aW9uYWxseSBwYXNzIHRoZSBhdmFpbGFibGUgaW50ZW50cyBhcyBjdXN0b21EYXRhLmFwcHMgYXMgcGFydCBvZiB0aGUgd2luZG93XG5cdFx0Ly8gb3B0aW9ucyB0aGUgd2luZG93IGNhbiB0aGVuIHVzZSByYWlzZUludGVudCBhZ2FpbnN0IGEgc3BlY2lmaWMgYXBwICh0aGUgc2VsZWN0ZWQgb25lKS4gdGhpcyBsb2dpYyBydW5zIGluXG5cdFx0Ly8gdGhlIHByb3ZpZGVyIHNvIHdlIGFyZSB1c2luZyBpdCBhcyBhIHdheSBvZiBkZXRlcm1pbmluZyB0aGUgcm9vdCAoc28gaXQgd29ya3Mgd2l0aCByb290IGhvc3RpbmcgYW5kXG5cdFx0Ly8gc3ViZGlyZWN0b3J5IGJhc2VkIGhvc3RpbmcgaWYgYSB1cmwgaXMgbm90IHByb3ZpZGVkKVxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBwb3NpdGlvbiA9IGF3YWl0IGNlbnRlckNvbnRlbnRJbklkZW50aXR5KGNsaWVudElkZW50aXR5LCB7XG5cdFx0XHRcdGhlaWdodDogdGhpcy5faW50ZW50UmVzb2x2ZXJPcHRpb25zPy5oZWlnaHQgPz8gdGhpcy5fZGVmYXVsdEludGVudFJlc29sdmVySGVpZ2h0LFxuXHRcdFx0XHR3aWR0aDogdGhpcy5faW50ZW50UmVzb2x2ZXJPcHRpb25zPy53aWR0aCA/PyB0aGlzLl9kZWZhdWx0SW50ZW50UmVzb2x2ZXJXaWR0aFxuXHRcdFx0fSk7XG5cblx0XHRcdGNvbnN0IHdpbk9wdGlvbjogT3BlbkZpbi5XaW5kb3dDcmVhdGlvbk9wdGlvbnMgPSB7XG5cdFx0XHRcdG5hbWU6IFwiaW50ZW50LXBpY2tlclwiLFxuXHRcdFx0XHRpbmNsdWRlSW5TbmFwc2hvdHM6IGZhbHNlLFxuXHRcdFx0XHRmZGMzSW50ZXJvcEFwaTogdGhpcy5faW50ZW50UmVzb2x2ZXJPcHRpb25zPy5mZGMzSW50ZXJvcEFwaSxcblx0XHRcdFx0ZGVmYXVsdFdpZHRoOiB0aGlzLl9pbnRlbnRSZXNvbHZlck9wdGlvbnM/LndpZHRoLFxuXHRcdFx0XHRkZWZhdWx0SGVpZ2h0OiB0aGlzLl9pbnRlbnRSZXNvbHZlck9wdGlvbnM/LmhlaWdodCxcblx0XHRcdFx0c2hvd1Rhc2tiYXJJY29uOiBmYWxzZSxcblx0XHRcdFx0c2F2ZVdpbmRvd1N0YXRlOiBmYWxzZSxcblx0XHRcdFx0Y3VzdG9tRGF0YToge1xuXHRcdFx0XHRcdHRpdGxlOiB0aGlzLl9pbnRlbnRSZXNvbHZlck9wdGlvbnM/LnRpdGxlLFxuXHRcdFx0XHRcdGFwcHM6IGxhdW5jaE9wdGlvbnMuYXBwcyxcblx0XHRcdFx0XHRpbnRlbnQ6IGxhdW5jaE9wdGlvbnMuaW50ZW50LFxuXHRcdFx0XHRcdGludGVudHM6IGxhdW5jaE9wdGlvbnMuaW50ZW50cyxcblx0XHRcdFx0XHR1bnJlZ2lzdGVyZWRBcHBJZDogdGhpcy5fdW5yZWdpc3RlcmVkQXBwSWRcblx0XHRcdFx0fSxcblx0XHRcdFx0dXJsOiB0aGlzLl9pbnRlbnRSZXNvbHZlck9wdGlvbnM/LnVybCxcblx0XHRcdFx0ZnJhbWU6IGZhbHNlLFxuXHRcdFx0XHRhdXRvU2hvdzogdHJ1ZSxcblx0XHRcdFx0YWx3YXlzT25Ub3A6IHRydWVcblx0XHRcdH07XG5cdFx0XHRpZiAoIWlzRW1wdHkocG9zaXRpb24pKSB7XG5cdFx0XHRcdHdpbk9wdGlvbi5kZWZhdWx0TGVmdCA9IHBvc2l0aW9uLng7XG5cdFx0XHRcdHdpbk9wdGlvbi5kZWZhdWx0VG9wID0gcG9zaXRpb24ueTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHdpbk9wdGlvbi5kZWZhdWx0Q2VudGVyZWQgPSB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCB3aW4gPSBhd2FpdCBmaW4uV2luZG93LmNyZWF0ZSh3aW5PcHRpb24pO1xuXHRcdFx0Y29uc3Qgd2ViV2luZG93ID0gd2luLmdldFdlYldpbmRvdygpO1xuXHRcdFx0Y29uc3Qgd2ViV2luZG93UmVzb2x2ZXIgPSB3ZWJXaW5kb3cgYXMgdW5rbm93biBhcyB7XG5cdFx0XHRcdGdldEludGVudFNlbGVjdGlvbjogKCkgPT4gUHJvbWlzZTxJbnRlbnRSZXNvbHZlclJlc3BvbnNlPjtcblx0XHRcdH07XG5cdFx0XHRjb25zdCBzZWxlY3RlZEFwcElkOiBJbnRlbnRSZXNvbHZlclJlc3BvbnNlID0gYXdhaXQgd2ViV2luZG93UmVzb2x2ZXIuZ2V0SW50ZW50U2VsZWN0aW9uKCk7XG5cdFx0XHRyZXR1cm4gc2VsZWN0ZWRBcHBJZDtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc3QgbWVzc2FnZSA9IGZvcm1hdEVycm9yKGVycm9yKTtcblxuXHRcdFx0aWYgKG1lc3NhZ2U/LmluY2x1ZGVzKFJlc29sdmVFcnJvci5Vc2VyQ2FuY2VsbGVkKSkge1xuXHRcdFx0XHR0aGlzLl9sb2dnZXIuaW5mbyhcIkFwcCBmb3IgaW50ZW50IG5vdCBzZWxlY3RlZC9sYXVuY2hlZCBieSB1c2VyXCIsIGxhdW5jaE9wdGlvbnMuaW50ZW50KTtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5fbG9nZ2VyLmVycm9yKFwiVW5leHBlY3RlZCBlcnJvciBmcm9tIGludGVudCBwaWNrZXIvcmVzb2x2ZXIgZm9yIGludGVudFwiLCBsYXVuY2hPcHRpb25zLmludGVudCk7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLlJlc29sdmVyVW5hdmFpbGFibGUpO1xuXHRcdH1cblx0fVxufVxuIiwiaW1wb3J0IHR5cGUgeyBNb2R1bGVJbXBsZW1lbnRhdGlvbiwgTW9kdWxlVHlwZXMgfSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvc2hhcGVzL21vZHVsZS1zaGFwZXNcIjtcbmltcG9ydCB7IFdwc0ludGVyb3BPdmVycmlkZSB9IGZyb20gXCIuL2ludGVyb3Atb3ZlcnJpZGVcIjtcblxuLyoqXG4gKiBEZWZpbmUgdGhlIGVudHJ5IHBvaW50cyBmb3IgdGhlIG1vZHVsZS5cbiAqL1xuZXhwb3J0IGNvbnN0IGVudHJ5UG9pbnRzOiB7IFt0eXBlIGluIE1vZHVsZVR5cGVzXT86IE1vZHVsZUltcGxlbWVudGF0aW9uIH0gPSB7XG5cdGludGVyb3BPdmVycmlkZTogbmV3IFdwc0ludGVyb3BPdmVycmlkZSgpXG59O1xuIiwiLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1jbGFzc2VzLXBlci1maWxlXG5pbXBvcnQgdHlwZSBPcGVuRmluIGZyb20gXCJAb3BlbmZpbi9jb3JlXCI7XG5pbXBvcnQgdHlwZSB7XG5cdFBsYXRmb3JtSW50ZXJvcE92ZXJyaWRlLFxuXHRQbGF0Zm9ybUludGVyb3BPdmVycmlkZU9wdGlvbnNcbn0gZnJvbSBcIndvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyL3NoYXBlcy9pbnRlcm9wYnJva2VyLXNoYXBlc1wiO1xuaW1wb3J0IHR5cGUgeyBMb2dnZXIsIExvZ2dlckNyZWF0b3IgfSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvc2hhcGVzL2xvZ2dlci1zaGFwZXNcIjtcbmltcG9ydCB0eXBlIHsgTW9kdWxlRGVmaW5pdGlvbiwgTW9kdWxlSGVscGVycyB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci9zaGFwZXMvbW9kdWxlLXNoYXBlc1wiO1xuaW1wb3J0IHsgZ2V0Q29uc3RydWN0b3JPdmVycmlkZSBhcyB3cHNDb25zdHJ1Y3Rvck92ZXJyaWRlIH0gZnJvbSBcIi4vYnJva2VyL3dwcy1pbnRlcm9wLW92ZXJyaWRlXCI7XG5pbXBvcnQgdHlwZSB7IFdwc0ludGVyb3BPdmVycmlkZU9wdGlvbnMgfSBmcm9tIFwiLi9zaGFwZXNcIjtcbi8qKlxuICogSW1wbGVtZW50YXRpb24gZm9yIHRoZSB3cHMgaW50ZXJvcCBvdmVycmlkZSBpbnRlcm9wIG92ZXJyaWRlLlxuICovXG5leHBvcnQgY2xhc3MgV3BzSW50ZXJvcE92ZXJyaWRlIGltcGxlbWVudHMgUGxhdGZvcm1JbnRlcm9wT3ZlcnJpZGU8V3BzSW50ZXJvcE92ZXJyaWRlT3B0aW9ucz4ge1xuXHQvKipcblx0ICogVGhlIG1vZHVsZSBkZWZpbml0aW9uIGluY2x1ZGluZyBzZXR0aW5ncy5cblx0ICogQGludGVybmFsXG5cdCAqL1xuXHRwcml2YXRlIF9kZWZpbml0aW9uOiBNb2R1bGVEZWZpbml0aW9uPFdwc0ludGVyb3BPdmVycmlkZU9wdGlvbnM+IHwgdW5kZWZpbmVkO1xuXG5cdC8qKlxuXHQgKiBUaGUgbG9nZ2VyIGZvciBkaXNwbGF5aW5nIGluZm9ybWF0aW9uIGZyb20gdGhlIG1vZHVsZS5cblx0ICogQGludGVybmFsXG5cdCAqL1xuXHRwcml2YXRlIF9sb2dnZXI/OiBMb2dnZXI7XG5cblx0LyoqXG5cdCAqIEhlbHBlciBtZXRob2RzIGZvciB0aGUgbW9kdWxlLlxuXHQgKiBAaW50ZXJuYWxcblx0ICovXG5cdHByaXZhdGUgX2hlbHBlcnM6IE1vZHVsZUhlbHBlcnMgfCB1bmRlZmluZWQ7XG5cblx0LyoqXG5cdCAqIEluaXRpYWxpemUgdGhlIG1vZHVsZS5cblx0ICogQHBhcmFtIGRlZmluaXRpb24gVGhlIGRlZmluaXRpb24gb2YgdGhlIG1vZHVsZSBmcm9tIGNvbmZpZ3VyYXRpb24gaW5jbHVkZSBjdXN0b20gb3B0aW9ucy5cblx0ICogQHBhcmFtIGxvZ2dlckNyZWF0b3IgRm9yIGxvZ2dpbmcgZW50cmllcy5cblx0ICogQHBhcmFtIGhlbHBlcnMgSGVscGVyIG1ldGhvZHMgZm9yIHRoZSBtb2R1bGUgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgYXBwbGljYXRpb24gY29yZS5cblx0ICogQHJldHVybnMgTm90aGluZy5cblx0ICovXG5cdHB1YmxpYyBhc3luYyBpbml0aWFsaXplKFxuXHRcdGRlZmluaXRpb246IE1vZHVsZURlZmluaXRpb248V3BzSW50ZXJvcE92ZXJyaWRlT3B0aW9ucz4sXG5cdFx0bG9nZ2VyQ3JlYXRvcjogTG9nZ2VyQ3JlYXRvcixcblx0XHRoZWxwZXJzOiBNb2R1bGVIZWxwZXJzXG5cdCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRoaXMuX2RlZmluaXRpb24gPSBkZWZpbml0aW9uO1xuXHRcdGNvbnN0IGxvZ2dlck5hbWUgPSBkZWZpbml0aW9uLmRhdGE/LmxvZ2dlck5hbWUgPz8gXCJXcHNJbnRlcm9wT3ZlcnJpZGVcIjtcblx0XHR0aGlzLl9sb2dnZXIgPSBsb2dnZXJDcmVhdG9yKGxvZ2dlck5hbWUpO1xuXHRcdHRoaXMuX2hlbHBlcnMgPSBoZWxwZXJzO1xuXG5cdFx0dGhpcy5fbG9nZ2VyLmluZm8oXCJJbml0aWFsaXppbmdcIik7XG5cdH1cblxuXHQvKipcblx0ICogQ2xvc2UgZG93biBhbnkgcmVzb3VyY2VzIGJlaW5nIHVzZWQgYnkgdGhlIG1vZHVsZS5cblx0ICogQHJldHVybnMgTm90aGluZy5cblx0ICovXG5cdHB1YmxpYyBhc3luYyBjbG9zZWRvd24oKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dGhpcy5fbG9nZ2VyPy5pbmZvKFwiQ2xvc2Vkb3duXCIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCB0aGUgb3ZlcnJpZGUgY29uc3RydWN0b3IgZm9yIHRoZSBpbnRlcm9wIGJyb2tlciAodXNlZnVsIGlmIHlvdSB3aXNoIHRoaXMgaW1wbGVtZW50YXRpb24gdG8gYmUgbGF5ZXJlZCB3aXRoIG90aGVyIGltcGxlbWVudGF0aW9ucyBhbmQgcGFzc2VkIHRvIHRoZSBwbGF0Zm9ybSdzIGluaXRpYWxpemF0aW9uIG9iamVjdCBhcyBwYXJ0IG9mIGFuIGFycmF5KS5cblx0ICogQHBhcmFtIG9wdGlvbnMgVGhlIG9wdGlvbnMgZm9yIHRoZSBpbnRlcm9wIGJyb2tlciBkZWZpbmVkIGFzIHBhcnQgb2YgdGhlIHBsYXRmb3JtLlxuXHQgKiBAcmV0dXJucyBUaGUgb3ZlcnJpZGUgY29uc3RydWN0b3IgdG8gYmUgdXNlZCBpbiBhbiBhcnJheS5cblx0ICovXG5cdHB1YmxpYyBhc3luYyBnZXRDb25zdHJ1Y3Rvck92ZXJyaWRlKFxuXHRcdG9wdGlvbnM6IFBsYXRmb3JtSW50ZXJvcE92ZXJyaWRlT3B0aW9uc1xuXHQpOiBQcm9taXNlPE9wZW5GaW4uQ29uc3RydWN0b3JPdmVycmlkZTxPcGVuRmluLkludGVyb3BCcm9rZXI+PiB7XG5cdFx0aWYgKCF0aGlzLl9oZWxwZXJzIHx8ICF0aGlzLl9sb2dnZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIk1vZHVsZSBub3QgaW5pdGlhbGl6ZWRcIik7XG5cdFx0fVxuXHRcdHJldHVybiB3cHNDb25zdHJ1Y3Rvck92ZXJyaWRlKG9wdGlvbnMsIHRoaXMuX2xvZ2dlciwgdGhpcy5faGVscGVycyk7XG5cdH1cbn1cbiIsImltcG9ydCB0eXBlIHtcblx0QXBwSWRlbnRpZmllcixcblx0QXBwTWV0YWRhdGEsXG5cdEltcGxlbWVudGF0aW9uTWV0YWRhdGEsXG5cdEludGVudFJlc29sdXRpb24sXG5cdENvbnRleHRNZXRhZGF0YVxufSBmcm9tIFwiQGZpbm9zL2ZkYzNcIjtcbmltcG9ydCB0eXBlIE9wZW5GaW4gZnJvbSBcIkBvcGVuZmluL2NvcmVcIjtcbmltcG9ydCB7IG1hcFRvQXBwTWV0YURhdGEgYXMgbWFwVG8xMkFwcE1ldGFEYXRhIH0gZnJvbSBcIndvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyL2ZkYzMvMS4yL21hcHBlclwiO1xuaW1wb3J0IHsgbWFwVG9BcHBNZXRhRGF0YSBhcyBtYXBUbzIwQXBwTWV0YURhdGEgfSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvZmRjMy8yLjAvbWFwcGVyXCI7XG5pbXBvcnQge1xuXHRPUEVOX0VSUk9SIGFzIE9wZW5FcnJvcixcblx0UkVTT0xWRV9FUlJPUiBhcyBSZXNvbHZlRXJyb3Jcbn0gZnJvbSBcIndvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyL2ZkYzMvZXJyb3JzXCI7XG5pbXBvcnQgeyBNQU5JRkVTVF9UWVBFUyB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci9tYW5pZmVzdC10eXBlc1wiO1xuaW1wb3J0IHR5cGUgeyBFbmRwb2ludENsaWVudCB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci9zaGFwZXNcIjtcbmltcG9ydCB0eXBlIHtcblx0QXBwc0ZvckludGVudCxcblx0TGF1bmNoUHJlZmVyZW5jZSxcblx0UGxhdGZvcm1BcHAsXG5cdFBsYXRmb3JtQXBwSWRlbnRpZmllclxufSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvc2hhcGVzL2FwcC1zaGFwZXNcIjtcbmltcG9ydCB0eXBlIHsgQXBwTWV0YWRhdGEgYXMgQXBwTWV0YWRhdGFWMVBvaW50MiB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci9zaGFwZXMvZmRjMy0xLTItc2hhcGVzXCI7XG5pbXBvcnQgdHlwZSB7XG5cdEFwaU1ldGFkYXRhLFxuXHRDYXB0dXJlQXBpUGF5bG9hZCxcblx0Q29udGV4dFRvUHJvY2Vzcyxcblx0T3Blbk9wdGlvbnMsXG5cdEludGVudFJlc29sdmVyUmVzcG9uc2UsXG5cdEludGVudFJlZ2lzdHJhdGlvblBheWxvYWQsXG5cdEludGVudFRhcmdldE1ldGFEYXRhLFxuXHRQcm9jZXNzZWRDb250ZXh0LFxuXHRQbGF0Zm9ybUludGVyb3BPdmVycmlkZU9wdGlvbnNcbn0gZnJvbSBcIndvcmtzcGFjZS1wbGF0Zm9ybS1zdGFydGVyL3NoYXBlcy9pbnRlcm9wYnJva2VyLXNoYXBlc1wiO1xuaW1wb3J0IHR5cGUgeyBMb2dnZXIgfSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvc2hhcGVzL2xvZ2dlci1zaGFwZXNcIjtcbmltcG9ydCB0eXBlIHsgTW9kdWxlSGVscGVycyB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci9zaGFwZXMvbW9kdWxlLXNoYXBlc1wiO1xuaW1wb3J0IHtcblx0Zm9ybWF0RXJyb3IsXG5cdGlzRW1wdHksXG5cdGlzU3RyaW5nLFxuXHRpc1N0cmluZ1ZhbHVlLFxuXHRyYW5kb21VVUlELFxuXHRzYW5pdGl6ZVN0cmluZ1xufSBmcm9tIFwid29ya3NwYWNlLXBsYXRmb3JtLXN0YXJ0ZXIvdXRpbHNcIjtcbmltcG9ydCB7IGdldFdpbmRvd1Bvc2l0aW9uVXNpbmdTdHJhdGVneSB9IGZyb20gXCJ3b3Jrc3BhY2UtcGxhdGZvcm0tc3RhcnRlci91dGlscy1wb3NpdGlvblwiO1xuaW1wb3J0IHsgQXBwSW50ZW50SGVscGVyIH0gZnJvbSBcIi4vYXBwLWludGVudC1oZWxwZXJcIjtcbmltcG9ydCB7IENsaWVudFJlZ2lzdHJhdGlvbkhlbHBlciB9IGZyb20gXCIuL2NsaWVudC1yZWdpc3RyYXRpb24taGVscGVyXCI7XG5pbXBvcnQgeyBJbnRlbnRSZXNvbHZlckhlbHBlciB9IGZyb20gXCIuL2ludGVudC1yZXNvbHZlci1oZWxwZXJcIjtcblxuLyoqXG4gKiBHZXQgdGhlIG92ZXJyaWRlIGNvbnN0cnVjdG9yIGZvciB0aGUgaW50ZXJvcCBicm9rZXIgKHVzZWZ1bCBpZiB5b3Ugd2lzaCB0aGlzIGltcGxlbWVudGF0aW9uIHRvIGJlIGxheWVyZWQgd2l0aCBvdGhlciBpbXBsZW1lbnRhdGlvbnMgYW5kIHBhc3NlZCB0byB0aGUgcGxhdGZvcm0ncyBpbml0aWFsaXphdGlvbiBvYmplY3QgYXMgcGFydCBvZiBhbiBhcnJheSkuXG4gKiBAcGFyYW0gb3B0aW9ucyBUaGUgb3B0aW9ucyBmb3IgdGhlIGludGVyb3AgYnJva2VyIGRlZmluZWQgYXMgcGFydCBvZiB0aGUgcGxhdGZvcm0uXG4gKiBAcGFyYW0gbG9nZ2VyIFRoZSBsb2dnZXIgdG8gdXNlLlxuICogQHBhcmFtIGhlbHBlcnMgQSBjb2xsZWN0aW9uIG9mIGhlbHBlciBtZXRob2RzLlxuICogQHJldHVybnMgVGhlIG92ZXJyaWRlIGNvbnN0cnVjdG9yIHRvIGJlIHVzZWQgaW4gYW4gYXJyYXkuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDb25zdHJ1Y3Rvck92ZXJyaWRlKFxuXHRvcHRpb25zOiBQbGF0Zm9ybUludGVyb3BPdmVycmlkZU9wdGlvbnMsXG5cdGxvZ2dlcjogTG9nZ2VyLFxuXHRoZWxwZXJzOiBNb2R1bGVIZWxwZXJzXG4pOiBQcm9taXNlPE9wZW5GaW4uQ29uc3RydWN0b3JPdmVycmlkZTxPcGVuRmluLkludGVyb3BCcm9rZXI+PiB7XG5cdGlmICghaGVscGVycz8uZ2V0QXBwIHx8ICFoZWxwZXJzPy5nZXRBcHBzIHx8ICFoZWxwZXJzLmxhdW5jaEFwcCkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcblx0XHRcdFwiSW50ZXJvcCBCcm9rZXIgQ29uc3RydWN0b3IgaXMgbWlzc2luZyByZXF1aXJlZCBoZWxwZXJzLiBUaGUgYnJva2VyIHdpbGwgbm90IGZ1bmN0aW9uIGNvcnJlY3RseSBzbyB0aGlzIGVycm9yIGlzIHRvIGZsYWcgdGhlIGlzc3VlLlwiXG5cdFx0KTtcblx0fVxuXHRjb25zdCBnZXRBcHAgPSBoZWxwZXJzLmdldEFwcDtcblx0Y29uc3QgZ2V0QXBwcyA9IGhlbHBlcnMuZ2V0QXBwcztcblx0bGV0IGVuZHBvaW50Q2xpZW50OiBFbmRwb2ludENsaWVudCB8IHVuZGVmaW5lZDtcblx0aWYgKGhlbHBlcnM/LmdldEVuZHBvaW50Q2xpZW50KSB7XG5cdFx0ZW5kcG9pbnRDbGllbnQgPSBhd2FpdCBoZWxwZXJzPy5nZXRFbmRwb2ludENsaWVudCgpO1xuXHR9XG5cblx0Y29uc3QgbGF1bmNoID0gaGVscGVycy5sYXVuY2hBcHA7XG5cdHJldHVybiAoQmFzZTogT3BlbkZpbi5Db25zdHJ1Y3RvcjxPcGVuRmluLkludGVyb3BCcm9rZXI+KSA9PlxuXHRcdC8qKlxuXHRcdCAqIEV4dGVuZCB0aGUgSW50ZXJvcEJyb2tlciB0byBoYW5kbGUgaW50ZW50cy5cblx0XHQgKi9cblx0XHRjbGFzcyBJbnRlcm9wT3ZlcnJpZGUgZXh0ZW5kcyBCYXNlIHtcblx0XHRcdHByaXZhdGUgcmVhZG9ubHkgX29wZW5PcHRpb25zPzogT3Blbk9wdGlvbnM7XG5cblx0XHRcdHByaXZhdGUgcmVhZG9ubHkgX3VucmVnaXN0ZXJlZEFwcDogUGxhdGZvcm1BcHAgfCB1bmRlZmluZWQ7XG5cblx0XHRcdHByaXZhdGUgcmVhZG9ubHkgX2FwcEludGVudEhlbHBlcjogQXBwSW50ZW50SGVscGVyO1xuXG5cdFx0XHRwcml2YXRlIHJlYWRvbmx5IF9jbGllbnRSZWdpc3RyYXRpb25IZWxwZXI6IENsaWVudFJlZ2lzdHJhdGlvbkhlbHBlcjtcblxuXHRcdFx0cHJpdmF0ZSByZWFkb25seSBfaW50ZW50UmVzb2x2ZXJIZWxwZXI/OiBJbnRlbnRSZXNvbHZlckhlbHBlcjtcblxuXHRcdFx0cHJpdmF0ZSByZWFkb25seSBfbWV0YWRhdGFLZXk6IFJlYWRvbmx5PHN0cmluZz47XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIEludGVyb3BCcm9rZXIuXG5cdFx0XHQgKi9cblx0XHRcdGNvbnN0cnVjdG9yKCkge1xuXHRcdFx0XHRzdXBlcigpO1xuXHRcdFx0XHRsb2dnZXIuaW5mbyhcIkludGVyb3AgQnJva2VyIENvbnN0cnVjdG9yIGFwcGx5aW5nIHNldHRpbmdzLlwiKTtcblx0XHRcdFx0dGhpcy5fYXBwSW50ZW50SGVscGVyID0gbmV3IEFwcEludGVudEhlbHBlcihnZXRBcHBzLCBsb2dnZXIpO1xuXHRcdFx0XHR0aGlzLl9jbGllbnRSZWdpc3RyYXRpb25IZWxwZXIgPSBuZXcgQ2xpZW50UmVnaXN0cmF0aW9uSGVscGVyKFxuXHRcdFx0XHRcdGFzeW5jIChjbGllbnRJZGVudGl0eTogT3BlbkZpbi5DbGllbnRJZGVudGl0eSkgPT4gdGhpcy5sb29rdXBBcHBJZChjbGllbnRJZGVudGl0eSksXG5cdFx0XHRcdFx0bG9nZ2VyXG5cdFx0XHRcdCk7XG5cdFx0XHRcdHRoaXMuX21ldGFkYXRhS2V5ID0gYF9tZXRhZGF0YV8ke3JhbmRvbVVVSUQoKX1gO1xuXHRcdFx0XHRpZiAob3B0aW9ucy5pbnRlbnRSZXNvbHZlcikge1xuXHRcdFx0XHRcdHRoaXMuX2ludGVudFJlc29sdmVySGVscGVyID0gbmV3IEludGVudFJlc29sdmVySGVscGVyKFxuXHRcdFx0XHRcdFx0b3B0aW9ucy5pbnRlbnRSZXNvbHZlcixcblx0XHRcdFx0XHRcdGxvZ2dlcixcblx0XHRcdFx0XHRcdG9wdGlvbnM/LnVucmVnaXN0ZXJlZEFwcD8uYXBwSWRcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5fb3Blbk9wdGlvbnMgPSBvcHRpb25zPy5vcGVuT3B0aW9ucztcblx0XHRcdFx0dGhpcy5fdW5yZWdpc3RlcmVkQXBwID0gb3B0aW9ucz8udW5yZWdpc3RlcmVkQXBwO1xuXHRcdFx0XHRpZiAoIWlzRW1wdHkodGhpcy5fdW5yZWdpc3RlcmVkQXBwKSkge1xuXHRcdFx0XHRcdHRoaXMuX3VucmVnaXN0ZXJlZEFwcC5tYW5pZmVzdFR5cGUgPSBNQU5JRkVTVF9UWVBFUy5VbnJlZ2lzdGVyZWRBcHAuaWQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBJcyB0aGUgY29ubmVjdGlvbiBhdXRob3JpemVkLlxuXHRcdFx0ICogQHBhcmFtIGlkIFRoZSBpZCBvZiB0aGUgY2xpZW50IGlkZW50aXR5IHRvIGNoZWNrLlxuXHRcdFx0ICogQHBhcmFtIHBheWxvYWQgVGhlIHBheWxvYWQgdG8gc2VuZCB3aXRoIHRoZSBhdXRob3JpemF0aW9uIGNoZWNrLlxuXHRcdFx0ICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgY29ubmVjdGlvbiBpcyBhdXRob3JpemVkLlxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWMgYXN5bmMgaXNDb25uZWN0aW9uQXV0aG9yaXplZChpZDogT3BlbkZpbi5DbGllbnRJZGVudGl0eSwgcGF5bG9hZD86IHVua25vd24pOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRcdFx0bG9nZ2VyLmluZm8oXG5cdFx0XHRcdFx0XCJJbnRlcm9wIGNvbm5lY3Rpb24gYmVpbmcgbWFkZSBieSB0aGUgZm9sbG93aW5nIGlkZW50aXR5LiBBYm91dCB0byB2ZXJpZnkgY29ubmVjdGlvblwiLFxuXHRcdFx0XHRcdGlkXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGNvbnN0IGFwaVBheWxvYWQ6IENhcHR1cmVBcGlQYXlsb2FkID0gcGF5bG9hZCBhcyBDYXB0dXJlQXBpUGF5bG9hZDtcblx0XHRcdFx0aWYgKCFpc0VtcHR5KGhlbHBlcnMuaXNDb25uZWN0aW9uVmFsaWQpKSB7XG5cdFx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBoZWxwZXJzLmlzQ29ubmVjdGlvblZhbGlkKGlkLCBwYXlsb2FkLCB7IHR5cGU6IFwiYnJva2VyXCIgfSk7XG5cdFx0XHRcdFx0aWYgKHJlc3BvbnNlLmlzVmFsaWQpIHtcblx0XHRcdFx0XHRcdGxvZ2dlci5pbmZvKFwiQ29ubmVjdGlvbiB2YWxpZGF0aW9uIHJlcXVlc3Qgd2FzIHZhbGlkYXRlZCBhbmQgaXMgdmFsaWQuXCIpO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmNsaWVudENvbm5lY3Rpb25SZWdpc3RlcmVkKGlkLCBhcGlQYXlsb2FkKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0bG9nZ2VyLndhcm4oYENvbm5lY3Rpb24gcmVxdWVzdCBmcm9tICR7SlNPTi5zdHJpbmdpZnkoaWQpfSB3YXMgdmFsaWRhdGVkIGFuZCByZWplY3RlZC5gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlLmlzVmFsaWQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gd2UgaGF2ZSBub3QgYmVlbiBwcm92aWRlZCB3aXRoIGEgbWVhbnMgdG8gdmFsaWRhdGUgdGhlIGNvbm5lY3Rpb24gc28gZmFsbGJhY2sgdG8gZGVmYXVsdCBiZWhhdmlvciBhbmQgcmVnaXN0ZXIgdGhlIGNvbm5lY3Rpb25cblx0XHRcdFx0Y29uc3QgaXNWYWxpZCA9IGF3YWl0IHN1cGVyLmlzQ29ubmVjdGlvbkF1dGhvcml6ZWQoaWQsIHBheWxvYWQpO1xuXHRcdFx0XHRpZiAoaXNWYWxpZCkge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuX2NsaWVudFJlZ2lzdHJhdGlvbkhlbHBlci5jbGllbnRDb25uZWN0aW9uUmVnaXN0ZXJlZChpZCwgYXBpUGF5bG9hZCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGlzVmFsaWQ7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogU2V0cyBhIGNvbnRleHQgZm9yIHRoZSBjb250ZXh0IGdyb3VwIG9mIHRoZSBpbmNvbWluZyBjdXJyZW50IGVudGl0eS5cblx0XHRcdCAqIEBwYXJhbSBzZW50Q29udGV4dCBOZXcgY29udGV4dCB0byBzZXQuXG5cdFx0XHQgKiBAcGFyYW0gc2VudENvbnRleHQuY29udGV4dCBUaGUgY29udGV4dCB0byBzZW5kLlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IElkZW50aXR5IG9mIHRoZSBjbGllbnQgc2VuZGVyLlxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWMgYXN5bmMgc2V0Q29udGV4dChcblx0XHRcdFx0c2VudENvbnRleHQ6IHsgY29udGV4dDogT3BlbkZpbi5Db250ZXh0IH0sXG5cdFx0XHRcdGNsaWVudElkZW50aXR5OiBPcGVuRmluLkNsaWVudElkZW50aXR5XG5cdFx0XHQpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRcdFx0c2VudENvbnRleHQuY29udGV4dCA9IGF3YWl0IHRoaXMucHJvY2Vzc0NvbnRleHQoc2VudENvbnRleHQuY29udGV4dCk7XG5cdFx0XHRcdGNvbnN0IGNvbnRleHRNZXRhZGF0YSA9IGF3YWl0IHRoaXMuZ2V0Q29udGV4dE1ldGFkYXRhKGNsaWVudElkZW50aXR5KTtcblxuXHRcdFx0XHRzZW50Q29udGV4dC5jb250ZXh0ID0ge1xuXHRcdFx0XHRcdC4uLnNlbnRDb250ZXh0LmNvbnRleHQsXG5cdFx0XHRcdFx0W3RoaXMuX21ldGFkYXRhS2V5XTogY29udGV4dE1ldGFkYXRhXG5cdFx0XHRcdH0gYXMgdW5rbm93biBhcyBPcGVuRmluLkNvbnRleHQ7XG5cdFx0XHRcdHN1cGVyLnNldENvbnRleHQoc2VudENvbnRleHQsIGNsaWVudElkZW50aXR5KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBJbnZva2VzIHRoZSBjb250ZXh0IGhhbmRsZXIuXG5cdFx0XHQgKiBAcGFyYW0gY2xpZW50SWRlbnRpdHkgVGhlIGNsaWVudCBpZGVudGl0eS5cblx0XHRcdCAqIEBwYXJhbSBoYW5kbGVySWQgVGhlIGhhbmRsZXIgSUQuXG5cdFx0XHQgKiBAcGFyYW0gY29udGV4dCBUaGUgY29udGV4dCB0byBpbnZva2UuXG5cdFx0XHQgKiBAcmV0dXJucyBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIHRoZSBjb250ZXh0IGhhbmRsZXIgaXMgaW52b2tlZC5cblx0XHRcdCAqL1xuXHRcdFx0cHVibGljIGFzeW5jIGludm9rZUNvbnRleHRIYW5kbGVyKFxuXHRcdFx0XHRjbGllbnRJZGVudGl0eTogT3BlbkZpbi5DbGllbnRJZGVudGl0eSxcblx0XHRcdFx0aGFuZGxlcklkOiBzdHJpbmcsXG5cdFx0XHRcdGNvbnRleHQ6IE9wZW5GaW4uQ29udGV4dFxuXHRcdFx0KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0XHRcdGNvbnN0IHBhc3NlZENvbnRleHQ6IHsgW2tleTogc3RyaW5nXTogdW5rbm93biB9ID0geyAuLi5jb250ZXh0IH07XG5cdFx0XHRcdGNvbnN0IGNvbnRleHRNZXRhZGF0YSA9IHBhc3NlZENvbnRleHRbdGhpcy5fbWV0YWRhdGFLZXldO1xuXHRcdFx0XHRpZiAoIWlzRW1wdHkoY29udGV4dE1ldGFkYXRhKSkge1xuXHRcdFx0XHRcdGRlbGV0ZSBwYXNzZWRDb250ZXh0W3RoaXMuX21ldGFkYXRhS2V5XTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gc3VwZXIuaW52b2tlQ29udGV4dEhhbmRsZXIoY2xpZW50SWRlbnRpdHksIGhhbmRsZXJJZCwge1xuXHRcdFx0XHRcdC4uLnBhc3NlZENvbnRleHQsXG5cdFx0XHRcdFx0Y29udGV4dE1ldGFkYXRhXG5cdFx0XHRcdH0gYXMgdW5rbm93biBhcyBPcGVuRmluLkNvbnRleHQpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIEhhbmRsZSB0aGUgaW5mb3JtYXRpb24gZm9yIGludGVudHMgYnkgY29udGV4dC5cblx0XHRcdCAqIEBwYXJhbSBjb250ZXh0T3B0aW9ucyBUaGUgY29udGV4dCBvcHRpb25zLlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQuXG5cdFx0XHQgKiBAcmV0dXJucyBUaGUgaW50ZW50cyBtYXBwZWQgdG8gYXBwIG1ldGFkYXRhLlxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWMgYXN5bmMgaGFuZGxlSW5mb0ZvckludGVudHNCeUNvbnRleHQoXG5cdFx0XHRcdGNvbnRleHRPcHRpb25zOiBPcGVuRmluLkNvbnRleHQgfCBPcGVuRmluLkZpbmRJbnRlbnRzQnlDb250ZXh0T3B0aW9ucyxcblx0XHRcdFx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHlcblx0XHRcdCk6IFByb21pc2U8XG5cdFx0XHRcdHtcblx0XHRcdFx0XHRpbnRlbnQ6IHsgbmFtZTogc3RyaW5nOyBkaXNwbGF5TmFtZT86IHN0cmluZyB9O1xuXHRcdFx0XHRcdGFwcHM6IChBcHBNZXRhZGF0YVYxUG9pbnQyIHwgQXBwTWV0YWRhdGEpW107XG5cdFx0XHRcdH1bXVxuXHRcdFx0PiB7XG5cdFx0XHRcdGxldCByZXF1ZXN0ZWRDb250ZXh0VHlwZTogc3RyaW5nO1xuXHRcdFx0XHRsZXQgcmVxdWVzdGVkUmVzdWx0VHlwZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXHRcdFx0XHRsZXQgcmVxdWVzdDogeyBjb250ZXh0OiB7IHR5cGU6IHN0cmluZyB9OyBtZXRhZGF0YTogeyByZXN1bHRUeXBlOiBzdHJpbmcgfSB9O1xuXHRcdFx0XHRjb25zdCBhcGlWZXJzaW9uOiBBcGlNZXRhZGF0YSB8IHVuZGVmaW5lZCA9XG5cdFx0XHRcdFx0dGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmdldEFwaVZlcnNpb24oY2xpZW50SWRlbnRpdHkpO1xuXG5cdFx0XHRcdGlmIChcInR5cGVcIiBpbiBjb250ZXh0T3B0aW9ucykge1xuXHRcdFx0XHRcdHJlcXVlc3RlZENvbnRleHRUeXBlID0gY29udGV4dE9wdGlvbnMudHlwZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXF1ZXN0ID0gY29udGV4dE9wdGlvbnMgYXMgeyBjb250ZXh0OiB7IHR5cGU6IHN0cmluZyB9OyBtZXRhZGF0YTogeyByZXN1bHRUeXBlOiBzdHJpbmcgfSB9O1xuXHRcdFx0XHRcdHJlcXVlc3RlZENvbnRleHRUeXBlID0gcmVxdWVzdC5jb250ZXh0LnR5cGU7XG5cdFx0XHRcdFx0cmVxdWVzdGVkUmVzdWx0VHlwZSA9IHJlcXVlc3QubWV0YWRhdGEucmVzdWx0VHlwZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBpbnRlbnRzID0gYXdhaXQgdGhpcy5fYXBwSW50ZW50SGVscGVyLmdldEludGVudHNCeUNvbnRleHQoXG5cdFx0XHRcdFx0cmVxdWVzdGVkQ29udGV4dFR5cGUsXG5cdFx0XHRcdFx0cmVxdWVzdGVkUmVzdWx0VHlwZVxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdGlmIChpbnRlbnRzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihSZXNvbHZlRXJyb3IuTm9BcHBzRm91bmQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgaXNGREMzMiA9IGFwaVZlcnNpb24/LnR5cGUgPT09IFwiZmRjM1wiICYmIGFwaVZlcnNpb24udmVyc2lvbiA9PT0gXCIyLjBcIjtcblx0XHRcdFx0Y29uc3QgbWFwcGVkSW50ZW50cyA9IGludGVudHMubWFwKChlbnRyeSkgPT4gKHtcblx0XHRcdFx0XHRpbnRlbnQ6IGVudHJ5LmludGVudCxcblx0XHRcdFx0XHRhcHBzOiBlbnRyeS5hcHBzLm1hcCgoYXBwOiBQbGF0Zm9ybUFwcCkgPT4ge1xuXHRcdFx0XHRcdFx0bGV0IHJlc3VsdFR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdGNvbnN0IGxpc3RlbnNGb3IgPSBhcHA/LmludGVyb3A/LmludGVudHM/Lmxpc3RlbnNGb3I7XG5cdFx0XHRcdFx0XHRpZiAoIWlzRW1wdHkobGlzdGVuc0ZvcikgJiYgIWlzRW1wdHkobGlzdGVuc0ZvcltlbnRyeS5pbnRlbnQubmFtZV0pKSB7XG5cdFx0XHRcdFx0XHRcdHJlc3VsdFR5cGUgPSBsaXN0ZW5zRm9yW2VudHJ5LmludGVudC5uYW1lXS5yZXN1bHRUeXBlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Y29uc3QgYXBwRW50cnkgPSBpc0ZEQzMyID8gbWFwVG8yMEFwcE1ldGFEYXRhKGFwcCwgcmVzdWx0VHlwZSkgOiBtYXBUbzEyQXBwTWV0YURhdGEoYXBwKTtcblxuXHRcdFx0XHRcdFx0cmV0dXJuIGFwcEVudHJ5O1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH0pKTtcblxuXHRcdFx0XHRyZXR1cm4gbWFwcGVkSW50ZW50cztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBIYW5kbGUgdGhlIGluZm9ybWF0aW9uIGZvciBhbmQgaW50ZW50LlxuXHRcdFx0ICogQHBhcmFtIGludGVudE9wdGlvbnMgVGhlIGludGVudCBvcHRpb25zLlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQuXG5cdFx0XHQgKiBAcmV0dXJucyBUaGUgaW50ZW50cyBtYXBwZWQgdG8gYXBwIG1ldGFkYXRhLlxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWMgYXN5bmMgaGFuZGxlSW5mb0ZvckludGVudChcblx0XHRcdFx0aW50ZW50T3B0aW9uczogT3BlbkZpbi5JbmZvRm9ySW50ZW50T3B0aW9ucyxcblx0XHRcdFx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHlcblx0XHRcdCk6IFByb21pc2U8e1xuXHRcdFx0XHRpbnRlbnQ6IHsgbmFtZTogc3RyaW5nOyBkaXNwbGF5TmFtZT86IHN0cmluZyB9O1xuXHRcdFx0XHRhcHBzOiAoQXBwTWV0YWRhdGFWMVBvaW50MiB8IEFwcE1ldGFkYXRhKVtdO1xuXHRcdFx0fT4ge1xuXHRcdFx0XHRjb25zdCBhcGlWZXJzaW9uOiBBcGlNZXRhZGF0YSB8IHVuZGVmaW5lZCA9XG5cdFx0XHRcdFx0dGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmdldEFwaVZlcnNpb24oY2xpZW50SWRlbnRpdHkpO1xuXHRcdFx0XHRsZXQgY29udGV4dFR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuXHRcdFx0XHRjb25zdCBvcHRDb250ZXh0VHlwZSA9IGludGVudE9wdGlvbnM/LmNvbnRleHQ/LnR5cGU7XG5cdFx0XHRcdGlmICghaXNFbXB0eShvcHRDb250ZXh0VHlwZSkgJiYgb3B0Q29udGV4dFR5cGUgIT09IFwiZmRjMy5ub3RoaW5nXCIpIHtcblx0XHRcdFx0XHRjb250ZXh0VHlwZSA9IG9wdENvbnRleHRUeXBlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5fYXBwSW50ZW50SGVscGVyLmdldEludGVudChcblx0XHRcdFx0XHRpbnRlbnRPcHRpb25zLm5hbWUsXG5cdFx0XHRcdFx0Y29udGV4dFR5cGUsXG5cdFx0XHRcdFx0aW50ZW50T3B0aW9ucz8ubWV0YWRhdGE/LnJlc3VsdFR5cGVcblx0XHRcdFx0KTtcblx0XHRcdFx0aWYgKGlzRW1wdHkocmVzdWx0KSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihSZXNvbHZlRXJyb3IuTm9BcHBzRm91bmQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgaXNGREMzMiA9IGFwaVZlcnNpb24/LnR5cGUgPT09IFwiZmRjM1wiICYmIGFwaVZlcnNpb24udmVyc2lvbiA9PT0gXCIyLjBcIjtcblx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSB7XG5cdFx0XHRcdFx0aW50ZW50OiByZXN1bHQuaW50ZW50LFxuXHRcdFx0XHRcdGFwcHM6IHJlc3VsdC5hcHBzLm1hcCgoYXBwOiBQbGF0Zm9ybUFwcCkgPT4ge1xuXHRcdFx0XHRcdFx0bGV0IHJlc3VsdFR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdGNvbnN0IGxpc3RlbnNGb3IgPSBhcHA/LmludGVyb3A/LmludGVudHM/Lmxpc3RlbnNGb3I7XG5cdFx0XHRcdFx0XHRpZiAoIWlzRW1wdHkobGlzdGVuc0ZvcikgJiYgIWlzRW1wdHkobGlzdGVuc0ZvcltyZXN1bHQuaW50ZW50Lm5hbWVdKSkge1xuXHRcdFx0XHRcdFx0XHRyZXN1bHRUeXBlID0gbGlzdGVuc0ZvcltyZXN1bHQuaW50ZW50Lm5hbWVdLnJlc3VsdFR5cGU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRjb25zdCBhcHBFbnRyeSA9IGlzRkRDMzIgPyBtYXBUbzIwQXBwTWV0YURhdGEoYXBwLCByZXN1bHRUeXBlKSA6IG1hcFRvMTJBcHBNZXRhRGF0YShhcHApO1xuXG5cdFx0XHRcdFx0XHRyZXR1cm4gYXBwRW50cnk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzcG9uc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogSGFuZGxlIHRoZSBmaXJlZCBpbnRlbnQgZm9yIGNvbnRleHQuXG5cdFx0XHQgKiBAcGFyYW0gY29udGV4dEZvckludGVudCBUaGUgY29udGV4dCBmb3IgdGhlIGludGVudC5cblx0XHRcdCAqIEBwYXJhbSBjb250ZXh0Rm9ySW50ZW50LnR5cGUgVGhlIHR5cGUgb2YgdGhlIGludGVudC5cblx0XHRcdCAqIEBwYXJhbSBjb250ZXh0Rm9ySW50ZW50Lm1ldGFkYXRhIFRoZSBtZXRhZGF0YSBmb3IgdGhlIGludGVudC5cblx0XHRcdCAqIEBwYXJhbSBjbGllbnRJZGVudGl0eSBUaGUgY2xpZW50IGlkZW50aXR5LlxuXHRcdFx0ICogQHJldHVybnMgVGhlIGludGVudCByZXNvbHV0aW9uLlxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWMgYXN5bmMgaGFuZGxlRmlyZWRJbnRlbnRGb3JDb250ZXh0KFxuXHRcdFx0XHRjb250ZXh0Rm9ySW50ZW50OiB7IHR5cGU6IHN0cmluZzsgbWV0YWRhdGE/OiBPcGVuRmluLkludGVudE1ldGFkYXRhPEludGVudFRhcmdldE1ldGFEYXRhPiB9LFxuXHRcdFx0XHRjbGllbnRJZGVudGl0eTogT3BlbkZpbi5DbGllbnRJZGVudGl0eVxuXHRcdFx0KTogUHJvbWlzZTxPbWl0PEludGVudFJlc29sdXRpb24sIFwiZ2V0UmVzdWx0XCI+IHwgeyBzb3VyY2U6IHN0cmluZzsgdmVyc2lvbj86IHN0cmluZyB9PiB7XG5cdFx0XHRcdGNvbnN0IHRhcmdldEFwcElkZW50aWZpZXIgPSB0aGlzLmdldEFwcGxpY2F0aW9uSWRlbnRpdHkoY29udGV4dEZvckludGVudC5tZXRhZGF0YSk7XG5cdFx0XHRcdGNvbnN0IHVzZXNBcHBJZGVudGl0eSA9IHRoaXMudXNlc0FwcGxpY2F0aW9uSWRlbnRpdHkoY2xpZW50SWRlbnRpdHkpO1xuXHRcdFx0XHRjb25zdCBpbnRlbnQ6IFBhcnRpYWw8T3BlbkZpbi5JbnRlbnQgJiB7IGRpc3BsYXlOYW1lPzogc3RyaW5nIH0+ID0ge1xuXHRcdFx0XHRcdGNvbnRleHQ6IGNvbnRleHRGb3JJbnRlbnRcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRjb25zdCBpbnRlbnRzRm9yU2VsZWN0aW9uOiBBcHBzRm9ySW50ZW50W10gPSBhd2FpdCB0aGlzLl9hcHBJbnRlbnRIZWxwZXIuZ2V0SW50ZW50c0J5Q29udGV4dChcblx0XHRcdFx0XHRjb250ZXh0Rm9ySW50ZW50LnR5cGVcblx0XHRcdFx0KTtcblxuXHRcdFx0XHQvLyBhcHAgc3BlY2lmaWVkIGZsb3dcblx0XHRcdFx0aWYgKCFpc0VtcHR5KHRhcmdldEFwcElkZW50aWZpZXIpKSB7XG5cdFx0XHRcdFx0Y29uc3QgdGFyZ2V0QXBwID0gYXdhaXQgZ2V0QXBwKHRhcmdldEFwcElkZW50aWZpZXIuYXBwSWQpO1xuXG5cdFx0XHRcdFx0aWYgKGlzRW1wdHkodGFyZ2V0QXBwKSkge1xuXHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFJlc29sdmVFcnJvci5UYXJnZXRBcHBVbmF2YWlsYWJsZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChcblx0XHRcdFx0XHRcdCF0YXJnZXRBcHA/LmludGVyb3A/LmludGVudHM/Lmxpc3RlbnNGb3IgfHxcblx0XHRcdFx0XHRcdCFPYmplY3QudmFsdWVzKHRhcmdldEFwcC5pbnRlcm9wLmludGVudHMubGlzdGVuc0Zvcikuc29tZSgobGlzdGVuZWRGb3JJbnRlbnQpID0+XG5cdFx0XHRcdFx0XHRcdGxpc3RlbmVkRm9ySW50ZW50LmNvbnRleHRzLmluY2x1ZGVzKGNvbnRleHRGb3JJbnRlbnQudHlwZSlcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihSZXNvbHZlRXJyb3IuTm9BcHBzRm91bmQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRjb25zdCBpbnRlbnRSZXNvbHZlciA9IGF3YWl0IHRoaXMuaGFuZGxlVGFyZ2V0ZWRJbnRlbnQoXG5cdFx0XHRcdFx0XHR0YXJnZXRBcHBJZGVudGlmaWVyLFxuXHRcdFx0XHRcdFx0aW50ZW50IGFzIE9wZW5GaW4uSW50ZW50LFxuXHRcdFx0XHRcdFx0dHJ1ZSxcblx0XHRcdFx0XHRcdGNsaWVudElkZW50aXR5XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5zaGFwZUludGVudFJlc29sdmVyKGludGVudFJlc29sdmVyLCB1c2VzQXBwSWRlbnRpdHkpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gY2hlY2sgZm9yIHVucmVnaXN0ZXJlZCBhcHAgaW50ZW50IGhhbmRsZXJzIChpZiBlbmFibGVkKVxuXHRcdFx0XHRjb25zdCB1bnJlZ2lzdGVyZWRBcHBJbnRlbnRzID0gYXdhaXQgdGhpcy5nZXRVbnJlZ2lzdGVyZWRBcHBJbnRlbnRCeUNvbnRleHQoXG5cdFx0XHRcdFx0Y29udGV4dEZvckludGVudC50eXBlLFxuXHRcdFx0XHRcdGNsaWVudElkZW50aXR5XG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0aWYgKHVucmVnaXN0ZXJlZEFwcEludGVudHMubGVuZ3RoID4gMCAmJiAhaXNFbXB0eSh0aGlzLl91bnJlZ2lzdGVyZWRBcHApKSB7XG5cdFx0XHRcdFx0Y29uc3QgbWF0Y2hlZEludGVudHM6IHN0cmluZ1tdID0gW107XG5cdFx0XHRcdFx0Zm9yIChjb25zdCBpbnRlbnRGb3JTZWxlY3Rpb24gb2YgaW50ZW50c0ZvclNlbGVjdGlvbikge1xuXHRcdFx0XHRcdFx0aWYgKHVucmVnaXN0ZXJlZEFwcEludGVudHMuaW5jbHVkZXMoaW50ZW50Rm9yU2VsZWN0aW9uLmludGVudC5uYW1lKSkge1xuXHRcdFx0XHRcdFx0XHRpbnRlbnRGb3JTZWxlY3Rpb24uYXBwcy5wdXNoKHRoaXMuX3VucmVnaXN0ZXJlZEFwcCk7XG5cdFx0XHRcdFx0XHRcdG1hdGNoZWRJbnRlbnRzLnB1c2goaW50ZW50Rm9yU2VsZWN0aW9uLmludGVudC5uYW1lKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y29uc3QgbWlzc2luZ0ludGVudE1hdGNoZXMgPSB1bnJlZ2lzdGVyZWRBcHBJbnRlbnRzLmZpbHRlcihcblx0XHRcdFx0XHRcdChpbnRlbnROYW1lKSA9PiAhbWF0Y2hlZEludGVudHMuaW5jbHVkZXMoaW50ZW50TmFtZSlcblx0XHRcdFx0XHQpO1xuXG5cdFx0XHRcdFx0Zm9yIChjb25zdCBtaXNzaW5nSW50ZW50TWF0Y2ggb2YgbWlzc2luZ0ludGVudE1hdGNoZXMpIHtcblx0XHRcdFx0XHRcdGNvbnN0IG1pc3NpbmdJbnRlbnQgPSB0aGlzLl91bnJlZ2lzdGVyZWRBcHAuaW50ZW50cz8uZmluZChcblx0XHRcdFx0XHRcdFx0KGVudHJ5KSA9PiBlbnRyeS5uYW1lID09PSBtaXNzaW5nSW50ZW50TWF0Y2hcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRpZiAobWlzc2luZ0ludGVudCkge1xuXHRcdFx0XHRcdFx0XHRpbnRlbnRzRm9yU2VsZWN0aW9uLnB1c2goe1xuXHRcdFx0XHRcdFx0XHRcdGludGVudDogeyBuYW1lOiBtaXNzaW5nSW50ZW50Lm5hbWUsIGRpc3BsYXlOYW1lOiBtaXNzaW5nSW50ZW50LmRpc3BsYXlOYW1lIH0sXG5cdFx0XHRcdFx0XHRcdFx0YXBwczogW3RoaXMuX3VucmVnaXN0ZXJlZEFwcF1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0bGV0IHVzZXJTZWxlY3Rpb246IEludGVudFJlc29sdmVyUmVzcG9uc2UgfCB1bmRlZmluZWQ7XG5cblx0XHRcdFx0aWYgKGludGVudHNGb3JTZWxlY3Rpb24ubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdFx0Y29uc3QgaW50ZW50Rm9yU2VsZWN0aW9uID0gaW50ZW50c0ZvclNlbGVjdGlvblswXTtcblx0XHRcdFx0XHQvLyBvbmx5IG9uZSBpbnRlbnQgbWF0Y2hlcyB0aGUgcGFzc2VkIGNvbnRleHRcblx0XHRcdFx0XHRpbnRlbnQubmFtZSA9IGludGVudEZvclNlbGVjdGlvbi5pbnRlbnQubmFtZTtcblx0XHRcdFx0XHRpbnRlbnQuZGlzcGxheU5hbWUgPSBpbnRlbnRGb3JTZWxlY3Rpb24uaW50ZW50LmRpc3BsYXlOYW1lO1xuXG5cdFx0XHRcdFx0aWYgKGludGVudEZvclNlbGVjdGlvbi5hcHBzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgYXBwSW5zdGFuY2VzID0gYXdhaXQgdGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmZpbmRBcHBJbnN0YW5jZXMoXG5cdFx0XHRcdFx0XHRcdGludGVudEZvclNlbGVjdGlvbi5hcHBzWzBdLFxuXHRcdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eSxcblx0XHRcdFx0XHRcdFx0XCJpbnRlbnRcIlxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdC8vIGlmIHRoZXJlIGFyZSBubyBpbnN0YW5jZXMgbGF1bmNoIGEgbmV3IG9uZSBvdGhlcndpc2UgcHJlc2VudCB0aGUgY2hvaWNlIHRvIHRoZSB1c2VyXG5cdFx0XHRcdFx0XHQvLyBieSBmYWxsaW5nIHRocm91Z2ggdG8gdGhlIG5leHQgY29kZSBibG9ja1xuXHRcdFx0XHRcdFx0aWYgKGFwcEluc3RhbmNlcy5sZW5ndGggPT09IDAgfHwgdGhpcy5jcmVhdGVOZXdJbnN0YW5jZShpbnRlbnRGb3JTZWxlY3Rpb24uYXBwc1swXSkpIHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgaW50ZW50UmVzb2x2ZXIgPSBhd2FpdCB0aGlzLmxhdW5jaEFwcFdpdGhJbnRlbnQoXG5cdFx0XHRcdFx0XHRcdFx0aW50ZW50Rm9yU2VsZWN0aW9uLmFwcHNbMF0sXG5cdFx0XHRcdFx0XHRcdFx0aW50ZW50IGFzIE9wZW5GaW4uSW50ZW50LFxuXHRcdFx0XHRcdFx0XHRcdHVuZGVmaW5lZCxcblx0XHRcdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eVxuXHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0XHRpZiAoaXNFbXB0eShpbnRlbnRSZXNvbHZlcikpIHtcblx0XHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLk5vQXBwc0ZvdW5kKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdGhpcy5zaGFwZUludGVudFJlc29sdmVyKGludGVudFJlc29sdmVyLCB1c2VzQXBwSWRlbnRpdHkpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR1c2VyU2VsZWN0aW9uID0gYXdhaXQgdGhpcy5faW50ZW50UmVzb2x2ZXJIZWxwZXI/LmxhdW5jaEludGVudFJlc29sdmVyKFxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRhcHBzOiBpbnRlbnRzRm9yU2VsZWN0aW9uWzBdLmFwcHMsXG5cdFx0XHRcdFx0XHRcdGludGVudFxuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdGNsaWVudElkZW50aXR5XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR1c2VyU2VsZWN0aW9uID0gYXdhaXQgdGhpcy5faW50ZW50UmVzb2x2ZXJIZWxwZXI/LmxhdW5jaEludGVudFJlc29sdmVyKFxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRpbnRlbnQsXG5cdFx0XHRcdFx0XHRcdGludGVudHM6IGludGVudHNGb3JTZWxlY3Rpb25cblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gdXBkYXRlIGludGVudCB3aXRoIHVzZXIgc2VsZWN0aW9uXG5cdFx0XHRcdGlmIChpc0VtcHR5KHVzZXJTZWxlY3Rpb24pKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFJlc29sdmVFcnJvci5SZXNvbHZlclVuYXZhaWxhYmxlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpbnRlbnQuZGlzcGxheU5hbWUgPSB1c2VyU2VsZWN0aW9uLmludGVudC5kaXNwbGF5TmFtZTtcblx0XHRcdFx0aW50ZW50Lm5hbWUgPSB1c2VyU2VsZWN0aW9uLmludGVudC5uYW1lO1xuXHRcdFx0XHRjb25zdCBpbnRlbnRSZXNvbHZlciA9IGF3YWl0IHRoaXMuaGFuZGxlSW50ZW50UGlja2VyU2VsZWN0aW9uKFxuXHRcdFx0XHRcdHVzZXJTZWxlY3Rpb24sXG5cdFx0XHRcdFx0aW50ZW50IGFzIE9wZW5GaW4uSW50ZW50LFxuXHRcdFx0XHRcdGNsaWVudElkZW50aXR5XG5cdFx0XHRcdCk7XG5cdFx0XHRcdHJldHVybiB0aGlzLnNoYXBlSW50ZW50UmVzb2x2ZXIoaW50ZW50UmVzb2x2ZXIsIHVzZXNBcHBJZGVudGl0eSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogSGFuZGxlIGEgZmlyZWQgaW50ZW50LlxuXHRcdFx0ICogQHBhcmFtIGludGVudCBUaGUgaW50ZW50IHRvIGhhbmRsZS5cblx0XHRcdCAqIEBwYXJhbSBjbGllbnRJZGVudGl0eSBUaGUgY2xpZW50IGlkZW50aXR5LlxuXHRcdFx0ICogQHJldHVybnMgVGhlIGludGVudCByZXNvbHV0aW9uLlxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWMgYXN5bmMgaGFuZGxlRmlyZWRJbnRlbnQoXG5cdFx0XHRcdGludGVudDogT3BlbkZpbi5JbnRlbnQ8T3BlbkZpbi5JbnRlbnRNZXRhZGF0YTxJbnRlbnRUYXJnZXRNZXRhRGF0YT4+LFxuXHRcdFx0XHRjbGllbnRJZGVudGl0eTogT3BlbkZpbi5DbGllbnRJZGVudGl0eVxuXHRcdFx0KTogUHJvbWlzZTxPbWl0PEludGVudFJlc29sdXRpb24sIFwiZ2V0UmVzdWx0XCI+IHwgeyBzb3VyY2U6IHN0cmluZzsgdmVyc2lvbj86IHN0cmluZyB9PiB7XG5cdFx0XHRcdGxvZ2dlci5pbmZvKFwiUmVjZWl2ZWQgcmVxdWVzdCBmb3IgYSByYWlzZWQgaW50ZW50XCIsIGludGVudCk7XG5cdFx0XHRcdGNvbnN0IHRhcmdldEFwcElkZW50aWZpZXIgPSB0aGlzLmdldEFwcGxpY2F0aW9uSWRlbnRpdHkoaW50ZW50Lm1ldGFkYXRhKTtcblx0XHRcdFx0Y29uc3QgdXNlc0FwcElkZW50aWZpZXIgPSB0aGlzLnVzZXNBcHBsaWNhdGlvbklkZW50aXR5KGNsaWVudElkZW50aXR5KTtcblxuXHRcdFx0XHRjb25zdCBtYXRjaGVkSW50ZW50cyA9IGF3YWl0IHRoaXMuX2FwcEludGVudEhlbHBlci5nZXRJbnRlbnQoaW50ZW50Lm5hbWUsIGludGVudD8uY29udGV4dD8udHlwZSk7XG5cdFx0XHRcdGNvbnN0IGludGVudEFwcHM6IFBsYXRmb3JtQXBwW10gPSBbXTtcblxuXHRcdFx0XHRpZiAoIWlzRW1wdHkobWF0Y2hlZEludGVudHMpKSB7XG5cdFx0XHRcdFx0aW50ZW50QXBwcy5wdXNoKC4uLm1hdGNoZWRJbnRlbnRzLmFwcHMpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghaXNFbXB0eSh0YXJnZXRBcHBJZGVudGlmaWVyKSkge1xuXHRcdFx0XHRcdGNvbnN0IHRhcmdldEFwcCA9IGF3YWl0IGdldEFwcCh0YXJnZXRBcHBJZGVudGlmaWVyLmFwcElkKTtcblx0XHRcdFx0XHRpZiAoaXNFbXB0eSh0YXJnZXRBcHApKSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLlRhcmdldEFwcFVuYXZhaWxhYmxlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Ly8gZW5zdXJlIHRoYXQgdGhlIHNwZWNpZmllZCBhcHAgaXMgb25lIG9mIHRoZSBpbnRlbnQgYXBwc1xuXHRcdFx0XHRcdGlmICghaW50ZW50QXBwcy5zb21lKChhcHApID0+IGFwcC5hcHBJZCA9PT0gdGFyZ2V0QXBwSWRlbnRpZmllci5hcHBJZCkpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihSZXNvbHZlRXJyb3IuTm9BcHBzRm91bmQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRjb25zdCBpbnRlbnRSZXNvbHZlciA9IGF3YWl0IHRoaXMuaGFuZGxlVGFyZ2V0ZWRJbnRlbnQoXG5cdFx0XHRcdFx0XHR0YXJnZXRBcHBJZGVudGlmaWVyLFxuXHRcdFx0XHRcdFx0aW50ZW50LFxuXHRcdFx0XHRcdFx0ZmFsc2UsXG5cdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuc2hhcGVJbnRlbnRSZXNvbHZlcihpbnRlbnRSZXNvbHZlciwgdXNlc0FwcElkZW50aWZpZXIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdHRoaXMuX3VucmVnaXN0ZXJlZEFwcCAmJlxuXHRcdFx0XHRcdChhd2FpdCB0aGlzLmNhbkFkZFVucmVnaXN0ZXJlZEFwcChjbGllbnRJZGVudGl0eSwgaW50ZW50Lm5hbWUsIGludGVudD8uY29udGV4dD8udHlwZSkpXG5cdFx0XHRcdCkge1xuXHRcdFx0XHRcdC8vIFdlIGhhdmUgdW5yZWdpc3RlcmVkIGFwcCBpbnN0YW5jZXMgdGhhdCBzdXBwb3J0IHRoaXMgaW50ZW50IGFuZCBzdXBwb3J0IGZvciB1bnJlZ2lzdGVyZWQgaW5zdGFuY2VzIGlzIGVuYWJsZWRcblx0XHRcdFx0XHRpbnRlbnRBcHBzLnB1c2godGhpcy5fdW5yZWdpc3RlcmVkQXBwKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChpbnRlbnRBcHBzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdGxvZ2dlci5pbmZvKFwiTm8gYXBwcyBzdXBwb3J0IHRoaXMgaW50ZW50XCIpO1xuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihSZXNvbHZlRXJyb3IuTm9BcHBzRm91bmQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGludGVudEFwcHMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdFx0Ly8gaGFuZGxlIHNpbmdsZSBlbnRyeVxuXHRcdFx0XHRcdGNvbnN0IGFwcEluc3RhbmNlcyA9IGF3YWl0IHRoaXMuX2NsaWVudFJlZ2lzdHJhdGlvbkhlbHBlci5maW5kQXBwSW5zdGFuY2VzKFxuXHRcdFx0XHRcdFx0aW50ZW50QXBwc1swXSxcblx0XHRcdFx0XHRcdGNsaWVudElkZW50aXR5LFxuXHRcdFx0XHRcdFx0XCJpbnRlbnRcIlxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0Ly8gaWYgdGhlcmUgYXJlIG5vIGluc3RhbmNlcyBsYXVuY2ggYSBuZXcgb25lIG90aGVyd2lzZSBwcmVzZW50IHRoZSBjaG9pY2UgdG8gdGhlIHVzZXJcblx0XHRcdFx0XHQvLyBieSBmYWxsaW5nIHRocm91Z2ggdG8gdGhlIG5leHQgY29kZSBibG9ja1xuXHRcdFx0XHRcdGxldCBhcHBJbnN0YW5jZUlkOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0aWYgKGFwcEluc3RhbmNlcy5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0XHRcdGFwcEluc3RhbmNlSWQgPSBhcHBJbnN0YW5jZXNbMF0uaW5zdGFuY2VJZDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdFx0YXBwSW5zdGFuY2VzLmxlbmd0aCA9PT0gMCB8fFxuXHRcdFx0XHRcdFx0dGhpcy51c2VTaW5nbGVJbnN0YW5jZShpbnRlbnRBcHBzWzBdKSB8fFxuXHRcdFx0XHRcdFx0dGhpcy5jcmVhdGVOZXdJbnN0YW5jZShpbnRlbnRBcHBzWzBdKVxuXHRcdFx0XHRcdCkge1xuXHRcdFx0XHRcdFx0Y29uc3QgaW50ZW50UmVzb2x2ZXIgPSBhd2FpdCB0aGlzLmxhdW5jaEFwcFdpdGhJbnRlbnQoXG5cdFx0XHRcdFx0XHRcdGludGVudEFwcHNbMF0sXG5cdFx0XHRcdFx0XHRcdGludGVudCxcblx0XHRcdFx0XHRcdFx0YXBwSW5zdGFuY2VJZCxcblx0XHRcdFx0XHRcdFx0Y2xpZW50SWRlbnRpdHlcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRpZiAoaXNFbXB0eShpbnRlbnRSZXNvbHZlcikpIHtcblx0XHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFJlc29sdmVFcnJvci5Ob0FwcHNGb3VuZCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRyZXR1cm4gdGhpcy5zaGFwZUludGVudFJlc29sdmVyKGludGVudFJlc29sdmVyLCB1c2VzQXBwSWRlbnRpZmllcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgdXNlclNlbGVjdGlvbiA9IGF3YWl0IHRoaXMuX2ludGVudFJlc29sdmVySGVscGVyPy5sYXVuY2hJbnRlbnRSZXNvbHZlcihcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRhcHBzOiBpbnRlbnRBcHBzLFxuXHRcdFx0XHRcdFx0aW50ZW50XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRjbGllbnRJZGVudGl0eVxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdGlmIChpc0VtcHR5KHVzZXJTZWxlY3Rpb24pKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFJlc29sdmVFcnJvci5SZXNvbHZlclVuYXZhaWxhYmxlKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGludGVudFJlc29sdmVyID0gYXdhaXQgdGhpcy5oYW5kbGVJbnRlbnRQaWNrZXJTZWxlY3Rpb24odXNlclNlbGVjdGlvbiwgaW50ZW50LCBjbGllbnRJZGVudGl0eSk7XG5cdFx0XHRcdHJldHVybiB0aGlzLnNoYXBlSW50ZW50UmVzb2x2ZXIoaW50ZW50UmVzb2x2ZXIsIHVzZXNBcHBJZGVudGlmaWVyKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBJbnZva2UgdGhlIGludGVudCBoYW5kbGVyLlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgaWRlbnRpdHkuXG5cdFx0XHQgKiBAcGFyYW0gaGFuZGxlcklkIFRoZSBoYW5kbGVyIElELlxuXHRcdFx0ICogQHBhcmFtIGludGVudCBUaGUgaW50ZW50IHRvIGludm9rZS5cblx0XHRcdCAqIEByZXR1cm5zIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gdGhlIGludGVudCBoYW5kbGVyIGlzIGludm9rZWQuXG5cdFx0XHQgKi9cblx0XHRcdHB1YmxpYyBhc3luYyBpbnZva2VJbnRlbnRIYW5kbGVyKFxuXHRcdFx0XHRjbGllbnRJZGVudGl0eTogT3BlbkZpbi5DbGllbnRJZGVudGl0eSxcblx0XHRcdFx0aGFuZGxlcklkOiBzdHJpbmcsXG5cdFx0XHRcdGludGVudDogT3BlbkZpbi5JbnRlbnRcblx0XHRcdCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdFx0XHRjb25zdCB7IGNvbnRleHQgfSA9IGludGVudDtcblx0XHRcdFx0bGV0IGNvbnRleHRNZXRhZGF0YTogQ29udGV4dE1ldGFkYXRhIHwgdW5kZWZpbmVkO1xuXHRcdFx0XHRsZXQgcGFzc2VkQ29udGV4dDogeyBba2V5OiBzdHJpbmddOiB1bmtub3duIH0gfCB1bmRlZmluZWQ7XG5cdFx0XHRcdGlmICghaXNFbXB0eShjb250ZXh0KSkge1xuXHRcdFx0XHRcdHBhc3NlZENvbnRleHQgPSB7IC4uLmNvbnRleHQgfTtcblx0XHRcdFx0XHRjb250ZXh0TWV0YWRhdGEgPSBwYXNzZWRDb250ZXh0W3RoaXMuX21ldGFkYXRhS2V5XSBhcyBDb250ZXh0TWV0YWRhdGE7XG5cdFx0XHRcdFx0aWYgKCFpc0VtcHR5KGNvbnRleHRNZXRhZGF0YSkpIHtcblx0XHRcdFx0XHRcdGRlbGV0ZSBwYXNzZWRDb250ZXh0W3RoaXMuX21ldGFkYXRhS2V5XTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHN1cGVyLmludm9rZUludGVudEhhbmRsZXIoY2xpZW50SWRlbnRpdHksIGhhbmRsZXJJZCwge1xuXHRcdFx0XHRcdC4uLmludGVudCxcblx0XHRcdFx0XHRjb250ZXh0OiB7XG5cdFx0XHRcdFx0XHQuLi5wYXNzZWRDb250ZXh0LFxuXHRcdFx0XHRcdFx0Y29udGV4dE1ldGFkYXRhXG5cdFx0XHRcdFx0fSBhcyB1bmtub3duIGFzIE9wZW5GaW4uQ29udGV4dFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBIYW5kbGUgdGhlIEZEQzMgb3Blbi5cblx0XHRcdCAqIEBwYXJhbSBmZGMzT3Blbk9wdGlvbnMgVGhlIG9wdGlvbnMgZm9yIHRoZSBvcGVuLlxuXHRcdFx0ICogQHBhcmFtIGZkYzNPcGVuT3B0aW9ucy5hcHAgVGhlIHBsYXRmb3JtIGFwcCBvciBpdHMgaWQuXG5cdFx0XHQgKiBAcGFyYW0gZmRjM09wZW5PcHRpb25zLmNvbnRleHQgVGhlIGNvbnRleHQgYmVpbmcgb3BlbmVkLlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgaWRlbnRpdHkuXG5cdFx0XHQgKiBAcmV0dXJucyBUaGUgYXBwbGljYXRpb24gaWRlbnRpZmllci5cblx0XHRcdCAqL1xuXHRcdFx0cHVibGljIGFzeW5jIGZkYzNIYW5kbGVPcGVuKFxuXHRcdFx0XHRmZGMzT3Blbk9wdGlvbnM6IHsgYXBwOiAoUGxhdGZvcm1BcHAgJiBBcHBJZGVudGlmaWVyKSB8IHN0cmluZzsgY29udGV4dDogT3BlbkZpbi5Db250ZXh0IH0sXG5cdFx0XHRcdGNsaWVudElkZW50aXR5OiBPcGVuRmluLkNsaWVudElkZW50aXR5XG5cdFx0XHQpOiBQcm9taXNlPEFwcElkZW50aWZpZXI+IHtcblx0XHRcdFx0aWYgKGlzRW1wdHkoZmRjM09wZW5PcHRpb25zPy5hcHApKSB7XG5cdFx0XHRcdFx0bG9nZ2VyLmVycm9yKFwiQSByZXF1ZXN0IHRvIGZkYzMub3BlbiBkaWQgbm90IHBhc3MgYW4gZmRjM09wZW5PcHRpb25zIG9iamVjdFwiKTtcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLk5vQXBwc0ZvdW5kKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGxvZ2dlci5pbmZvKFxuXHRcdFx0XHRcdGBBIHJlcXVlc3QgdG8gT3BlbiBoYXMgYmVlbiBzZW50IHRvIHRoZSBwbGF0Zm9ybSBieSB1dWlkOiAke2NsaWVudElkZW50aXR5Py51dWlkfSwgbmFtZTogJHtjbGllbnRJZGVudGl0eT8ubmFtZX0sIGVuZHBvaW50SWQ6ICR7Y2xpZW50SWRlbnRpdHkuZW5kcG9pbnRJZH0gd2l0aCBwYXNzZWQgY29udGV4dDpgLFxuXHRcdFx0XHRcdGZkYzNPcGVuT3B0aW9ucy5jb250ZXh0XG5cdFx0XHRcdCk7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0bGV0IHJlcXVlc3RlZElkOiBzdHJpbmc7XG5cdFx0XHRcdFx0bGV0IGluc3RhbmNlSWQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRsZXQgcGxhdGZvcm1JZGVudGl0aWVzOiBQbGF0Zm9ybUFwcElkZW50aWZpZXJbXSB8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRsZXQgZm9jdXNBcHAgPSBmYWxzZTtcblx0XHRcdFx0XHRsZXQgYXBwSWQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuXHRcdFx0XHRcdGlmIChpc1N0cmluZyhmZGMzT3Blbk9wdGlvbnMuYXBwKSkge1xuXHRcdFx0XHRcdFx0cmVxdWVzdGVkSWQgPSBmZGMzT3Blbk9wdGlvbnMuYXBwO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRyZXF1ZXN0ZWRJZCA9IGZkYzNPcGVuT3B0aW9ucy5hcHAuYXBwSWQgPz8gZmRjM09wZW5PcHRpb25zLmFwcC5uYW1lO1xuXHRcdFx0XHRcdFx0aW5zdGFuY2VJZCA9IGZkYzNPcGVuT3B0aW9ucy5hcHAuaW5zdGFuY2VJZDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRjb25zdCByZXF1ZXN0ZWRBcHAgPSBhd2FpdCBnZXRBcHAocmVxdWVzdGVkSWQpO1xuXHRcdFx0XHRcdGlmIChpc0VtcHR5KHJlcXVlc3RlZEFwcCkpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihPcGVuRXJyb3IuQXBwTm90Rm91bmQpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICghaXNFbXB0eShpbnN0YW5jZUlkKSkge1xuXHRcdFx0XHRcdFx0Ly8gYW4gaW5zdGFuY2Ugb2YgYW4gYXBwbGljYXRpb24gd2FzIHNlbGVjdGVkIG5vdyBsb29rIHVwIHRoZSB1dWlkIGFuZCBuYW1lXG5cdFx0XHRcdFx0XHRjb25zdCBhbGxDb25uZWN0ZWRDbGllbnRzID0gYXdhaXQgdGhpcy5nZXRBbGxDbGllbnRJbmZvKCk7XG5cdFx0XHRcdFx0XHRjb25zdCBjbGllbnRJbmZvID0gYWxsQ29ubmVjdGVkQ2xpZW50cy5maW5kKFxuXHRcdFx0XHRcdFx0XHQoY29ubmVjdGVkQ2xpZW50KSA9PiBjb25uZWN0ZWRDbGllbnQuZW5kcG9pbnRJZCA9PT0gaW5zdGFuY2VJZFxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdGlmICghaXNFbXB0eShjbGllbnRJbmZvKSkge1xuXHRcdFx0XHRcdFx0XHRsb2dnZXIuaW5mbyhgQXBwIElkOiAke3JlcXVlc3RlZElkfSBhbmQgaW5zdGFuY2UgSWQ6ICR7aW5zdGFuY2VJZH0gd2FzIHByb3ZpZGVkIGFuZCBmb3VuZC5gKTtcblx0XHRcdFx0XHRcdFx0Ly8gdGhlIGNvbm5lY3RlZCBpbnN0YW5jZSBpcyBhdmFpbGFibGVcblx0XHRcdFx0XHRcdFx0cGxhdGZvcm1JZGVudGl0aWVzID0gW1xuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdHV1aWQ6IGNsaWVudEluZm8udXVpZCxcblx0XHRcdFx0XHRcdFx0XHRcdG5hbWU6IGNsaWVudEluZm8ubmFtZSxcblx0XHRcdFx0XHRcdFx0XHRcdGFwcElkOiByZXF1ZXN0ZWRJZCxcblx0XHRcdFx0XHRcdFx0XHRcdGluc3RhbmNlSWRcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdF07XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLlRhcmdldEluc3RhbmNlVW5hdmFpbGFibGUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGNvbnN0IGlzT3BlbkJ5SW50ZW50ID0gdGhpcy5fb3Blbk9wdGlvbnM/Lm9wZW5TdHJhdGVneSA9PT0gXCJpbnRlbnRcIjtcblxuXHRcdFx0XHRcdGlmIChpc09wZW5CeUludGVudCkge1xuXHRcdFx0XHRcdFx0Y29uc3Qgb3BlbkFwcEludGVudDogT3BlbkZpbi5JbnRlbnQgPSB7XG5cdFx0XHRcdFx0XHRcdGNvbnRleHQ6IGZkYzNPcGVuT3B0aW9ucy5jb250ZXh0LFxuXHRcdFx0XHRcdFx0XHRuYW1lOiBcIk9wZW5BcHBcIixcblx0XHRcdFx0XHRcdFx0bWV0YWRhdGE6IHtcblx0XHRcdFx0XHRcdFx0XHR0YXJnZXQ6IHsgYXBwSWQ6IHJlcXVlc3RlZElkIH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubGF1bmNoQXBwV2l0aEludGVudChcblx0XHRcdFx0XHRcdFx0cmVxdWVzdGVkQXBwLFxuXHRcdFx0XHRcdFx0XHRvcGVuQXBwSW50ZW50LFxuXHRcdFx0XHRcdFx0XHRpbnN0YW5jZUlkLFxuXHRcdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdGlmIChpc1N0cmluZyhyZXN1bHQuc291cmNlKSkge1xuXHRcdFx0XHRcdFx0XHRhcHBJZCA9IHJlc3VsdC5zb3VyY2U7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRhcHBJZCA9IHJlc3VsdC5zb3VyY2UuYXBwSWQ7XG5cdFx0XHRcdFx0XHRcdGluc3RhbmNlSWQgPSByZXN1bHQuc291cmNlLmluc3RhbmNlSWQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGlmIChpc0VtcHR5KHBsYXRmb3JtSWRlbnRpdGllcykpIHtcblx0XHRcdFx0XHRcdFx0bGV0IGxhdW5jaFByZWZlcmVuY2U6IExhdW5jaFByZWZlcmVuY2UgfCB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGJvdW5kcyA9IGF3YWl0IGdldFdpbmRvd1Bvc2l0aW9uVXNpbmdTdHJhdGVneShcblx0XHRcdFx0XHRcdFx0XHRvcHRpb25zLndpbmRvd1Bvc2l0aW9uT3B0aW9ucyxcblx0XHRcdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eVxuXHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0XHRpZiAoIWlzRW1wdHkoYm91bmRzKSkge1xuXHRcdFx0XHRcdFx0XHRcdGxhdW5jaFByZWZlcmVuY2UgPSB7IGJvdW5kcyB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHBsYXRmb3JtSWRlbnRpdGllcyA9IGF3YWl0IGxhdW5jaChyZXF1ZXN0ZWRBcHA/LmFwcElkLCBsYXVuY2hQcmVmZXJlbmNlKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGZvY3VzQXBwID0gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKCFpc0VtcHR5KHBsYXRmb3JtSWRlbnRpdGllcykgJiYgcGxhdGZvcm1JZGVudGl0aWVzPy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdGFwcElkID0gcGxhdGZvcm1JZGVudGl0aWVzWzBdLmFwcElkO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBvcGVuVGltZW91dDogbnVtYmVyIHwgdW5kZWZpbmVkID0gdGhpcy5fb3Blbk9wdGlvbnM/LmNvbm5lY3Rpb25UaW1lb3V0O1xuXHRcdFx0XHRcdFx0XHQvLyBpZiB3ZSBoYXZlIGEgc25hcHNob3QgYW5kIG11bHRpcGxlIGlkZW50aXRpZXMgd2Ugd2lsbCBub3Qgd2FpdCBhcyBub3QgYWxsIG9mIHRoZW0gbWlnaHQgbm90IHN1cHBvcnQgaW50ZW50cy5cblx0XHRcdFx0XHRcdFx0aW5zdGFuY2VJZCA9IGF3YWl0IHRoaXMuX2NsaWVudFJlZ2lzdHJhdGlvbkhlbHBlci5vbkNvbm5lY3Rpb25DbGllbnRSZWFkeShcblx0XHRcdFx0XHRcdFx0XHRwbGF0Zm9ybUlkZW50aXRpZXNbMF0sXG5cdFx0XHRcdFx0XHRcdFx0b3BlblRpbWVvdXRcblx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0aWYgKHBsYXRmb3JtSWRlbnRpdGllcy5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdFx0XHRcdFx0bG9nZ2VyLndhcm4oXG5cdFx0XHRcdFx0XHRcdFx0XHRcIk9wZW4gY2FuIG9ubHkgcmV0dXJuIG9uZSBhcHAgYW5kIGluc3RhbmNlIGlkIGFuZCBtdWx0aXBsZSBpbnN0YW5jZXMgd2VyZSBsYXVuY2hlZCBhcyBhIHJlc3VsdC4gUmV0dXJuaW5nIHRoZSBmaXJzdCBpbnN0YW5jZS4gUmV0dXJuZWQgaW5zdGFuY2VzOiBcIixcblx0XHRcdFx0XHRcdFx0XHRcdHBsYXRmb3JtSWRlbnRpdGllc1xuXHRcdFx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKCFpc0VtcHR5KGZkYzNPcGVuT3B0aW9ucz8uY29udGV4dCkpIHtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBjb250ZXh0VGltZW91dDogbnVtYmVyIHwgdW5kZWZpbmVkID0gb3B0aW9ucz8uaW50ZW50T3B0aW9ucz8uaW50ZW50VGltZW91dDtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBjb250ZXh0VHlwZU5hbWUgPSBmZGMzT3Blbk9wdGlvbnMuY29udGV4dC50eXBlO1xuXHRcdFx0XHRcdFx0XHRcdC8vIGlmIHdlIGhhdmUgYSBzbmFwc2hvdCBhbmQgbXVsdGlwbGUgaWRlbnRpdGllcyB3ZSB3aWxsIG5vdCB3YWl0IGFzIG5vdCBhbGwgb2YgdGhlbSBtaWdodCBub3Qgc3VwcG9ydCBpbnRlbnRzLlxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNsaWVudFJlYWR5SW5zdGFuY2VJZCA9IGF3YWl0IHRoaXMuX2NsaWVudFJlZ2lzdHJhdGlvbkhlbHBlci5vbkNvbnRleHRDbGllbnRSZWFkeShcblx0XHRcdFx0XHRcdFx0XHRcdHBsYXRmb3JtSWRlbnRpdGllc1swXSxcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnRleHRUeXBlTmFtZSxcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnRleHRUaW1lb3V0XG5cdFx0XHRcdFx0XHRcdFx0KTtcblxuXHRcdFx0XHRcdFx0XHRcdGxldCB0cmFja2VkSGFuZGxlciA9IHRoaXMuX2NsaWVudFJlZ2lzdHJhdGlvbkhlbHBlci5nZXRSZWdpc3RlcmVkQ29udGV4dEhhbmRsZXIoXG5cdFx0XHRcdFx0XHRcdFx0XHRjb250ZXh0VHlwZU5hbWUsXG5cdFx0XHRcdFx0XHRcdFx0XHRjbGllbnRSZWFkeUluc3RhbmNlSWRcblx0XHRcdFx0XHRcdFx0XHQpO1xuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGlzRW1wdHkodHJhY2tlZEhhbmRsZXIpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0cmFja2VkSGFuZGxlciA9IHRoaXMuX2NsaWVudFJlZ2lzdHJhdGlvbkhlbHBlci5nZXRSZWdpc3RlcmVkQ29udGV4dEhhbmRsZXIoXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFwiKlwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjbGllbnRSZWFkeUluc3RhbmNlSWRcblx0XHRcdFx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCFpc0VtcHR5KHRyYWNrZWRIYW5kbGVyKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgY29udGV4dFRvUGFzcyA9IGF3YWl0IHRoaXMucHJvY2Vzc0NvbnRleHQoZmRjM09wZW5PcHRpb25zLmNvbnRleHQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgY29udGV4dE1ldGFkYXRhID0gYXdhaXQgdGhpcy5nZXRDb250ZXh0TWV0YWRhdGEoY2xpZW50SWRlbnRpdHkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgdXBkYXRlZENvbnRleHQ6IE9wZW5GaW4uQ29udGV4dCA9IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Li4uY29udGV4dFRvUGFzcyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0W3RoaXMuX21ldGFkYXRhS2V5XTogY29udGV4dE1ldGFkYXRhXG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5pbnZva2VDb250ZXh0SGFuZGxlcihcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHJhY2tlZEhhbmRsZXIuY2xpZW50SWRlbnRpdHksXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyYWNrZWRIYW5kbGVyLmhhbmRsZXJJZCxcblx0XHRcdFx0XHRcdFx0XHRcdFx0dXBkYXRlZENvbnRleHRcblx0XHRcdFx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdGxvZ2dlci53YXJuKFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRgVW5hYmxlIHRvIHNlbmQgY29udGV4dCBvZiB0eXBlICR7Y29udGV4dFR5cGVOYW1lfSBvcGVuZWQgYXBwICR7YXBwSWR9IHdpdGggaW5zdGFuY2VJZCBvZiAke2NsaWVudFJlYWR5SW5zdGFuY2VJZH0gYXMgd2UgY2Fubm90IGZpbmQgYSB0cmFja2VkIGNvbnRleHQgaGFuZGxlci5gXG5cdFx0XHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICghaXNFbXB0eShhcHBJZCkpIHtcblx0XHRcdFx0XHRcdGlmIChmb2N1c0FwcCAmJiAhaXNFbXB0eShwbGF0Zm9ybUlkZW50aXRpZXMpICYmICFpc0VtcHR5KGhlbHBlcnM/LmJyaW5nQXBwVG9Gcm9udCkpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgaGVscGVycy5icmluZ0FwcFRvRnJvbnQocmVxdWVzdGVkQXBwLCBwbGF0Zm9ybUlkZW50aXRpZXMpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIHsgYXBwSWQsIGluc3RhbmNlSWQgfTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBpZiBubyBpZCByZXR1cm5lZCB0aGVuIHRoZSBsaWtlbGlob29kIGlzIHRoYXQgdGhlcmUgd2FzIGEgcHJvYmxlbSBsYXVuY2hpbmcgdGhlIGFwcGxpY2F0aW9uIGFzIGEgcmVzdWx0IG9mIHRoZSBvcGVuIHJlcXVlc3QuXG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKE9wZW5FcnJvci5FcnJvck9uTGF1bmNoKTtcblx0XHRcdFx0fSBjYXRjaCAob3BlbkVycm9yKSB7XG5cdFx0XHRcdFx0Y29uc3QgZXJyb3IgPSBmb3JtYXRFcnJvcihvcGVuRXJyb3IpO1xuXHRcdFx0XHRcdGlmIChcblx0XHRcdFx0XHRcdGVycm9yID09PSBSZXNvbHZlRXJyb3IuVGFyZ2V0SW5zdGFuY2VVbmF2YWlsYWJsZSB8fFxuXHRcdFx0XHRcdFx0ZXJyb3IgPT09IFJlc29sdmVFcnJvci5JbnRlbnREZWxpdmVyeUZhaWxlZCB8fFxuXHRcdFx0XHRcdFx0ZXJyb3IgPT09IFJlc29sdmVFcnJvci5UYXJnZXRJbnN0YW5jZVVuYXZhaWxhYmxlIHx8XG5cdFx0XHRcdFx0XHRlcnJvciA9PT0gT3BlbkVycm9yLkFwcFRpbWVvdXRcblx0XHRcdFx0XHQpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihPcGVuRXJyb3IuQXBwVGltZW91dCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRocm93IG9wZW5FcnJvcjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFRoZSBjbGllbnQgaGFzIGRpc2Nvbm5lY3RlZCBmb3JtIHRoZSBicm9rZXIuXG5cdFx0XHQgKiBAcGFyYW0gY2xpZW50SWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIHRoZSBjbGllbnQgdGhhdCBkaXNjb25uZWN0ZWQuXG5cdFx0XHQgKi9cblx0XHRcdHB1YmxpYyBhc3luYyBjbGllbnREaXNjb25uZWN0ZWQoY2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHkpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmNsaWVudERpc2Nvbm5lY3RlZChjbGllbnRJZGVudGl0eSk7XG5cdFx0XHRcdGF3YWl0IHN1cGVyLmNsaWVudERpc2Nvbm5lY3RlZChjbGllbnRJZGVudGl0eSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogSGFuZGxlIEZEQzMgZmluZCBpbnN0YW5jZXMuXG5cdFx0XHQgKiBAcGFyYW0gYXBwIFRoZSBhcHAgaWRlbnRpZmllciB0byBmaW5kLlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgaWRlbnRpdHkuXG5cdFx0XHQgKiBAcmV0dXJucyBUaGUgaW5zdGFuY2Ugb2YgdGhlIGFwcC5cblx0XHRcdCAqL1xuXHRcdFx0cHVibGljIGFzeW5jIGZkYzNIYW5kbGVGaW5kSW5zdGFuY2VzKFxuXHRcdFx0XHRhcHA6IEFwcElkZW50aWZpZXIsXG5cdFx0XHRcdGNsaWVudElkZW50aXR5OiBPcGVuRmluLkNsaWVudElkZW50aXR5XG5cdFx0XHQpOiBQcm9taXNlPEFwcElkZW50aWZpZXJbXT4ge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmZpbmRBcHBJbnN0YW5jZXMoYXBwLCBjbGllbnRJZGVudGl0eSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogSGFuZGxlIHJlcXVlc3QgdG8gZ2V0IEZEQzMgYXBwIG1ldGFkYXRhLlxuXHRcdFx0ICogQHBhcmFtIGFwcCBUaGUgYXBwIHRvIGdldCB0aGUgbWV0YWRhdGEgZm9yLlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgaWRlbnRpdHkuXG5cdFx0XHQgKiBAcmV0dXJucyBUaGUgYXBwIG1ldGFkYXRhLlxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWMgYXN5bmMgZmRjM0hhbmRsZUdldEFwcE1ldGFkYXRhKFxuXHRcdFx0XHRhcHA6IEFwcElkZW50aWZpZXIsXG5cdFx0XHRcdGNsaWVudElkZW50aXR5OiBPcGVuRmluLkNsaWVudElkZW50aXR5XG5cdFx0XHQpOiBQcm9taXNlPEFwcE1ldGFkYXRhPiB7XG5cdFx0XHRcdGxvZ2dlci5pbmZvKFwiZmRjM0hhbmRsZUdldEFwcE1ldGFkYXRhIGNhbGwgcmVjZWl2ZWQuXCIsIGFwcCwgY2xpZW50SWRlbnRpdHkpO1xuXHRcdFx0XHQvLyB0aGlzIHdpbGwgb25seSBiZSBjYWxsZWQgYnkgRkRDMyAyLjArXG5cdFx0XHRcdGxldCBwbGF0Zm9ybUFwcCA9IGF3YWl0IGdldEFwcChhcHAuYXBwSWQpO1xuXHRcdFx0XHRpZiAoaXNFbXB0eShwbGF0Zm9ybUFwcCkgJiYgYXBwLmFwcElkID09PSB0aGlzLl91bnJlZ2lzdGVyZWRBcHA/LmFwcElkKSB7XG5cdFx0XHRcdFx0cGxhdGZvcm1BcHAgPSB0aGlzLl91bnJlZ2lzdGVyZWRBcHA7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCFpc0VtcHR5KHBsYXRmb3JtQXBwKSkge1xuXHRcdFx0XHRcdGNvbnN0IGFwcE1ldGFEYXRhOiBBcHBNZXRhZGF0YSA9IG1hcFRvMjBBcHBNZXRhRGF0YShwbGF0Zm9ybUFwcCk7XG5cdFx0XHRcdFx0aWYgKCFpc0VtcHR5KGFwcC5pbnN0YW5jZUlkKSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgYWxsQ29ubmVjdGVkQ2xpZW50cyA9IGF3YWl0IHRoaXMuZ2V0QWxsQ2xpZW50SW5mbygpO1xuXHRcdFx0XHRcdFx0Y29uc3QgY29ubmVjdGVkQ2xpZW50ID0gYWxsQ29ubmVjdGVkQ2xpZW50cy5maW5kKFxuXHRcdFx0XHRcdFx0XHQoY2xpZW50KSA9PiBjbGllbnQuZW5kcG9pbnRJZCA9PT0gYXBwLmluc3RhbmNlSWRcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRpZiAoIWlzRW1wdHkoY29ubmVjdGVkQ2xpZW50KSAmJiBjb25uZWN0ZWRDbGllbnQudXVpZCA9PT0gZmluLm1lLmlkZW50aXR5LnV1aWQpIHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgaWRlbnRpdHkgPSB7IHV1aWQ6IGNvbm5lY3RlZENsaWVudC51dWlkLCBuYW1lOiBjb25uZWN0ZWRDbGllbnQubmFtZSB9O1xuXHRcdFx0XHRcdFx0XHRsZXQgdGl0bGU6IHN0cmluZyB8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdFx0bGV0IHByZXZpZXc6IHN0cmluZyB8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoY29ubmVjdGVkQ2xpZW50LmVudGl0eVR5cGUgPT09IFwid2luZG93XCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGluc3RhbmNlV2luZG93ID0gZmluLldpbmRvdy53cmFwU3luYyhpZGVudGl0eSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBpc1Zpc2libGVVc2VyV2luZG93ID0gYXdhaXQgaW5zdGFuY2VXaW5kb3cuaXNTaG93aW5nKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoaXNWaXNpYmxlVXNlcldpbmRvdykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zdCB3aW5kb3dJbmZvID0gYXdhaXQgaW5zdGFuY2VXaW5kb3cuZ2V0SW5mbygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aXRsZSA9IHdpbmRvd0luZm8udGl0bGU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHByZXZpZXcgPSBhd2FpdCB0aGlzLmdldFByZXZpZXdJbWFnZShpbnN0YW5jZVdpbmRvdyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGluc3RhbmNlVmlldyA9IGZpbi5WaWV3LndyYXBTeW5jKGlkZW50aXR5KTtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IHZpZXdJbmZvID0gYXdhaXQgaW5zdGFuY2VWaWV3LmdldEluZm8oKTtcblx0XHRcdFx0XHRcdFx0XHRcdHRpdGxlID0gdmlld0luZm8udGl0bGU7XG5cdFx0XHRcdFx0XHRcdFx0XHRwcmV2aWV3ID0gYXdhaXQgdGhpcy5nZXRQcmV2aWV3SW1hZ2UoaW5zdGFuY2VWaWV3KTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdFx0bG9nZ2VyLndhcm4oXG5cdFx0XHRcdFx0XHRcdFx0XHRgQSBjb25uZWN0ZWQgY2xpZW50IGNvdWxkIG5vdCBiZSBxdWVyaWVkIGZvciBkYXRhLiBJdCBjb3VsZCBiZSBpdCBoYXNuJ3QgdW5yZWdpc3RlcmVkIGl0c2VsZiBmcm9tIHRoZSBicm9rZXIuIEFwcElkOiAke2FwcC5hcHBJZH0sIGluc3RhbmNlSWQ6ICR7YXBwLmluc3RhbmNlSWR9LCBuYW1lOiAke2lkZW50aXR5Lm5hbWV9YCxcblx0XHRcdFx0XHRcdFx0XHRcdGVycm9yXG5cdFx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAoIWlzRW1wdHkodGl0bGUpKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gZW5zdXJlIG5vIGVsZW1lbnQgdGFncyBhcmUgcHJvdmlkZWQgaW4gdGhlIHRpdGxlXG5cdFx0XHRcdFx0XHRcdFx0Ly8gd2UgZG9uJ3Qga25vdyBob3cgdGhpcyBpbmZvcm1hdGlvbiB3aWxsIGJlIHVzZWRcblx0XHRcdFx0XHRcdFx0XHQvLyBhbmQgdGl0bGUgaGFzbid0IGNvbWUgZnJvbSB0aGUgYXBwIGRpcmVjdG9yeVxuXHRcdFx0XHRcdFx0XHRcdHRpdGxlID0gc2FuaXRpemVTdHJpbmcodGl0bGUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGluc3RhbmNlQXBwTWV0YTogQXBwTWV0YWRhdGEgPSB7XG5cdFx0XHRcdFx0XHRcdFx0Li4uYXBwTWV0YURhdGEsXG5cdFx0XHRcdFx0XHRcdFx0aW5zdGFuY2VJZDogYXBwLmluc3RhbmNlSWQsXG5cdFx0XHRcdFx0XHRcdFx0aW5zdGFuY2VNZXRhZGF0YTogeyB0aXRsZSwgcHJldmlldyB9XG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdHJldHVybiBpbnN0YW5jZUFwcE1ldGE7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBhcHBNZXRhRGF0YTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJUYXJnZXRBcHBVbmF2YWlsYWJsZVwiKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBIYW5kbGUgdGhlIHJlcXVlc3QgdG8gZ2V0IEZEQzMgaW5mby5cblx0XHRcdCAqIEBwYXJhbSBwYXlsb2FkIFRoZSBwYXlsb2FkLlxuXHRcdFx0ICogQHBhcmFtIHBheWxvYWQuZmRjM1ZlcnNpb24gVGhlIHZlcnNpb24gaW5mbyB0byBnZXQuXG5cdFx0XHQgKiBAcGFyYW0gY2xpZW50SWRlbnRpdHkgVGhlIGNsaWVudCBpZGVudGl0eS5cblx0XHRcdCAqIEByZXR1cm5zIFRoZSBpbmZvLlxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWMgYXN5bmMgZmRjM0hhbmRsZUdldEluZm8oXG5cdFx0XHRcdHBheWxvYWQ6IHtcblx0XHRcdFx0XHRmZGMzVmVyc2lvbjogc3RyaW5nO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRjbGllbnRJZGVudGl0eTogT3BlbkZpbi5DbGllbnRJZGVudGl0eVxuXHRcdFx0KTogUHJvbWlzZTx1bmtub3duPiB7XG5cdFx0XHRcdGxvZ2dlci5pbmZvKFwiZmRjM0hhbmRsZUdldEluZm9cIiwgcGF5bG9hZCwgY2xpZW50SWRlbnRpdHkpO1xuXHRcdFx0XHRpZiAocGF5bG9hZD8uZmRjM1ZlcnNpb24gPT09IFwiMi4wXCIpIHtcblx0XHRcdFx0XHRjb25zdCByZXNwb25zZTogSW1wbGVtZW50YXRpb25NZXRhZGF0YSA9IChhd2FpdCBzdXBlci5mZGMzSGFuZGxlR2V0SW5mbyhcblx0XHRcdFx0XHRcdHBheWxvYWQsXG5cdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eVxuXHRcdFx0XHRcdCkpIGFzIEltcGxlbWVudGF0aW9uTWV0YWRhdGE7XG5cdFx0XHRcdFx0Y29uc3QgYXBwSWQgPSBhd2FpdCB0aGlzLmxvb2t1cEFwcElkKGNsaWVudElkZW50aXR5KTtcblx0XHRcdFx0XHRpZiAoIWlzRW1wdHkoYXBwSWQpKSB7XG5cdFx0XHRcdFx0XHRjb25zdCB1cGRhdGVkUmVzcG9uc2UgPSB7XG5cdFx0XHRcdFx0XHRcdC4uLnJlc3BvbnNlLFxuXHRcdFx0XHRcdFx0XHRhcHBNZXRhZGF0YTogeyBhcHBJZCwgaW5zdGFuY2VJZDogY2xpZW50SWRlbnRpdHkuZW5kcG9pbnRJZCB9XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0cmV0dXJuIHVwZGF0ZWRSZXNwb25zZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBzdXBlci5mZGMzSGFuZGxlR2V0SW5mbyhwYXlsb2FkLCBjbGllbnRJZGVudGl0eSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogSGFuZGxlIGFuIGludGVudCBoYW5kbGVyIGJlaW5nIHJlZ2lzdGVyZWQuXG5cdFx0XHQgKiBAcGFyYW0gcGF5bG9hZCBUaGUgcGF5bG9hZC5cblx0XHRcdCAqIEBwYXJhbSBjbGllbnRJZGVudGl0eSBUaGUgY2xpZW50IGlkZW50aXR5LlxuXHRcdFx0ICogQHJldHVybnMgTm90aGluZy5cblx0XHRcdCAqL1xuXHRcdFx0cHVibGljIGFzeW5jIGludGVudEhhbmRsZXJSZWdpc3RlcmVkKFxuXHRcdFx0XHRwYXlsb2FkOiBJbnRlbnRSZWdpc3RyYXRpb25QYXlsb2FkLFxuXHRcdFx0XHRjbGllbnRJZGVudGl0eTogT3BlbkZpbi5DbGllbnRJZGVudGl0eVxuXHRcdFx0KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuX2NsaWVudFJlZ2lzdHJhdGlvbkhlbHBlci5pbnRlbnRIYW5kbGVyUmVnaXN0ZXJlZChwYXlsb2FkLCBjbGllbnRJZGVudGl0eSk7XG5cdFx0XHRcdGF3YWl0IHN1cGVyLmludGVudEhhbmRsZXJSZWdpc3RlcmVkKHBheWxvYWQsIGNsaWVudElkZW50aXR5KTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBBIGNvbnRleHQgaGFuZGxlciBoYXMgYmVlbiByZWdpc3RlcmVkIGFnYWluc3QgdGhlIGJyb2tlci5cblx0XHRcdCAqIEBwYXJhbSBwYXlsb2FkIFRoZSBwYXlsb2FkIGZyb20gYSBjb250ZXh0IGxpc3RlbmVyIHJlZ2lzdHJhdGlvbi5cblx0XHRcdCAqIEBwYXJhbSBwYXlsb2FkLmNvbnRleHRUeXBlIFRoZSBjb250ZXh0IHR5cGUgdGhhdCB0aGUgY2xpZW50IGlzIGxpc3RlbmluZyBmb3IuXG5cdFx0XHQgKiBAcGFyYW0gcGF5bG9hZC5oYW5kbGVySWQgVGhlIGhhbmRsZXIgSWQgZm9yIHRoaXMgbGlzdGVuZXIuXG5cdFx0XHQgKiBAcGFyYW0gY2xpZW50SWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIHRoZSBhcHBsaWNhdGlvbiB0aGF0IGlzIGFkZGluZyB0aGUgY29udGV4dCBoYW5kbGVyLlxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWMgYXN5bmMgY29udGV4dEhhbmRsZXJSZWdpc3RlcmVkKFxuXHRcdFx0XHRwYXlsb2FkOiB7IGNvbnRleHRUeXBlOiBzdHJpbmcgfCB1bmRlZmluZWQ7IGhhbmRsZXJJZDogc3RyaW5nIH0sXG5cdFx0XHRcdGNsaWVudElkZW50aXR5OiBPcGVuRmluLkNsaWVudElkZW50aXR5XG5cdFx0XHQpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmNvbnRleHRIYW5kbGVyUmVnaXN0ZXJlZChwYXlsb2FkLCBjbGllbnRJZGVudGl0eSk7XG5cdFx0XHRcdHN1cGVyLmNvbnRleHRIYW5kbGVyUmVnaXN0ZXJlZChwYXlsb2FkLCBjbGllbnRJZGVudGl0eSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogTGF1bmNoIGFuIGFwcCB3aXRoIGludGVudC5cblx0XHRcdCAqIEBwYXJhbSBhcHAgVGhlIGFwcGxpY2F0aW9uIHRvIGxhdW5jaC5cblx0XHRcdCAqIEBwYXJhbSBpbnRlbnQgVGhlIGludGVudCB0byBvcGVuIGl0IHdpdGguXG5cdFx0XHQgKiBAcGFyYW0gaW5zdGFuY2VJZCBUaGUgaW5zdGFuY2Ugb2YgdGhlIGFwcC5cblx0XHRcdCAqIEBwYXJhbSBjbGllbnRJZGVudGl0eSBUaGUgaWRlbnRpdHkgb2YgdGhlIHNvdXJjZSBvZiB0aGUgcmVxdWVzdC5cblx0XHRcdCAqIEByZXR1cm5zIFRoZSBpbnRlbnQgcmVzb2x1dGlvbi5cblx0XHRcdCAqL1xuXHRcdFx0cHJpdmF0ZSBhc3luYyBsYXVuY2hBcHBXaXRoSW50ZW50KFxuXHRcdFx0XHRhcHA6IFBsYXRmb3JtQXBwLFxuXHRcdFx0XHRpbnRlbnQ6IE9wZW5GaW4uSW50ZW50LFxuXHRcdFx0XHRpbnN0YW5jZUlkPzogc3RyaW5nLFxuXHRcdFx0XHRjbGllbnRJZGVudGl0eT86IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHlcblx0XHRcdCk6IFByb21pc2U8T21pdDxJbnRlbnRSZXNvbHV0aW9uLCBcImdldFJlc3VsdFwiPj4ge1xuXHRcdFx0XHRsb2dnZXIuaW5mbyhcIkxhdW5jaGluZyBhcHAgd2l0aCBpbnRlbnRcIik7XG5cdFx0XHRcdGxldCBwbGF0Zm9ybUlkZW50aXRpZXM6IFBsYXRmb3JtQXBwSWRlbnRpZmllcltdIHwgdW5kZWZpbmVkID0gW107XG5cdFx0XHRcdGxldCBleGlzdGluZ0luc3RhbmNlID0gdHJ1ZTtcblx0XHRcdFx0bGV0IGNvbnRleHRNZXRhZGF0YTogQ29udGV4dE1ldGFkYXRhIHwgdW5kZWZpbmVkO1xuXG5cdFx0XHRcdGlmICghaXNFbXB0eShpbnRlbnQ/LmNvbnRleHQpKSB7XG5cdFx0XHRcdFx0aW50ZW50LmNvbnRleHQgPSBhd2FpdCB0aGlzLnByb2Nlc3NDb250ZXh0KGludGVudC5jb250ZXh0KTtcblx0XHRcdFx0XHRpZiAoIWlzRW1wdHkoY2xpZW50SWRlbnRpdHkpKSB7XG5cdFx0XHRcdFx0XHRjb250ZXh0TWV0YWRhdGEgPSBhd2FpdCB0aGlzLmdldENvbnRleHRNZXRhZGF0YShjbGllbnRJZGVudGl0eSk7XG5cdFx0XHRcdFx0XHRpbnRlbnQuY29udGV4dCA9IHsgLi4uaW50ZW50LmNvbnRleHQsIFt0aGlzLl9tZXRhZGF0YUtleV06IGNvbnRleHRNZXRhZGF0YSB9O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICghaXNFbXB0eShpbnN0YW5jZUlkKSkge1xuXHRcdFx0XHRcdC8vIGFuIGluc3RhbmNlIG9mIGFuIGFwcGxpY2F0aW9uIHdhcyBzZWxlY3RlZFxuXHRcdFx0XHRcdGNvbnN0IGFsbENvbm5lY3RlZENsaWVudHMgPSBhd2FpdCB0aGlzLmdldEFsbENsaWVudEluZm8oKTtcblx0XHRcdFx0XHRjb25zdCBjbGllbnRJbmZvID0gYWxsQ29ubmVjdGVkQ2xpZW50cy5maW5kKFxuXHRcdFx0XHRcdFx0KGNvbm5lY3RlZENsaWVudCkgPT4gY29ubmVjdGVkQ2xpZW50LmVuZHBvaW50SWQgPT09IGluc3RhbmNlSWRcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdGlmICghaXNFbXB0eShjbGllbnRJbmZvKSkge1xuXHRcdFx0XHRcdFx0bG9nZ2VyLmluZm8oYEFwcCBJZDogJHthcHAuYXBwSWR9IGFuZCBpbnN0YW5jZSBJZDogJHtpbnN0YW5jZUlkfSB3YXMgcHJvdmlkZWQgYW5kIGZvdW5kLmApO1xuXHRcdFx0XHRcdFx0Ly8gdGhlIGNvbm5lY3RlZCBpbnN0YW5jZSBpcyBhdmFpbGFibGVcblx0XHRcdFx0XHRcdHBsYXRmb3JtSWRlbnRpdGllcy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0dXVpZDogY2xpZW50SW5mby51dWlkLFxuXHRcdFx0XHRcdFx0XHRuYW1lOiBjbGllbnRJbmZvLm5hbWUsXG5cdFx0XHRcdFx0XHRcdGFwcElkOiBhcHAuYXBwSWQsXG5cdFx0XHRcdFx0XHRcdGluc3RhbmNlSWQ6IGNsaWVudEluZm8uZW5kcG9pbnRJZFxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihSZXNvbHZlRXJyb3IuVGFyZ2V0SW5zdGFuY2VVbmF2YWlsYWJsZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHBsYXRmb3JtSWRlbnRpdGllcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHRsZXQgbGF1bmNoUHJlZmVyZW5jZTogTGF1bmNoUHJlZmVyZW5jZSB8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRjb25zdCBib3VuZHMgPSBhd2FpdCBnZXRXaW5kb3dQb3NpdGlvblVzaW5nU3RyYXRlZ3kob3B0aW9ucy53aW5kb3dQb3NpdGlvbk9wdGlvbnMsIGNsaWVudElkZW50aXR5KTtcblx0XHRcdFx0XHRpZiAoIWlzRW1wdHkoYm91bmRzKSkge1xuXHRcdFx0XHRcdFx0bGF1bmNoUHJlZmVyZW5jZSA9IHsgYm91bmRzIH07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHBsYXRmb3JtSWRlbnRpdGllcyA9IGF3YWl0IGxhdW5jaChhcHAuYXBwSWQsIGxhdW5jaFByZWZlcmVuY2UpO1xuXHRcdFx0XHRcdGlmICghcGxhdGZvcm1JZGVudGl0aWVzPy5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihSZXNvbHZlRXJyb3IuSW50ZW50RGVsaXZlcnlGYWlsZWQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRleGlzdGluZ0luc3RhbmNlID0gZmFsc2U7XG5cdFx0XHRcdFx0aWYgKHBsYXRmb3JtSWRlbnRpdGllcy5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGludGVudFRpbWVvdXQ6IG51bWJlciB8IHVuZGVmaW5lZCA9IG9wdGlvbnM/LmludGVudE9wdGlvbnM/LmludGVudFRpbWVvdXQ7XG5cdFx0XHRcdFx0XHQvLyBpZiB3ZSBoYXZlIGEgc25hcHNob3QgYW5kIG11bHRpcGxlIGlkZW50aXRpZXMgd2Ugd2lsbCBub3Qgd2FpdCBhcyBub3QgYWxsIG9mIHRoZW0gbWlnaHQgbm90IHN1cHBvcnQgaW50ZW50cy5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGluc3RhbmNlSWQgPSBhd2FpdCB0aGlzLl9jbGllbnRSZWdpc3RyYXRpb25IZWxwZXIub25JbnRlbnRDbGllbnRSZWFkeShcblx0XHRcdFx0XHRcdFx0XHRwbGF0Zm9ybUlkZW50aXRpZXNbMF0sXG5cdFx0XHRcdFx0XHRcdFx0aW50ZW50Lm5hbWUsXG5cdFx0XHRcdFx0XHRcdFx0aW50ZW50VGltZW91dFxuXHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoaW50ZW50UmVhZHlFcnJvcikge1xuXHRcdFx0XHRcdFx0XHRsb2dnZXIud2Fybihcblx0XHRcdFx0XHRcdFx0XHRcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIGdldHRpbmcgYSBpbnN0YW5jZSB0byB0YXJnZXQgYW4gaW50ZW50IGF0LlwiLFxuXHRcdFx0XHRcdFx0XHRcdGludGVudFJlYWR5RXJyb3Jcblx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFJlc29sdmVFcnJvci5JbnRlbnREZWxpdmVyeUZhaWxlZCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Zm9yIChjb25zdCB0YXJnZXQgb2YgcGxhdGZvcm1JZGVudGl0aWVzKSB7XG5cdFx0XHRcdFx0YXdhaXQgc3VwZXIuc2V0SW50ZW50VGFyZ2V0KGludGVudCwgdGFyZ2V0KTtcblx0XHRcdFx0XHRpZiAoZXhpc3RpbmdJbnN0YW5jZSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0aWYgKGhlbHBlcnMuYnJpbmdBcHBUb0Zyb250KSB7XG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgaGVscGVycy5icmluZ0FwcFRvRnJvbnQoYXBwLCBbdGFyZ2V0XSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGJyaW5nVG9Gcm9udEVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdGxvZ2dlci53YXJuKFxuXHRcdFx0XHRcdFx0XHRcdGBUaGVyZSB3YXMgYW4gZXJyb3IgYnJpbmdpbmcgYXBwOiAke3RhcmdldC5hcHBJZH0sIGFuZCBpbnN0YW5jZSAke3RhcmdldC5pbnN0YW5jZUlkfSB3aXRoIG5hbWU6ICR7dGFyZ2V0Lm5hbWV9IHRvIGZyb250LmAsXG5cdFx0XHRcdFx0XHRcdFx0YnJpbmdUb0Zyb250RXJyb3Jcblx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHNvdXJjZTogeyBhcHBJZDogYXBwLmFwcElkLCBpbnN0YW5jZUlkIH0sXG5cdFx0XHRcdFx0dmVyc2lvbjogYXBwLnZlcnNpb24sXG5cdFx0XHRcdFx0aW50ZW50OiBpbnRlbnQubmFtZVxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIEhhbmRsZSB0aGUgaW50ZW50IHBpY2tlciBzZWxlY3Rpb24uXG5cdFx0XHQgKiBAcGFyYW0gdXNlclNlbGVjdGlvbiBUaGUgdXNlciBzZWxlY3Rpb24gZnJvbSB0aGUgaW50ZW50IHBpY2tlci5cblx0XHRcdCAqIEBwYXJhbSBpbnRlbnQgVGhlIGludGVudC5cblx0XHRcdCAqIEBwYXJhbSBjbGllbnRJZGVudGl0eSBUaGUgc291cmNlIG9mIHRoZSByZXF1ZXN0LlxuXHRcdFx0ICogQHJldHVybnMgVGhlIGludGVudCByZXNvbHV0aW9uLlxuXHRcdFx0ICovXG5cdFx0XHRwcml2YXRlIGFzeW5jIGhhbmRsZUludGVudFBpY2tlclNlbGVjdGlvbihcblx0XHRcdFx0dXNlclNlbGVjdGlvbjogSW50ZW50UmVzb2x2ZXJSZXNwb25zZSxcblx0XHRcdFx0aW50ZW50OiBPcGVuRmluLkludGVudDxPcGVuRmluLkludGVudE1ldGFkYXRhPEludGVudFRhcmdldE1ldGFEYXRhPj4sXG5cdFx0XHRcdGNsaWVudElkZW50aXR5PzogT3BlbkZpbi5DbGllbnRJZGVudGl0eVxuXHRcdFx0KTogUHJvbWlzZTxPbWl0PEludGVudFJlc29sdXRpb24sIFwiZ2V0UmVzdWx0XCI+PiB7XG5cdFx0XHRcdGxldCBzZWxlY3RlZEFwcCA9IGF3YWl0IGdldEFwcCh1c2VyU2VsZWN0aW9uLmFwcElkKTtcblx0XHRcdFx0aWYgKGlzRW1wdHkoc2VsZWN0ZWRBcHApICYmICFpc0VtcHR5KHRoaXMuX3VucmVnaXN0ZXJlZEFwcCkpIHtcblx0XHRcdFx0XHRzZWxlY3RlZEFwcCA9IHRoaXMuX3VucmVnaXN0ZXJlZEFwcDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoaXNFbXB0eShzZWxlY3RlZEFwcCkpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLk5vQXBwc0ZvdW5kKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBpbnN0YW5jZUlkOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1c2VyU2VsZWN0aW9uLmluc3RhbmNlSWQ7XG5cdFx0XHRcdGNvbnN0IGludGVudFJlc29sdmVyID0gYXdhaXQgdGhpcy5sYXVuY2hBcHBXaXRoSW50ZW50KFxuXHRcdFx0XHRcdHNlbGVjdGVkQXBwLFxuXHRcdFx0XHRcdGludGVudCxcblx0XHRcdFx0XHRpbnN0YW5jZUlkLFxuXHRcdFx0XHRcdGNsaWVudElkZW50aXR5XG5cdFx0XHRcdCk7XG5cdFx0XHRcdGlmIChpc0VtcHR5KGludGVudFJlc29sdmVyKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihSZXNvbHZlRXJyb3IuTm9BcHBzRm91bmQpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBpbnRlbnRSZXNvbHZlcjtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBIYW5kbGUgYSB0YXJnZXRlZCBpbnRlbnQuXG5cdFx0XHQgKiBAcGFyYW0gdGFyZ2V0QXBwSWRlbnRpZmllciBUaGUgaWRlbnRpZmllciBmb3IgdGhlIHRhcmdldCBhcHAuXG5cdFx0XHQgKiBAcGFyYW0gaW50ZW50IFRoZSBpbnRlbnQuXG5cdFx0XHQgKiBAcGFyYW0gdGFyZ2V0QnlDb250ZXh0IFBlcmZvcm0gdGhlIHRhcmdldCBieSBjb250ZXh0LlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgaWRlbnRpdHkuXG5cdFx0XHQgKiBAcmV0dXJucyBUaGUgaW50ZW50IHJlc29sdXRpb24uXG5cdFx0XHQgKi9cblx0XHRcdHByaXZhdGUgYXN5bmMgaGFuZGxlVGFyZ2V0ZWRJbnRlbnQoXG5cdFx0XHRcdHRhcmdldEFwcElkZW50aWZpZXI6IEFwcElkZW50aWZpZXIsXG5cdFx0XHRcdGludGVudDogT3BlbkZpbi5JbnRlbnQsXG5cdFx0XHRcdHRhcmdldEJ5Q29udGV4dDogYm9vbGVhbixcblx0XHRcdFx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHlcblx0XHRcdCk6IFByb21pc2U8T21pdDxJbnRlbnRSZXNvbHV0aW9uLCBcImdldFJlc3VsdFwiPj4ge1xuXHRcdFx0XHQvLyBhcHAgc3BlY2lmaWVkIGZsb3dcblx0XHRcdFx0Y29uc3QgaW50ZW50c0ZvclNlbGVjdGlvbjogQXBwc0ZvckludGVudFtdID0gW107XG5cdFx0XHRcdGxldCB0YXJnZXRBcHAgPSBhd2FpdCBnZXRBcHAodGFyZ2V0QXBwSWRlbnRpZmllci5hcHBJZCk7XG5cblx0XHRcdFx0Ly8gaWYgdGhlIHNwZWNpZmllZCBhcHAgaXNuJ3QgYXZhaWxhYmxlIHRoZW4gbGV0IHRoZSBjYWxsZXIga25vd1xuXHRcdFx0XHRpZiAoaXNFbXB0eSh0YXJnZXRBcHApKSB7XG5cdFx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdFx0IWlzRW1wdHkodGFyZ2V0QXBwSWRlbnRpZmllci5pbnN0YW5jZUlkKSAmJlxuXHRcdFx0XHRcdFx0dGFyZ2V0QXBwSWRlbnRpZmllci5hcHBJZCA9PT0gdGhpcy5fdW5yZWdpc3RlcmVkQXBwPy5hcHBJZFxuXHRcdFx0XHRcdCkge1xuXHRcdFx0XHRcdFx0dGFyZ2V0QXBwID0gdGhpcy5fdW5yZWdpc3RlcmVkQXBwO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLlRhcmdldEFwcFVuYXZhaWxhYmxlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gaWYgYW4gaW5zdGFuY2VJZCBpcyBzcGVjaWZpZWQgdGhlbiBjaGVjayB0byBzZWUgaWYgaXQgaXMgdmFsaWQgYW5kIGlmIGl0IGlzbid0IGluZm9ybSB0aGUgY2FsbGVyXG5cdFx0XHRcdGlmICghaXNFbXB0eSh0YXJnZXRBcHBJZGVudGlmaWVyLmluc3RhbmNlSWQpKSB7XG5cdFx0XHRcdFx0Y29uc3QgYXZhaWxhYmxlQXBwSW5zdGFuY2VzID0gYXdhaXQgdGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmZpbmRBcHBJbnN0YW5jZXMoXG5cdFx0XHRcdFx0XHR0YXJnZXRBcHBJZGVudGlmaWVyLFxuXHRcdFx0XHRcdFx0Y2xpZW50SWRlbnRpdHksXG5cdFx0XHRcdFx0XHRcImludGVudFwiXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0XHRhdmFpbGFibGVBcHBJbnN0YW5jZXMubGVuZ3RoID09PSAwIHx8XG5cdFx0XHRcdFx0XHQhYXZhaWxhYmxlQXBwSW5zdGFuY2VzLnNvbWUoXG5cdFx0XHRcdFx0XHRcdChlbnRyeSkgPT5cblx0XHRcdFx0XHRcdFx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxlblxuXHRcdFx0XHRcdFx0XHRcdGVudHJ5LmFwcElkID09PSB0YXJnZXRBcHBJZGVudGlmaWVyLmFwcElkICYmXG5cdFx0XHRcdFx0XHRcdFx0ZW50cnkuaW5zdGFuY2VJZCA9PT0gdGFyZ2V0QXBwSWRlbnRpZmllci5pbnN0YW5jZUlkXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLlRhcmdldEluc3RhbmNlVW5hdmFpbGFibGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICghQXJyYXkuaXNBcnJheSh0YXJnZXRBcHAuaW50ZW50cykgfHwgdGFyZ2V0QXBwLmludGVudHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0Ly8gYW4gYXBwIHdhcyBzcGVjaWZpZWQgYnV0IGl0IGRvZXNuJ3QgaGF2ZSBhbnkgaW50ZW50cy4gSW5kaWNhdGUgdGhhdCBzb21ldGhpbmcgaXMgd3Jvbmdcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLlRhcmdldEFwcFVuYXZhaWxhYmxlKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IHN1cHBvcnRlZEludGVudHMgPSB0YXJnZXRBcHAuaW50ZW50cy5maWx0ZXIoKGludGVudEVudHJ5KSA9PiB7XG5cdFx0XHRcdFx0bGV0IGNvbnRleHRNYXRjaDogYm9vbGVhbiA9IHRydWU7XG5cdFx0XHRcdFx0Y29uc3QgY29udGV4dFR5cGUgPSBpbnRlbnQuY29udGV4dD8udHlwZTtcblx0XHRcdFx0XHRpZiAoIWlzRW1wdHkoY29udGV4dFR5cGUpKSB7XG5cdFx0XHRcdFx0XHRjb250ZXh0TWF0Y2ggPSBpbnRlbnRFbnRyeS5jb250ZXh0cz8uaW5jbHVkZXMoY29udGV4dFR5cGUpO1xuXHRcdFx0XHRcdFx0aWYgKHRhcmdldEJ5Q29udGV4dCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gY29udGV4dE1hdGNoO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gaW50ZW50RW50cnkubmFtZSA9PT0gaW50ZW50Lm5hbWUgJiYgY29udGV4dE1hdGNoO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAoc3VwcG9ydGVkSW50ZW50cy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHQvLyB0aGUgc3BlY2lmaWVkIGFwcCBkb2VzIGhhdmUgaW50ZW50IHN1cHBvcnQgYnV0IGp1c3Qgbm9uZSB0aGF0IHN1cHBvcnQgdGhpcyBjb250ZXh0IHR5cGVcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoUmVzb2x2ZUVycm9yLlRhcmdldEFwcFVuYXZhaWxhYmxlKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChzdXBwb3J0ZWRJbnRlbnRzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdC8vIGEgcHJlZmVycmVkIG5hbWUgZm9yIGFuIGFwcCB3YXMgZ2l2ZW4gd2l0aCB0aGUgY29udGV4dCBvYmplY3Rcblx0XHRcdFx0XHQvLyB0aGUgYXBwIGV4aXN0ZWQgYW5kIGl0IHN1cHBvcnRlZCB0aGUgY29udGV4dCB0eXBlIGFuZCB0aGVyZSB3YXMgb25seSBvbmUgaW50ZW50IHRoYXQgc3VwcG9ydGVkXG5cdFx0XHRcdFx0Ly8gdGhhdCBjb250ZXh0IHR5cGUuIExhdW5jaCB0aGUgYXBwIHdpdGggdGhhdCBpbnRlbnQgb3RoZXJ3aXNlIHByZXNlbnQgdGhlIHVzZXIgd2l0aCBhIGxpc3Qgb2Zcblx0XHRcdFx0XHQvLyBldmVyeXRoaW5nIHRoYXQgc3VwcG9ydHMgdGhhdCBjb250ZXh0IHR5cGVcblx0XHRcdFx0XHRpbnRlbnQubmFtZSA9IHN1cHBvcnRlZEludGVudHNbMF0ubmFtZTtcblx0XHRcdFx0XHQvLyBjaGVjayBmb3IgaW5zdGFuY2VzXG5cdFx0XHRcdFx0aWYgKCFpc0VtcHR5KHRhcmdldEFwcElkZW50aWZpZXIuaW5zdGFuY2VJZCkpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGludGVudFJlc29sdmVyID0gYXdhaXQgdGhpcy5sYXVuY2hBcHBXaXRoSW50ZW50KFxuXHRcdFx0XHRcdFx0XHR0YXJnZXRBcHAsXG5cdFx0XHRcdFx0XHRcdGludGVudCxcblx0XHRcdFx0XHRcdFx0dGFyZ2V0QXBwSWRlbnRpZmllci5pbnN0YW5jZUlkLFxuXHRcdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdHJldHVybiBpbnRlbnRSZXNvbHZlcjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y29uc3Qgc3BlY2lmaWVkQXBwSW5zdGFuY2VzID0gYXdhaXQgdGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmZpbmRBcHBJbnN0YW5jZXMoXG5cdFx0XHRcdFx0XHR0YXJnZXRBcHAsXG5cdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eSxcblx0XHRcdFx0XHRcdFwiaW50ZW50XCJcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdC8vIHRoZSBsYXVuY2ggbG9naWMgaXMgc2luZ2xlIGluc3RhbmNlIGF3YXJlIGJ1dCBjYW4gYWxzbyBicmluZyBjb250ZW50IHRvIGZyb250IHdoZXJlIHBvc3NpYmxlXG5cdFx0XHRcdFx0Ly8gdGhpcyB3aWxsIGxldCB0aGUgY29udGV4dCBiZSBzZXQgYW5kIHRoZSBjb250ZW50IGJyb3VnaHQgdG8gZnJvbnQuXG5cdFx0XHRcdFx0Y29uc3QgbGF1bmNoU2luZ2xlSW5zdGFuY2VBcHAgPVxuXHRcdFx0XHRcdFx0c3BlY2lmaWVkQXBwSW5zdGFuY2VzLmxlbmd0aCA9PT0gMSAmJiB0aGlzLnVzZVNpbmdsZUluc3RhbmNlKHRhcmdldEFwcCk7XG5cblx0XHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0XHRzcGVjaWZpZWRBcHBJbnN0YW5jZXMubGVuZ3RoID09PSAwIHx8XG5cdFx0XHRcdFx0XHR0aGlzLmNyZWF0ZU5ld0luc3RhbmNlKHRhcmdldEFwcCkgfHxcblx0XHRcdFx0XHRcdGxhdW5jaFNpbmdsZUluc3RhbmNlQXBwXG5cdFx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0XHRjb25zdCBpbnRlbnRSZXNvbHZlciA9IGF3YWl0IHRoaXMubGF1bmNoQXBwV2l0aEludGVudChcblx0XHRcdFx0XHRcdFx0dGFyZ2V0QXBwLFxuXHRcdFx0XHRcdFx0XHRpbnRlbnQsXG5cdFx0XHRcdFx0XHRcdHVuZGVmaW5lZCxcblx0XHRcdFx0XHRcdFx0Y2xpZW50SWRlbnRpdHlcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRpZiAoaXNFbXB0eShpbnRlbnRSZXNvbHZlcikpIHtcblx0XHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFJlc29sdmVFcnJvci5JbnRlbnREZWxpdmVyeUZhaWxlZCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRyZXR1cm4gaW50ZW50UmVzb2x2ZXI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Zm9yIChjb25zdCBzdXBwb3J0ZWRJbnRlbnQgb2Ygc3VwcG9ydGVkSW50ZW50cykge1xuXHRcdFx0XHRcdGNvbnN0IGFwcEZvckludGVudDogQXBwc0ZvckludGVudCA9IHtcblx0XHRcdFx0XHRcdGFwcHM6IFt0YXJnZXRBcHBdLFxuXHRcdFx0XHRcdFx0aW50ZW50OiB7IG5hbWU6IHN1cHBvcnRlZEludGVudC5uYW1lLCBkaXNwbGF5TmFtZTogc3VwcG9ydGVkSW50ZW50LmRpc3BsYXlOYW1lIH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdGludGVudHNGb3JTZWxlY3Rpb24ucHVzaChhcHBGb3JJbnRlbnQpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGxldCB1c2VyU2VsZWN0aW9uOiBJbnRlbnRSZXNvbHZlclJlc3BvbnNlIHwgdW5kZWZpbmVkO1xuXHRcdFx0XHRpZiAoaW50ZW50c0ZvclNlbGVjdGlvbi5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0XHQhaXNTdHJpbmdWYWx1ZShpbnRlbnQubmFtZSkgJiZcblx0XHRcdFx0XHRcdCFpc0VtcHR5KGludGVudHNGb3JTZWxlY3Rpb25bMF0/LmludGVudD8ubmFtZSkgJiZcblx0XHRcdFx0XHRcdCFpc0VtcHR5KGludGVudD8uY29udGV4dCkgJiZcblx0XHRcdFx0XHRcdCFpc0VtcHR5KGludGVudD8uY29udGV4dD8udHlwZSlcblx0XHRcdFx0XHQpIHtcblx0XHRcdFx0XHRcdGxvZ2dlci5pbmZvKFxuXHRcdFx0XHRcdFx0XHRgQSByZXF1ZXN0IHRvIHJhaXNlIGFuIGludGVudCB3YXMgcGFzc2VkIGFuZCB0aGUgaW50ZW50IG5hbWUgd2FzIG5vdCBwYXNzZWQgYnV0IGEgY29udGV4dCB3YXMgJHtpbnRlbnQ/LmNvbnRleHQ/LnR5cGV9IHdpdGggMSBtYXRjaGluZyBpbnRlbnQuIE5hbWU6ICR7aW50ZW50c0ZvclNlbGVjdGlvblswXT8uaW50ZW50Py5uYW1lfSwgIERpc3BsYXkgTmFtZTogJHtpbnRlbnRzRm9yU2VsZWN0aW9uWzBdPy5pbnRlbnQ/LmRpc3BsYXlOYW1lfS4gVXBkYXRpbmcgaW50ZW50IG9iamVjdC5gXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0aW50ZW50Lm5hbWUgPSBpbnRlbnRzRm9yU2VsZWN0aW9uWzBdPy5pbnRlbnQ/Lm5hbWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHVzZXJTZWxlY3Rpb24gPSBhd2FpdCB0aGlzLl9pbnRlbnRSZXNvbHZlckhlbHBlcj8ubGF1bmNoSW50ZW50UmVzb2x2ZXIoXG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdGFwcHM6IGludGVudHNGb3JTZWxlY3Rpb25bMF0uYXBwcyxcblx0XHRcdFx0XHRcdFx0aW50ZW50XG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0Y2xpZW50SWRlbnRpdHlcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHVzZXJTZWxlY3Rpb24gPSBhd2FpdCB0aGlzLl9pbnRlbnRSZXNvbHZlckhlbHBlcj8ubGF1bmNoSW50ZW50UmVzb2x2ZXIoXG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdGludGVudCxcblx0XHRcdFx0XHRcdFx0aW50ZW50czogaW50ZW50c0ZvclNlbGVjdGlvblxuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdGNsaWVudElkZW50aXR5XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRpZiAoIWlzU3RyaW5nVmFsdWUoaW50ZW50Lm5hbWUpICYmICFpc0VtcHR5KHVzZXJTZWxlY3Rpb24/LmludGVudD8ubmFtZSkpIHtcblx0XHRcdFx0XHRcdGxvZ2dlci5pbmZvKFxuXHRcdFx0XHRcdFx0XHRgQSByZXF1ZXN0IHRvIHJhaXNlIGFuIGludGVudCB3YXMgcGFzc2VkIGFuZCB0aGUgZm9sbG93aW5nIGludGVudCB3YXMgc2VsZWN0ZWQgKGZyb20gYSBzZWxlY3Rpb24gb2YgJHtpbnRlbnRzRm9yU2VsZWN0aW9uLmxlbmd0aH0pLiBOYW1lOiAke3VzZXJTZWxlY3Rpb24/LmludGVudD8ubmFtZX0sICBEaXNwbGF5IE5hbWU6ICR7dXNlclNlbGVjdGlvbj8uaW50ZW50Py5kaXNwbGF5TmFtZX0uIFVwZGF0aW5nIGludGVudCBvYmplY3QuYFxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdGludGVudC5uYW1lID0gdXNlclNlbGVjdGlvbj8uaW50ZW50Py5uYW1lID8/IGludGVudC5uYW1lO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoaXNFbXB0eSh1c2VyU2VsZWN0aW9uKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihSZXNvbHZlRXJyb3IuUmVzb2x2ZXJVbmF2YWlsYWJsZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdGhpcy5oYW5kbGVJbnRlbnRQaWNrZXJTZWxlY3Rpb24odXNlclNlbGVjdGlvbiwgaW50ZW50LCBjbGllbnRJZGVudGl0eSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogU2hhcGUgdGhlIGludGVudCByZXNvbHZlci5cblx0XHRcdCAqIEBwYXJhbSBpbnRlbnRSZXNvbHZlciBUaGUgaW50ZW50IHJlc29sdmVyIHRvIHNoYXBlLlxuXHRcdFx0ICogQHBhcmFtIHVzZXNBcHBJZGVudGlmaWVyIFNob3VsZCBpdCB1c2UgdGhlIGFwcCBpZGVudGlmaWVyLlxuXHRcdFx0ICogQHJldHVybnMgVGhlIHNoYXBlZCBpbnRlbnQgcmVzb2x2ZXIuXG5cdFx0XHQgKi9cblx0XHRcdHByaXZhdGUgc2hhcGVJbnRlbnRSZXNvbHZlcihcblx0XHRcdFx0aW50ZW50UmVzb2x2ZXI6IE9taXQ8SW50ZW50UmVzb2x1dGlvbiwgXCJnZXRSZXN1bHRcIj4sXG5cdFx0XHRcdHVzZXNBcHBJZGVudGlmaWVyOiBib29sZWFuXG5cdFx0XHQpOiBPbWl0PEludGVudFJlc29sdXRpb24sIFwiZ2V0UmVzdWx0XCI+IHwgeyBzb3VyY2U6IHN0cmluZzsgdmVyc2lvbj86IHN0cmluZyB9IHtcblx0XHRcdFx0aWYgKHVzZXNBcHBJZGVudGlmaWVyKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGludGVudFJlc29sdmVyO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB7IHNvdXJjZTogaW50ZW50UmVzb2x2ZXIuc291cmNlLmFwcElkLCB2ZXJzaW9uOiBpbnRlbnRSZXNvbHZlci52ZXJzaW9uIH07XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogU2hvdWxkIHdlIHVzZSBhIHNpbmdsZSBpbnN0YW5jZSBvZiB0aGUgYXBwLlxuXHRcdFx0ICogQHBhcmFtIGFwcCBUaGUgYXBwIHRvIGNoZWNrLlxuXHRcdFx0ICogQHJldHVybnMgVHJ1ZSBpZiB3ZSBzaG91bGQgdXNlIGEgc2luZ2xlIGluc3RhbmNlLlxuXHRcdFx0ICovXG5cdFx0XHRwcml2YXRlIHVzZVNpbmdsZUluc3RhbmNlKGFwcDogUGxhdGZvcm1BcHApOiBib29sZWFuIHtcblx0XHRcdFx0cmV0dXJuIGFwcD8uaW5zdGFuY2VNb2RlID09PSBcInNpbmdsZVwiO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNob3VsZCB3ZSBhbHdheXMgdXNlIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBhcHAuXG5cdFx0XHQgKiBAcGFyYW0gYXBwIFRoZSBhcHAgdG8gY2hlY2suXG5cdFx0XHQgKiBAcmV0dXJucyBUcnVlIGlmIHdlIHNob3VsZCBhbHdheXMgdXNlIGEgbmV3IGluc3RhbmNlLlxuXHRcdFx0ICovXG5cdFx0XHRwcml2YXRlIGNyZWF0ZU5ld0luc3RhbmNlKGFwcDogUGxhdGZvcm1BcHApOiBib29sZWFuIHtcblx0XHRcdFx0cmV0dXJuIGFwcD8uaW5zdGFuY2VNb2RlID09PSBcIm5ld1wiO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIEdldCBhIHByZXZpZXcgaW1hZ2UgZm9yIGEgd2luZG93L3ZpZXcuXG5cdFx0XHQgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgaWRlbnRpdHkgdG8gY2FwdHVyZS5cblx0XHRcdCAqIEBwYXJhbSB0YXJnZXQuY2FwdHVyZVBhZ2UgVGhlIGNhcHR1cmUgcGFnZSBtZXRob2Qgb2YgdGhlIGVudGl0eS5cblx0XHRcdCAqIEBwYXJhbSB0YXJnZXQuaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIHRoZSBlbnRpdHkgYmVpbmcgY2FwdHVyZWQuXG5cdFx0XHQgKiBAcmV0dXJucyBUaGUgY2FwdHVyZWQgcHJldmlldyBpbWFnZS5cblx0XHRcdCAqL1xuXHRcdFx0cHJpdmF0ZSBhc3luYyBnZXRQcmV2aWV3SW1hZ2UodGFyZ2V0OiB7XG5cdFx0XHRcdGNhcHR1cmVQYWdlOiAob3B0aW9ucz86IE9wZW5GaW4uQ2FwdHVyZVBhZ2VPcHRpb25zKSA9PiBQcm9taXNlPHN0cmluZz47XG5cdFx0XHRcdGlkZW50aXR5OiBPcGVuRmluLklkZW50aXR5O1xuXHRcdFx0fSk6IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPiB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Y29uc3QgcHJldmlldyA9IGF3YWl0IHRhcmdldC5jYXB0dXJlUGFnZSh7IGZvcm1hdDogXCJqcGdcIiwgcXVhbGl0eTogODUgfSk7XG5cdFx0XHRcdFx0aWYgKGlzU3RyaW5nVmFsdWUocHJldmlldykpIHtcblx0XHRcdFx0XHRcdHJldHVybiBwcmV2aWV3O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRsb2dnZXIuZXJyb3IoXG5cdFx0XHRcdFx0XHRgRXJyb3Igd2hpbGUgdHJ5aW5nIHRvIGNhcHR1cmUgYSBwcmV2aWV3IGltYWdlIG9mIHRoZSB2aWV3L3dpbmRvdzogJHt0YXJnZXQuaWRlbnRpdHkubmFtZX1gLFxuXHRcdFx0XHRcdFx0ZXJyb3Jcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogR2V0IHRoZSB1bnJlZ2lzdGVyZWQgYXBwIGludGVudCBieSBjb250ZXh0LlxuXHRcdFx0ICogQHBhcmFtIHR5cGUgVGhlIGNvbnRleHQgdHlwZSB0byBnZXQuXG5cdFx0XHQgKiBAcGFyYW0gY2xpZW50SWRlbnRpdHkgVGhlIGNsaWVudCBpZGVudGl0eS5cblx0XHRcdCAqIEByZXR1cm5zIFRoZSBsaXN0IG9mIHN1cHBvcnRlZCBpbnRlbnRzLlxuXHRcdFx0ICovXG5cdFx0XHRwcml2YXRlIGFzeW5jIGdldFVucmVnaXN0ZXJlZEFwcEludGVudEJ5Q29udGV4dChcblx0XHRcdFx0dHlwZTogc3RyaW5nLFxuXHRcdFx0XHRjbGllbnRJZGVudGl0eTogT3BlbkZpbi5DbGllbnRJZGVudGl0eVxuXHRcdFx0KTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdFx0XHRjb25zdCBpbnRlbnROYW1lczogc3RyaW5nW10gPSBbXTtcblx0XHRcdFx0Y29uc3Qgc3VwcG9ydGVkSW50ZW50TmFtZXM6IHN0cmluZ1tdID0gW107XG5cdFx0XHRcdGlmIChpc0VtcHR5KHRoaXM/Ll91bnJlZ2lzdGVyZWRBcHApKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGludGVudE5hbWVzO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChBcnJheS5pc0FycmF5KHRoaXM/Ll91bnJlZ2lzdGVyZWRBcHA/LmludGVudHMpKSB7XG5cdFx0XHRcdFx0Zm9yIChjb25zdCBpbnRlbnQgb2YgdGhpcy5fdW5yZWdpc3RlcmVkQXBwLmludGVudHMpIHtcblx0XHRcdFx0XHRcdGlmIChpbnRlbnQuY29udGV4dHMuaW5jbHVkZXModHlwZSkpIHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgaW50ZW50TmFtZTogc3RyaW5nID0gaW50ZW50Lm5hbWU7XG5cdFx0XHRcdFx0XHRcdGludGVudE5hbWVzLnB1c2goaW50ZW50TmFtZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGludGVudE5hbWVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHQvLyBub3cgd2UgbmVlZCB0byBjaGVjayBpZiB0aGVyZSBhcmUgYW55IGluc3RhbmNlcyBhcyB0aGlzIGFwcCBjYW4gbm90IGJlIGxhdW5jaGVkIGFzIGl0IGlzIGEgcGxhY2Vob2xkZXIgZm9yIHVucmVnaXN0ZXJlZCBpbnN0YW5jZXNcblx0XHRcdFx0XHRmb3IgKGNvbnN0IGludGVudE5hbWUgb2YgaW50ZW50TmFtZXMpIHtcblx0XHRcdFx0XHRcdGlmIChhd2FpdCB0aGlzLmNhbkFkZFVucmVnaXN0ZXJlZEFwcChjbGllbnRJZGVudGl0eSwgaW50ZW50TmFtZSkpIHtcblx0XHRcdFx0XHRcdFx0c3VwcG9ydGVkSW50ZW50TmFtZXMucHVzaChpbnRlbnROYW1lKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gdGhlIHVucmVnaXN0ZXJlZEFwcE1ldGEgZGF0YSBsaXN0cyB0aGUgc3VwcG9ydGVkIGludGVudHMgYnV0IHdlIG9ubHkgd2FudCB0byByZXR1cm4gaW50ZW50cyB0aGF0IGhhdmUgYWN0aXZlIGluc3RhbmNlcyByZWFkeVxuXHRcdFx0XHRyZXR1cm4gc3VwcG9ydGVkSW50ZW50TmFtZXM7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogQ2FuIHdlIGFkZCBhbiB1bnJlZ2lzdGVyZWQgYXBwLlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgaWRlbnRpdHkuXG5cdFx0XHQgKiBAcGFyYW0gaW50ZW50TmFtZSBUaGUgaW50ZW50IG5hbWUuXG5cdFx0XHQgKiBAcGFyYW0gY29udGV4dFR5cGUgVGhlIGNvbnRleHQgdHlwZS5cblx0XHRcdCAqIEByZXR1cm5zIFRydWUgaWYgd2UgY2FuIGFkZCB0aGUgYXBwLlxuXHRcdFx0ICovXG5cdFx0XHRwcml2YXRlIGFzeW5jIGNhbkFkZFVucmVnaXN0ZXJlZEFwcChcblx0XHRcdFx0Y2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHksXG5cdFx0XHRcdGludGVudE5hbWU/OiBzdHJpbmcsXG5cdFx0XHRcdGNvbnRleHRUeXBlPzogc3RyaW5nXG5cdFx0XHQpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRcdFx0aWYgKGlzRW1wdHkodGhpcz8uX3VucmVnaXN0ZXJlZEFwcCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zdCBsaXN0ZW5zRm9yID0gdGhpcy5fdW5yZWdpc3RlcmVkQXBwPy5pbnRlcm9wPy5pbnRlbnRzPy5saXN0ZW5zRm9yO1xuXG5cdFx0XHRcdGlmICghaXNFbXB0eShpbnRlbnROYW1lKSAmJiAoaXNFbXB0eShsaXN0ZW5zRm9yKSB8fCBpc0VtcHR5KGxpc3RlbnNGb3JbaW50ZW50TmFtZV0pKSkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChcblx0XHRcdFx0XHQhaXNFbXB0eShjb250ZXh0VHlwZSkgJiZcblx0XHRcdFx0XHQhaXNFbXB0eShsaXN0ZW5zRm9yKSAmJlxuXHRcdFx0XHRcdCFpc0VtcHR5KGludGVudE5hbWUpICYmXG5cdFx0XHRcdFx0IWxpc3RlbnNGb3JbaW50ZW50TmFtZV0uY29udGV4dHMuaW5jbHVkZXMoY29udGV4dFR5cGUpXG5cdFx0XHRcdCkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGluc3RhbmNlcyA9IGF3YWl0IHRoaXMuX2NsaWVudFJlZ2lzdHJhdGlvbkhlbHBlci5maW5kQXBwSW5zdGFuY2VzKFxuXHRcdFx0XHRcdHsgYXBwSWQ6IHRoaXMuX3VucmVnaXN0ZXJlZEFwcC5hcHBJZCB9LFxuXHRcdFx0XHRcdGNsaWVudElkZW50aXR5LFxuXHRcdFx0XHRcdFwiaW50ZW50XCJcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRyZXR1cm4gaW5zdGFuY2VzLmxlbmd0aCA+IDA7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogR2V0IGFuIGFwcGxpY2F0aW9uIGlkZW50aXR5LlxuXHRcdFx0ICogQHBhcmFtIG1ldGFkYXRhIFRoZSBtZXRhZGF0YSBmb3IgdGhlIGFwcC5cblx0XHRcdCAqIEByZXR1cm5zIFRoZSBhcHAgaWRlbnRpZmllci5cblx0XHRcdCAqL1xuXHRcdFx0cHJpdmF0ZSBnZXRBcHBsaWNhdGlvbklkZW50aXR5KFxuXHRcdFx0XHRtZXRhZGF0YTogT3BlbkZpbi5JbnRlbnRNZXRhZGF0YTxJbnRlbnRUYXJnZXRNZXRhRGF0YT4gfCB1bmRlZmluZWRcblx0XHRcdCk6IEFwcElkZW50aWZpZXIgfCB1bmRlZmluZWQge1xuXHRcdFx0XHRjb25zdCB0YXJnZXQgPSBtZXRhZGF0YT8udGFyZ2V0O1xuXHRcdFx0XHRpZiAoaXNFbXB0eSh0YXJnZXQpKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChpc1N0cmluZyh0YXJnZXQpKSB7XG5cdFx0XHRcdFx0aWYgKHRhcmdldC50cmltKCkubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4geyBhcHBJZDogdGFyZ2V0IH07XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoaXNFbXB0eSh0YXJnZXQuYXBwSWQpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiB7IGFwcElkOiB0YXJnZXQuYXBwSWQsIGluc3RhbmNlSWQ6IHRhcmdldC5pbnN0YW5jZUlkIH07XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogRG9lcyB0aGUgYXBwIHVzZSBhcHBsaWNhdGlvbiBpZGVudGl0eS5cblx0XHRcdCAqIEBwYXJhbSBjbGllbnRJZGVudGl0eSBUaGUgY2xpZW50IGFwcCB0byBjaGVjay5cblx0XHRcdCAqIEByZXR1cm5zIFRydWUgaWYgdGhlIGFwcCB1c2VzIGFwcGxpY2F0aW9uIGlkZW50aXR5LlxuXHRcdFx0ICovXG5cdFx0XHRwcml2YXRlIHVzZXNBcHBsaWNhdGlvbklkZW50aXR5KGNsaWVudElkZW50aXR5OiBPcGVuRmluLkNsaWVudElkZW50aXR5KTogYm9vbGVhbiB7XG5cdFx0XHRcdGNvbnN0IGFwaU1ldGFkYXRhID0gdGhpcy5fY2xpZW50UmVnaXN0cmF0aW9uSGVscGVyLmdldEFwaVZlcnNpb24oY2xpZW50SWRlbnRpdHkpO1xuXHRcdFx0XHRpZiAoaXNFbXB0eShhcGlNZXRhZGF0YSkpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGFwaU1ldGFkYXRhLnR5cGUgPT09IFwiZmRjM1wiICYmIGFwaU1ldGFkYXRhLnZlcnNpb24gPT09IFwiMi4wXCI7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogTG9va3VwIGFuIGFwcGxpY2F0aW9uIGlkZW50aXR5LlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgaWRlbnRpdHkgdG8gdXNlLlxuXHRcdFx0ICogQHJldHVybnMgVGhlIGFwcGxpY2F0aW9uIGlkZW50aXR5LlxuXHRcdFx0ICovXG5cdFx0XHRwcml2YXRlIGFzeW5jIGxvb2t1cEFwcElkKGNsaWVudElkZW50aXR5OiBPcGVuRmluLkNsaWVudElkZW50aXR5KTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcblx0XHRcdFx0Y29uc3QgbmFtZVBhcnRzID0gY2xpZW50SWRlbnRpdHkubmFtZS5zcGxpdChcIi9cIik7XG5cdFx0XHRcdGxldCBhcHA6IFBsYXRmb3JtQXBwIHwgdW5kZWZpbmVkO1xuXG5cdFx0XHRcdGlmIChuYW1lUGFydHMubGVuZ3RoID09PSAxIHx8IG5hbWVQYXJ0cy5sZW5ndGggPT09IDIpIHtcblx0XHRcdFx0XHRhcHAgPSBhd2FpdCBnZXRBcHAobmFtZVBhcnRzWzBdKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAobmFtZVBhcnRzLmxlbmd0aCA+IDIpIHtcblx0XHRcdFx0XHRhcHAgPSBhd2FpdCBnZXRBcHAoYCR7bmFtZVBhcnRzWzBdfS8ke25hbWVQYXJ0c1sxXX1gKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGFwcE5vdEZvdW5kID0gaXNFbXB0eShhcHApO1xuXG5cdFx0XHRcdGlmIChhcHBOb3RGb3VuZCAmJiBjbGllbnRJZGVudGl0eS51dWlkICE9PSBmaW4ubWUuaWRlbnRpdHkudXVpZCkge1xuXHRcdFx0XHRcdGxvZ2dlci53YXJuKFxuXHRcdFx0XHRcdFx0XCJMb29rdXAgbWFkZSBieSBhIG5vbi1yZWdpc3RlcmVkIGFwcCB0aGF0IGlzIG91dHNpZGUgb2YgdGhpcyBwbGF0Zm9ybS5cIixcblx0XHRcdFx0XHRcdGNsaWVudElkZW50aXR5XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoYXBwTm90Rm91bmQgJiYgaXNFbXB0eSh0aGlzLl91bnJlZ2lzdGVyZWRBcHApKSB7XG5cdFx0XHRcdFx0bG9nZ2VyLndhcm4oXG5cdFx0XHRcdFx0XHRcIkxvb2t1cCBtYWRlIGJ5IGEgbm9uLXJlZ2lzdGVyZWQgYXBwIHRoYXQgZmFsbHMgdW5kZXIgdGhpcyBwbGF0Zm9ybS4gTm8gdW5yZWdpc3RlcmVkIHBsYWNlaG9sZGVyIGFwcCBpcyBzcGVjaWZpZWQuXCIsXG5cdFx0XHRcdFx0XHRjbGllbnRJZGVudGl0eVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGFwcE5vdEZvdW5kKSB7XG5cdFx0XHRcdFx0YXBwID0gdGhpcy5fdW5yZWdpc3RlcmVkQXBwO1xuXHRcdFx0XHRcdGxvZ2dlci5pbmZvKFwiQXNzaWduZWQgdGhlIGZvbGxvd2luZyB1bnJlZ2lzdGVyZWQgYXBwIHRvIHJlcHJlc2VudCB0aGUgYXBwLlwiLCBhcHApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBhcHA/LmFwcElkO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFByb2Nlc3MgYSBjb250ZXh0LlxuXHRcdFx0ICogQHBhcmFtIGNvbnRleHQgVGhlIGNvbnRleHQgdG8gcHJvY2Vzcy5cblx0XHRcdCAqIEByZXR1cm5zIFRoZSBwcm9jZXNzZWQgY29udGV4dC5cblx0XHRcdCAqL1xuXHRcdFx0cHJpdmF0ZSBhc3luYyBwcm9jZXNzQ29udGV4dChjb250ZXh0OiBPcGVuRmluLkNvbnRleHQpOiBQcm9taXNlPE9wZW5GaW4uQ29udGV4dD4ge1xuXHRcdFx0XHRpZiAoaXNFbXB0eShlbmRwb2ludENsaWVudCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gY29udGV4dDtcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBlbmRwb2ludElkID0gYGludGVyb3Bicm9rZXIucHJvY2Vzcy4ke2NvbnRleHQudHlwZX1gO1xuXHRcdFx0XHRpZiAoZW5kcG9pbnRDbGllbnQuaGFzRW5kcG9pbnQoZW5kcG9pbnRJZCkpIHtcblx0XHRcdFx0XHRsb2dnZXIuaW5mbyhgUHJvY2Vzc2luZyBjb250ZXh0ICR7Y29udGV4dC50eXBlfSB3aXRoIGVuZHBvaW50ICR7ZW5kcG9pbnRJZH1gKTtcblx0XHRcdFx0XHRjb25zdCBwcm9jZXNzZWRDb250ZXh0ID0gYXdhaXQgZW5kcG9pbnRDbGllbnQucmVxdWVzdFJlc3BvbnNlPENvbnRleHRUb1Byb2Nlc3MsIFByb2Nlc3NlZENvbnRleHQ+KFxuXHRcdFx0XHRcdFx0ZW5kcG9pbnRJZCxcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0Y29udGV4dFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0aWYgKHByb2Nlc3NlZENvbnRleHQ/LmNvbnRleHQpIHtcblx0XHRcdFx0XHRcdHJldHVybiBwcm9jZXNzZWRDb250ZXh0Py5jb250ZXh0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gY29udGV4dDtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBHZXQgdGhlIGNvbnRleHQgbWV0YWRhdGEgZm9yIGEgY2xpZW50IGlkZW50aXR5LlxuXHRcdFx0ICogQHBhcmFtIGNsaWVudElkZW50aXR5IFRoZSBjbGllbnQgaWRlbnRpdHkuXG5cdFx0XHQgKiBAcmV0dXJucyBUaGUgY29udGV4dCBtZXRhZGF0YS5cblx0XHRcdCAqL1xuXHRcdFx0cHJpdmF0ZSBhc3luYyBnZXRDb250ZXh0TWV0YWRhdGEoY2xpZW50SWRlbnRpdHk6IE9wZW5GaW4uQ2xpZW50SWRlbnRpdHkpOiBQcm9taXNlPENvbnRleHRNZXRhZGF0YT4ge1xuXHRcdFx0XHRjb25zdCBhcHBJZCA9IChhd2FpdCB0aGlzLmxvb2t1cEFwcElkKGNsaWVudElkZW50aXR5KSkgPz8gY2xpZW50SWRlbnRpdHkubmFtZTtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzb3VyY2U6IHtcblx0XHRcdFx0XHRcdGFwcElkLFxuXHRcdFx0XHRcdFx0aW5zdGFuY2VJZDogY2xpZW50SWRlbnRpdHkuZW5kcG9pbnRJZFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9O1xufVxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwidmFsdWUiLCJpc1N0cmluZyIsInRyaW0iLCJsZW5ndGgiLCJmb3JtYXRFcnJvciIsImVyciIsIkVycm9yIiwibWVzc2FnZSIsIkFycmF5IiwiaXNBcnJheSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtYXBUb0FwcE1ldGFEYXRhIiwiYXBwIiwiaWNvbnMiLCJpbWFnZXMiLCJpY29uIiwic3JjIiwicHVzaCIsImltYWdlIiwiYXBwSWQiLCJkZXNjcmlwdGlvbiIsIm5hbWUiLCJ0aXRsZSIsInRvb2x0aXAiLCJ2ZXJzaW9uIiwicmVzdWx0VHlwZSIsInNjcmVlbnNob3RzIiwiT1BFTl9FUlJPUiIsIlJFU09MVkVfRVJST1IiLCJNQU5JRkVTVF9UWVBFUyIsImFzeW5jIiwiZ2V0SWRlbnRpdHlCb3VuZHMiLCJjbGllbnRJZGVudGl0eSIsImJvdW5kcyIsImN1cnJlbnRXaW5kb3ciLCJ0YXJnZXRWaWV3IiwiZmluIiwiVmlldyIsIndyYXBTeW5jIiwiZ2V0Q3VycmVudFdpbmRvdyIsInRhcmdldFdpbmRvdyIsIldpbmRvdyIsImdldEJvdW5kcyIsIm1lIiwiZmluZE1vbml0b3JDb250YWluaW5nUG9pbnQiLCJwb2ludCIsIm1vbml0b3JJbmZvIiwiU3lzdGVtIiwiZ2V0TW9uaXRvckluZm8iLCJ4IiwieSIsIm1vbml0b3IiLCJub25QcmltYXJ5TW9uaXRvcnMiLCJwb2ludEluUmVjdCIsIm1vbml0b3JSZWN0IiwicHJpbWFyeU1vbml0b3IiLCJyZWN0IiwibGVmdCIsInJpZ2h0IiwidG9wIiwiYm90dG9tIiwiZ2V0V2luZG93UG9zaXRpb25Vc2luZ1N0cmF0ZWd5Iiwid2luZG93UG9zaXRpb25pbmdPcHRpb25zIiwicmVsYXRlZFRvIiwiZGlzYWJsZVdpbmRvd1Bvc2l0aW9uaW5nU3RyYXRlZ3kiLCJ0YXJnZXRNb25pdG9yIiwid2luZG93RGVmYXVsdExlZnQiLCJkZWZhdWx0cyIsIndpbmRvd0RlZmF1bHRUb3AiLCJhdmFpbGFibGVMZWZ0IiwiYXZhaWxhYmxlUmVjdCIsImF2YWlsYWJsZVRvcCIsIndpbmRvd09mZnNldHNYIiwid2luZG93UG9zaXRpb25pbmdTdHJhdGVneSIsIndpbmRvd09mZnNldHNZIiwid2luZG93T2Zmc2V0c01heEluY3JlbWVudHMiLCJtYXhJbmNyZW1lbnRzIiwidmlzaWJsZVdpbmRvd3MiLCJwbGF0Zm9ybSIsIlBsYXRmb3JtIiwiZ2V0Q3VycmVudFN5bmMiLCJ3aW5kb3dzIiwiQXBwbGljYXRpb24iLCJnZXRDaGlsZFdpbmRvd3MiLCJhdmFpbGFibGVXaW5kb3dzIiwiaXNTaG93aW5nIiwiZ2V0QWxsVmlzaWJsZVdpbmRvd3MiLCJ0b3BMZWZ0Qm91bmRzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsIndpbiIsIm1pbkNvdW50VmFsIiwibWluQ291bnRJbmRleCIsImkiLCJsZWZ0UG9zIiwidG9wUG9zIiwiZm91bmRXaW5zIiwiZmlsdGVyIiwidG9wTGVmdFdpbkJvdW5kcyIsIkFwcEludGVudEhlbHBlciIsImNvbnN0cnVjdG9yIiwiZ2V0QXBwcyIsImxvZ2dlciIsInRoaXMiLCJfZ2V0QXBwcyIsIl9sb2dnZXIiLCJnZXRBcHBzQnlJbnRlbnQiLCJpbnRlbnQiLCJsaXN0ZW5zRm9yIiwiaW50ZXJvcCIsImludGVudHMiLCJpbnRlbnROYW1lcyIsImtleXMiLCJpbnRlbnROYW1lIiwidG9Mb3dlckNhc2UiLCJnZXRJbnRlbnQiLCJjb250ZXh0VHlwZSIsImFwcHMiLCJ3YXJuIiwiaW50ZW50c01hcCIsImFwcEludGVudCIsImFwcEludGVudENvbnRhaW5zIiwidXBkYXRlQXBwSW50ZW50c01hcCIsImRpc3BsYXlOYW1lIiwicmVzdWx0cyIsInZhbHVlcyIsImluZm8iLCJnZXRJbnRlbnRzQnlDb250ZXh0Iiwic3VwcG9ydGVkSW50ZW50cyIsInN1cHBvcnRlZEludGVudCIsImNvbnRleHRzIiwiaW5jbHVkZXMiLCJDbGllbnRSZWdpc3RyYXRpb25IZWxwZXIiLCJsb29rdXBBcHBJZCIsIl9sb29rdXBBcHBJZCIsIl9jbGllbnRSZWFkeVJlcXVlc3RzIiwiX3RyYWNrZWRDbGllbnRDb25uZWN0aW9ucyIsIl90cmFja2VkQ29udGV4dEhhbmRsZXJzIiwiX3RyYWNrZWRJbnRlbnRIYW5kbGVycyIsImNsaWVudERpc2Nvbm5lY3RlZCIsImVudHJpZXMiLCJlbnRyeSIsImVuZHBvaW50SWQiLCJyZW1vdmVUcmFja2VkQ2xpZW50Q29ubmVjdGlvbiIsImludGVudEhhbmRsZXJSZWdpc3RlcmVkIiwicGF5bG9hZCIsImhhbmRsZXJJZCIsInJlcGxhY2UiLCJ0cmFja2VkSW50ZW50SGFuZGxlciIsImZpbmQiLCJmZGMzVmVyc2lvbiIsImNsaWVudFJlYWR5S2V5IiwiZ2V0Q2xpZW50UmVhZHlLZXkiLCJjb250ZXh0SGFuZGxlclJlZ2lzdGVyZWQiLCJjb250ZXh0VHlwZU5hbWUiLCJ0cmFja2VkQ29udGV4dEhhbmRsZXIiLCJjbGllbnRDb25uZWN0aW9uUmVnaXN0ZXJlZCIsImlkIiwidXVpZCIsImFwaVZlcnNpb24iLCJpZGVudGl0eSIsInBheWxvYWRBcGlWZXJzaW9uIiwidHlwZSIsImNvbm5lY3Rpb25VcmwiLCJlbnRpdHlUeXBlIiwiY2FwdHVyZVZpZXdBcGlVc2FnZSIsImNhcHR1cmVXaW5kb3dBcGlVc2FnZSIsImJyb2tlckNsaWVudENvbm5lY3Rpb24iLCJhcGlNZXRhZGF0YSIsImdldFJlZ2lzdGVyZWRDb250ZXh0SGFuZGxlciIsImluc3RhbmNlSWQiLCJ0cmFja2VkSGFuZGxlciIsImZpbmRBcHBJbnN0YW5jZXMiLCJlbmRwb2ludEFwcHMiLCJnZXRBcGlWZXJzaW9uIiwib25Db25uZWN0aW9uQ2xpZW50UmVhZHkiLCJ0aW1lb3V0IiwicmVzb2x2ZSIsInJlamVjdCIsImdldENsaWVudElkZW50aXR5IiwidGltZXJJZCIsInNldFRpbWVvdXQiLCJjbGVhclRpbWVvdXQiLCJvbkludGVudENsaWVudFJlYWR5IiwicmVnaXN0ZXJlZEhhbmRsZXJzIiwiZXhpc3RpbmdJbnN0YW5jZUlkIiwiaGFuZGxlciIsIm9uQ29udGV4dENsaWVudFJlYWR5IiwiY29udGV4dFJlZ2lzdGVyZWRIYW5kbGVycyIsImdsb2JhbFJlZ2lzdGVyZWRIYW5kbGVycyIsImV4aXN0aW5nQ29udGV4dEhhbmRsZXJJbnN0YW5jZUlkIiwiY29udGV4dEtleSIsImdsb2JhbEtleSIsImhhc0NvbnRleHRSZXF1ZXN0IiwiaGFzR2xvYmFsUmVxdWVzdCIsImlzUmVzb2x2ZWQiLCJ0YXJnZXQiLCJvcHRpb25zIiwiZ2V0T3B0aW9ucyIsImZkYzNJbnRlcm9wQXBpIiwiSW50ZW50UmVzb2x2ZXJIZWxwZXIiLCJpbnRlbnRSZXNvbHZlck9wdGlvbnMiLCJ1bnJlZ2lzdGVyZWRBcHBJZCIsIl9kZWZhdWx0SW50ZW50UmVzb2x2ZXJIZWlnaHQiLCJfZGVmYXVsdEludGVudFJlc29sdmVyV2lkdGgiLCJfaW50ZW50UmVzb2x2ZXJPcHRpb25zIiwiaGVpZ2h0Iiwid2lkdGgiLCJsYXVuY2hJbnRlbnRSZXNvbHZlciIsImxhdW5jaE9wdGlvbnMiLCJwb3NpdGlvbiIsImRpbWVuc2lvbnMiLCJib3VuZHNDZW50ZXIiLCJib3VuZHNDZW50ZXJYIiwiYm91bmRzQ2VudGVyWSIsImhhbGZXaWR0aCIsImhhbGZIZWlnaHQiLCJNYXRoIiwicm91bmQiLCJnZXRCb3VuZHNDZW50ZXIiLCJjb250ZW50RGltZW5zaW9ucyIsImRpdmlkZWRSZWN0V2lkdGgiLCJkaXZpZGVkUmVjdEhlaWdodCIsImRpdmlkZWREaW1lbnNpb25XaWR0aCIsImRpdmlkZWREaW1lbnNpb25IZWlnaHQiLCJjZW50ZXJDb250ZW50SW5SZWN0IiwiY2VudGVyQ29udGVudEluSWRlbnRpdHkiLCJ3aW5PcHRpb24iLCJpbmNsdWRlSW5TbmFwc2hvdHMiLCJkZWZhdWx0V2lkdGgiLCJkZWZhdWx0SGVpZ2h0Iiwic2hvd1Rhc2tiYXJJY29uIiwic2F2ZVdpbmRvd1N0YXRlIiwiY3VzdG9tRGF0YSIsIl91bnJlZ2lzdGVyZWRBcHBJZCIsInVybCIsImZyYW1lIiwiYXV0b1Nob3ciLCJhbHdheXNPblRvcCIsImRlZmF1bHRDZW50ZXJlZCIsImRlZmF1bHRMZWZ0IiwiZGVmYXVsdFRvcCIsIndlYldpbmRvd1Jlc29sdmVyIiwiY3JlYXRlIiwiZ2V0V2ViV2luZG93IiwiZ2V0SW50ZW50U2VsZWN0aW9uIiwiZXJyb3IiLCJlbnRyeVBvaW50cyIsImludGVyb3BPdmVycmlkZSIsImluaXRpYWxpemUiLCJsb2dnZXJDcmVhdG9yIiwiaGVscGVycyIsIl9kZWZpbml0aW9uIiwibG9nZ2VyTmFtZSIsImRhdGEiLCJfaGVscGVycyIsImNsb3NlZG93biIsImdldENvbnN0cnVjdG9yT3ZlcnJpZGUiLCJnZXRBcHAiLCJsYXVuY2hBcHAiLCJlbmRwb2ludENsaWVudCIsImdldEVuZHBvaW50Q2xpZW50IiwibGF1bmNoIiwiQmFzZSIsInN1cGVyIiwiX2FwcEludGVudEhlbHBlciIsIl9jbGllbnRSZWdpc3RyYXRpb25IZWxwZXIiLCJfbWV0YWRhdGFLZXkiLCJnbG9iYWxUaGlzIiwiY3J5cHRvIiwicmFuZG9tVVVJRCIsImMiLCJybmQiLCJnZXRSYW5kb21WYWx1ZXMiLCJVaW50OEFycmF5IiwiTnVtYmVyIiwidG9TdHJpbmciLCJpbnRlbnRSZXNvbHZlciIsIl9pbnRlbnRSZXNvbHZlckhlbHBlciIsInVucmVnaXN0ZXJlZEFwcCIsIl9vcGVuT3B0aW9ucyIsIm9wZW5PcHRpb25zIiwiX3VucmVnaXN0ZXJlZEFwcCIsIm1hbmlmZXN0VHlwZSIsImlzQ29ubmVjdGlvbkF1dGhvcml6ZWQiLCJhcGlQYXlsb2FkIiwiaXNDb25uZWN0aW9uVmFsaWQiLCJyZXNwb25zZSIsImlzVmFsaWQiLCJzZXRDb250ZXh0Iiwic2VudENvbnRleHQiLCJjb250ZXh0IiwicHJvY2Vzc0NvbnRleHQiLCJjb250ZXh0TWV0YWRhdGEiLCJnZXRDb250ZXh0TWV0YWRhdGEiLCJpbnZva2VDb250ZXh0SGFuZGxlciIsInBhc3NlZENvbnRleHQiLCJoYW5kbGVJbmZvRm9ySW50ZW50c0J5Q29udGV4dCIsImNvbnRleHRPcHRpb25zIiwicmVxdWVzdGVkQ29udGV4dFR5cGUiLCJyZXF1ZXN0ZWRSZXN1bHRUeXBlIiwicmVxdWVzdCIsIm1ldGFkYXRhIiwiaXNGREMzMiIsImhhbmRsZUluZm9Gb3JJbnRlbnQiLCJpbnRlbnRPcHRpb25zIiwib3B0Q29udGV4dFR5cGUiLCJyZXN1bHQiLCJoYW5kbGVGaXJlZEludGVudEZvckNvbnRleHQiLCJjb250ZXh0Rm9ySW50ZW50IiwidGFyZ2V0QXBwSWRlbnRpZmllciIsImdldEFwcGxpY2F0aW9uSWRlbnRpdHkiLCJ1c2VzQXBwSWRlbnRpdHkiLCJ1c2VzQXBwbGljYXRpb25JZGVudGl0eSIsImludGVudHNGb3JTZWxlY3Rpb24iLCJ0YXJnZXRBcHAiLCJzb21lIiwibGlzdGVuZWRGb3JJbnRlbnQiLCJoYW5kbGVUYXJnZXRlZEludGVudCIsInNoYXBlSW50ZW50UmVzb2x2ZXIiLCJ1bnJlZ2lzdGVyZWRBcHBJbnRlbnRzIiwiZ2V0VW5yZWdpc3RlcmVkQXBwSW50ZW50QnlDb250ZXh0IiwibWF0Y2hlZEludGVudHMiLCJpbnRlbnRGb3JTZWxlY3Rpb24iLCJtaXNzaW5nSW50ZW50TWF0Y2hlcyIsIm1pc3NpbmdJbnRlbnRNYXRjaCIsIm1pc3NpbmdJbnRlbnQiLCJ1c2VyU2VsZWN0aW9uIiwiY3JlYXRlTmV3SW5zdGFuY2UiLCJsYXVuY2hBcHBXaXRoSW50ZW50IiwidW5kZWZpbmVkIiwiaGFuZGxlSW50ZW50UGlja2VyU2VsZWN0aW9uIiwiaGFuZGxlRmlyZWRJbnRlbnQiLCJ1c2VzQXBwSWRlbnRpZmllciIsImludGVudEFwcHMiLCJjYW5BZGRVbnJlZ2lzdGVyZWRBcHAiLCJhcHBJbnN0YW5jZXMiLCJhcHBJbnN0YW5jZUlkIiwidXNlU2luZ2xlSW5zdGFuY2UiLCJpbnZva2VJbnRlbnRIYW5kbGVyIiwiZmRjM0hhbmRsZU9wZW4iLCJmZGMzT3Blbk9wdGlvbnMiLCJyZXF1ZXN0ZWRJZCIsInBsYXRmb3JtSWRlbnRpdGllcyIsImZvY3VzQXBwIiwicmVxdWVzdGVkQXBwIiwiY2xpZW50SW5mbyIsImdldEFsbENsaWVudEluZm8iLCJjb25uZWN0ZWRDbGllbnQiLCJvcGVuU3RyYXRlZ3kiLCJvcGVuQXBwSW50ZW50Iiwic291cmNlIiwibGF1bmNoUHJlZmVyZW5jZSIsIndpbmRvd1Bvc2l0aW9uT3B0aW9ucyIsIm9wZW5UaW1lb3V0IiwiY29ubmVjdGlvblRpbWVvdXQiLCJjb250ZXh0VGltZW91dCIsImludGVudFRpbWVvdXQiLCJjbGllbnRSZWFkeUluc3RhbmNlSWQiLCJjb250ZXh0VG9QYXNzIiwidXBkYXRlZENvbnRleHQiLCJicmluZ0FwcFRvRnJvbnQiLCJvcGVuRXJyb3IiLCJmZGMzSGFuZGxlRmluZEluc3RhbmNlcyIsImZkYzNIYW5kbGVHZXRBcHBNZXRhZGF0YSIsInBsYXRmb3JtQXBwIiwiYXBwTWV0YURhdGEiLCJjbGllbnQiLCJwcmV2aWV3IiwiaW5zdGFuY2VXaW5kb3ciLCJnZXRJbmZvIiwiZ2V0UHJldmlld0ltYWdlIiwiaW5zdGFuY2VWaWV3IiwiY29udGVudCIsImluc3RhbmNlTWV0YWRhdGEiLCJmZGMzSGFuZGxlR2V0SW5mbyIsImFwcE1ldGFkYXRhIiwiZXhpc3RpbmdJbnN0YW5jZSIsImludGVudFJlYWR5RXJyb3IiLCJzZXRJbnRlbnRUYXJnZXQiLCJicmluZ1RvRnJvbnRFcnJvciIsInNlbGVjdGVkQXBwIiwidGFyZ2V0QnlDb250ZXh0IiwiYXZhaWxhYmxlQXBwSW5zdGFuY2VzIiwiaW50ZW50RW50cnkiLCJjb250ZXh0TWF0Y2giLCJzcGVjaWZpZWRBcHBJbnN0YW5jZXMiLCJsYXVuY2hTaW5nbGVJbnN0YW5jZUFwcCIsImFwcEZvckludGVudCIsImluc3RhbmNlTW9kZSIsImNhcHR1cmVQYWdlIiwiZm9ybWF0IiwicXVhbGl0eSIsInN1cHBvcnRlZEludGVudE5hbWVzIiwibmFtZVBhcnRzIiwic3BsaXQiLCJhcHBOb3RGb3VuZCIsImhhc0VuZHBvaW50IiwicHJvY2Vzc2VkQ29udGV4dCIsInJlcXVlc3RSZXNwb25zZSJdLCJzb3VyY2VSb290IjoiIn0=