var e={};function t(e){return null==e}e.d=(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class o{constructor(e,t,o){this._storageTypeName=t,this._storageKey=`${fin.me.identity.uuid.toLowerCase().replaceAll(" ","")}-${e}`,o&&(this._logger=o("PlatformLocalStorage"))}async get(e){if(!t(e))return this.getCompleteStore()[e];this._logger?.error(`No id was specified for getting a ${this._storageTypeName} entry`)}async set(e,o){if(t(e))this._logger?.error(`You need to provide a id for the ${this._storageTypeName} entry you wish to save`);else{const t=this.getCompleteStore();t[e]=o,this.setCompleteStore(t)}}async getAll(e){const t=this.getCompleteStore();return 0===Object.keys(t).length?(this._logger?.info(`Storage has no ${this._storageTypeName} entries`),{}):t}async remove(e){if(t(e))this._logger?.error(`An id to clear the saved ${this._storageTypeName} was not provided`);else{const o=this.getCompleteStore();t(o[e])?this._logger?.error(`You tried to delete a non-existent ${this._storageTypeName} with id ${e}`):(delete o[e],this.setCompleteStore(o))}}getCompleteStore(){const e=localStorage.getItem(this._storageKey);return t(e)?(this._logger?.info(`Storage has no ${this._storageTypeName} entries. Creating store`),this.setCompleteStore({}),{}):JSON.parse(e)}setCompleteStore(e){localStorage.setItem(this._storageKey,JSON.stringify(e))}}const r={endpoint:new class{constructor(){this._storage={}}async initialize(e,t,o){this._loggerCreator=t,this._logger=t("LocalStorageEndpoint"),this._logger.info("Was passed the following options",e.data)}async action(e,o){if(t(o))return this._logger?.warn(`A request is required for this action: ${e.id}. Returning false`),!1;if("module"!==e.type)return this._logger?.warn(`We only expect endpoints of type module. Unable to perform action: ${e.id}`),!1;if(t(e.options))return this._logger?.warn(`The endpoint definition options are required for this action: ${e.id}`),!1;const{dataType:r,method:i}=e.options,s=this.getStorage(r);if("REMOVE"===i){const e=o.id;return await s.remove(e),!0}return"SET"===i&&(t(o.metaData)?(this._logger?.warn(`The metaData needs to be specified for this action: ${e.id}`),!1):t(o.payload)?(this._logger?.warn(`The payload needs to be specified for this action: ${e.id}`),!1):(await s.set(o.id,{metaData:o.metaData,payload:o.payload}),!0))}async requestResponse(e,o){if("module"!==e.type)return void this._logger?.warn(`We only expect endpoints of type module. Unable to action request/response for: ${e.id}`);if(t(e.options))return this._logger?.warn(`The endpoint definition options are required for this action: ${e.id}`),!1;const{dataType:r,method:i}=e.options,s=this.getStorage(r);if("GET"===i){const e=o?.id;return t(e)?s.getAll():s.get(e)}}getStorage(e){let r=this._storage[e];return t(r)&&(r=new o(e,e,this._loggerCreator),this._storage[e]=r),r}}};export{r as entryPoints};
//# sourceMappingURL=local-storage.bundle.js.map