var t,e={};function o(t){return null==t}async function n(t){const e=await fin.System.getMonitorInfo(),n=t.x,a=t.y;if(!o(n)&&!o(a))for(const t of e.nonPrimaryMonitors)if(i({x:n,y:a},t.monitorRect))return t;return e.primaryMonitor}function i(t,e){return t.x>=e.left&&t.x<=e.right&&t.y>=e.top&&t.y<=e.bottom}async function a(t,e){if(!0===t?.disableWindowPositioningStrategy)return;let i;if(o(e))i=(await fin.System.getMonitorInfo()).primaryMonitor;else if(!o(e)&&"monitorRect"in e)i=e;else if(!o(e)&&"x"in e)i=await n(e);else{const t=await async function(t){let e,n;try{const e=fin.View.wrapSync(t);n=await e.getCurrentWindow()}catch{}if(o(e))try{const o=n??fin.Window.wrapSync(t);e=await o.getBounds()}catch{}if(o(e))try{e=await fin.me.getBounds()}catch{}return e}(e);i=o(t)?(await fin.System.getMonitorInfo()).primaryMonitor:await n({x:t.left,y:t.top})}const a=t?.defaults?.left??0,r=t?.defaults?.top??0,s=i.availableRect.left,l=i.availableRect.top,p=t?.windowPositioningStrategy?.x??30,c=t?.windowPositioningStrategy?.y??30,u=t?.windowPositioningStrategy?.maxIncrements??8,f=await async function(){const t=fin.Platform.getCurrentSync(),e=await t.Application.getChildWindows(),o=[];for(const t of e)try{await t.isShowing()&&o.push(t)}catch{}return o}(),y=await Promise.all(f.map(async t=>{try{const e=await t.getBounds();return{left:e.left,top:e.top,right:e.left+p,bottom:e.top+c}}catch{return{left:0,top:0,right:0,bottom:0}}}));let h=1e3,g=u;for(let t=0;t<u;t++){const e=a+t*p,o=r+t*c,n=y.filter(t=>t.left>=e+s&&t.right<=e+p+s&&t.top>=o+l&&t.bottom<=o+c+l);n.length<h&&(h=n.length,g=t)}return{left:a+g*p+s,top:r+g*c+l}}e.d=(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},e.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),function(t){t.CustomButton="CustomButton",t.StoreCustomButton="StoreCustomButton",t.CustomDropdownItem="CustomDropdownItem",t.GlobalContextMenu="GlobalContextMenu",t.ViewTabContextMenu="ViewTabContextMenu",t.PageTabContextMenu="PageTabContextMenu",t.SaveButtonContextMenu="SaveButtonContextMenu",t.API="API"}(t||(t={}));const r={actions:new class{async initialize(t,e,o){this._logger=e("FavoritesMenuProvider"),this._helpers=o,this._settings=t.data,this._logger.info("Initializing")}async get(e){const n={};return n["favorites-menu"]=async e=>{if(e.callerType===t.CustomButton&&this._helpers){const t=this._helpers?.getFavoriteClient;if(!o(t)){const n=await t();if(!o(n)){const t=n.getInfo(),i=[];if(t.enabledTypes){let e=!1;for(const o of t.enabledTypes){const t=await n.getSavedFavorites(o);if(t&&t.length>0){e&&i.push({type:"separator"}),t.sort((t,e)=>(t.label??"").localeCompare(e.label??""));for(const e of t)i.push({label:e.label??"",icon:e.icon,data:e});e=!0}}}const r=await this._helpers.getMenuClient(),s=this._settings?.popupMenuStyle??r.getPopupMenuStyle(),l=await r.showPopupMenu({x:e.x,y:48},e.windowIdentity,"There are no favorites",i,{popupMenuStyle:s});if(o(l))this._logger?.info("Favorites Menu Dismissed");else if(this._logger?.info("Favorites Menu Item Selected",l),"app"===l.type){if(!o(this._helpers?.launchApp)){let t;const n=await a(void 0,e.windowIdentity);o(n)||(t={bounds:n}),await(this._helpers?.launchApp(l.typeId,t))}}else"page"===l.type?o(this._helpers?.launchPage)||await(this._helpers?.launchPage(l.typeId,void 0,this._logger)):"workspace"===l.type?o(this._helpers?.launchWorkspace)||await(this._helpers?.launchWorkspace(l.typeId)):this._logger?.info(`Favorites Type ${l.type} no yet supported`,l)}}}},n}}};export{r as entryPoints};
//# sourceMappingURL=favorites-menu.bundle.js.map