{"version":3,"file":"excel.bundle.js","mappings":"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","sources":["webpack://openfin-workspace--integrate-with-excel/../../node_modules/@openfin/excel/openfin.excel.mjs","webpack://openfin-workspace--integrate-with-excel/./client/src/excel.ts","webpack://openfin-workspace--integrate-with-excel/webpack/bootstrap","webpack://openfin-workspace--integrate-with-excel/webpack/runtime/define property getters","webpack://openfin-workspace--integrate-with-excel/webpack/runtime/hasOwnProperty shorthand","webpack://openfin-workspace--integrate-with-excel/webpack/runtime/make namespace object","webpack://openfin-workspace--integrate-with-excel/./client/src/excel-window.ts"],"sourcesContent":["var e,t,r={d:(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},a={};r.d(a,{dq:()=>AdapterError,MS:()=>ApiError,xQ:()=>EventError,sO:()=>We,Zu:()=>fe,I3:()=>$e,$U:()=>Ge,i0:()=>Ie,cX:()=>InitializationError,gH:()=>InvalidCellRangeAddressError,_W:()=>ParameterError,U$:()=>i,U7:()=>l,rd:()=>be});class ApiError extends Error{constructor(e=\"An unexpected error has occurred\",t){var r;super(e),t&&(this.innerError=t&&t),this.stack=null===(r=this.stack)||void 0===r?void 0:r.replace(/^(\\w*Error)/,`${this.constructor.name}`)}}class AdapterError extends ApiError{constructor(e=\"Failed to execute adapter function\",t){super(e,t)}}class EventError extends ApiError{constructor(e=\"Failed to raise event\",t){super(e,t)}}class InitializationError extends ApiError{constructor(e=\"Failed to initialize adapter\",t){super(e,t)}}class InvalidCellRangeAddressError extends ApiError{constructor(e=\"The cell range address is not valid\",t){super(e,t)}}class ParameterError extends ApiError{constructor(e=\"Invalid parameter value\",t){super(e,t)}}!function(e){e.ActivateWorkbook=\"ActivateWorkbook\",e.ActivateWorksheet=\"ActivateWorksheet\",e.AddWorksheet=\"AddWorksheet\",e.CalculateWorkbook=\"CalculateWorkbook\",e.CalculateWorksheet=\"CalculateWorksheet\",e.ClearAllCells=\"ClearAllCells\",e.ClearAllCellValues=\"ClearAllCellValues\",e.ClearAllCellFormatting=\"ClearAllCellFormatting\",e.ClearCellValues=\"ClearCellValues\",e.ClearCellFormatting=\"ClearCellFormatting\",e.ClearCells=\"ClearCells\",e.CloseWorkbook=\"CloseWorkbook\",e.CreateWorkbook=\"CreateWorkbook\",e.DeleteWorksheet=\"DeleteWorksheet\",e.DeregisterEvent=\"DeregisterEvent\",e.EventFired=\"EventFired\",e.FilterCells=\"FilterCells\",e.GetActiveWorksheet=\"GetActiveWorksheet\",e.GetCalculationMode=\"GetCalculationMode\",e.GetCellNames=\"GetCellNames\",e.GetCells=\"GetCells\",e.GetRangeAddress=\"GetRangeAddress\",e.GetWorkbookById=\"GetWorkbookById\",e.GetWorkbookFilePath=\"GetWorkbookFilePath\",e.GetWorkbookName=\"GetWorkbookName\",e.GetWorkbooks=\"GetWorkbooks\",e.GetWorkbookWindowBounds=\"GetWorkbookWindowBounds\",e.GetWorksheetById=\"GetWorksheetById\",e.GetWorksheetByName=\"GetWorksheetByName\",e.GetWorksheetName=\"GetWorksheetName\",e.GetWorksheets=\"GetWorksheets\",e.LogMessage=\"LogMessage\",e.OpenWorkbook=\"OpenWorkbook\",e.ProtectWorksheet=\"ProtectWorksheet\",e.QuitApplication=\"QuitApplication\",e.RegisterEvent=\"RegisterEvent\",e.SaveWorkbook=\"SaveWorkbook\",e.SaveWorkbookAs=\"SaveWorkbookAs\",e.SetCellValues=\"SetCellValues\",e.SetCellFormatting=\"SetCellFormatting\",e.SetCellName=\"SetCellName\",e.SetWorkbookWindowBounds=\"SetWorkbookWindowBounds\",e.SetWorksheetName=\"SetWorksheetName\"}(e||(e={})),function(e){e.Activate=\"Activate\",e.ActivateWorksheet=\"ActivateWorksheet\",e.AddWorksheet=\"AddWorksheet\",e.Change=\"Change\",e.Close=\"Close\",e.Deactivate=\"Deactivate\",e.DeleteWorksheet=\"DeleteWorksheet\"}(t||(t={}));const o=\"1.5.0\";let n=!1;const s=\"[@openfin/excel]\",i=()=>{n=!1},l=()=>{n=!0,d(`v${o}`)},c=(e,t)=>{n&&(e.innerError?console.error(t?`${s} ${t}`:s,e,\"\\n\\n(inner)\",e.innerError):console.error(t?`${s} ${t}`:s,e))},d=(...e)=>{n&&console.log(s,...e)},h=(...e)=>{n&&console.warn(s,...e)};\"undefined\"==typeof fin&&Object.assign(window,{fin:{}}),Object.assign(fin,{Integrations:{Excel:{enableLogging:l,disableLogging:i}}});const w=new Map,p=async(r,a,o,n,s)=>{if(!a||!a.eventTarget||!a.objectId){const e=new EventError(\"Event registration missing required values\");throw c(e),e}const i=Object.keys(t).find((e=>e.toLowerCase()===o.toLowerCase()));if(!i){const e=new EventError(`Unsupported event name: ${o}`);throw c(e),e}const l=Object.assign({eventName:t[i]},a);d(\"Registering event\",l);try{const t=await r.dispatch(e.RegisterEvent,l),a={handler:s,listener:n};w.set(t,a)}catch(e){throw new AdapterError(void 0,e)}},k=(e,t)=>{const{eventRegistrationId:r}=e,a=w.get(r);if(!a)throw new EventError(`No registered event listener found for id: ${r}`);d(\"Event payload received\",e),a.handler(e)},u=t=>async r=>{let a;for(const[e,t]of w)if(t.listener===r){a=e;break}if(!a)throw new EventError;d(\"Deregistering event:\",a);try{await t.dispatch(e.DeregisterEvent,a),w.delete(a)}catch(e){throw new AdapterError}};var g;!function(e){e.Workbook=\"Workbook\",e.Worksheet=\"Worksheet\",e.CellRange=\"CellRange\"}(g||(g={}));const m=()=>void 0!==crypto.randomUUID?crypto.randomUUID():\"10000000-1000-4000-8000-100000000000\".replace(/[018]/g,(e=>{const t=window.crypto.getRandomValues(new Uint8Array(1))[0]&15>>Number(e)/4;return(Number(e)^t).toString(16)})),C=new Map,y=(e,t)=>async(r,a)=>p(e,t,r,a,W(a)),v=(t,r,a)=>async()=>{d(`Cell range: Clear; address:${a} (${r})`);const o={address:a,objectId:r};try{await t.dispatch(e.ClearCells,o)}catch(e){throw new AdapterError}},b=(t,r,a)=>async()=>{d(`Cell range: Clear formatting; address:${a} (${r})`);const o={address:a,objectId:r};try{await t.dispatch(e.ClearCellFormatting,o)}catch(e){throw new AdapterError}},A=(t,r,a)=>async()=>{d(`Cell range: Clear values; address:${a} (${r})`);const o={address:a,objectId:r};try{await t.dispatch(e.ClearCellValues,o)}catch(e){throw new AdapterError}},E=(e,t,r)=>(a,o=1e3)=>{if(o<=0)throw new ApiError(\"Update interval must be a positive number\");const n=m();d(`Cell range: Create data stream; streamId:${n}; address:${r}; updateInterval:${o} (${t})`);const s={address:r,close:()=>{d(`Closed stream (${n})`),(e=>{var t;try{const r=C.get(e);if(!r)throw new ApiError(`Unable to find registered data stream with id ${e}`);void 0!==(null!==(t=r.timer)&&void 0!==t?t:void 0)&&F(e),C.delete(e)}catch(e){throw c(e),e}})(n)},id:n,start:()=>{d(`Started streaming (${n})`),U(n,a,e,t)},stop:()=>{d(`Stopped streaming (${n})`),F(n)},updateInterval:o,worksheetId:t};return C.set(n,{dataStream:s}),s},W=e=>r=>{var a;try{if((null===(a=r.eventName)||void 0===a?void 0:a.toUpperCase())===t.Change.toUpperCase())return e(r.changedCells);throw new EventError(`Unexpected cell range event: ${r.eventName}`)}catch(e){c(e)}},f=(e,t,r)=>async()=>{d(`Cell range: Get cells; address:${r} (${t})`);const a=await $(e,t,r);return d(`${r}:`,a),a},$=async(t,r,a)=>{const o={address:a,objectId:r};try{return await t.dispatch(e.GetCells,o)}catch(e){throw new AdapterError}},G=(t,r,a)=>async()=>{d(`Cell range: Get name; address:${a} (${r})`);const o={address:a,objectId:r};try{return await t.dispatch(e.GetCellNames,o)}catch(e){throw new AdapterError}},I=(t,r,a)=>async(o,n,s,i,l=!0)=>{d(`Cell range: Set filter; address:${a} (${r})`,{columnIndex:o,filterOperator:n,criteria1:s,criteria2:i,visibleDropDown:l});const c={address:a,criteria1:s,criteria2:i,columnIndex:o,filterOperator:n,objectId:r,visibleDropDown:l};try{await t.dispatch(e.FilterCells,c)}catch(e){throw new AdapterError}},N=(t,r,a)=>async o=>{d(`Cell range: Set formatting; address:${a} (${r})`,o);const n={address:a,formatting:o,objectId:r};try{await t.dispatch(e.SetCellFormatting,n)}catch(e){throw new AdapterError}},S=(t,r,a)=>async o=>{const n=o.trim();let s;if(!n)throw s=new ParameterError(\"Name cannot be an empty string\"),c(s),s;if(n.length>255)throw s=new ParameterError(\"Name must be 255 characters or less\"),c(s),s;if(/[^a-zA-Z0-9_.?\\\\\"']/.test(n))throw s=new ParameterError(\"Name contains invalid characters\"),c(s),s;if(/^\\d/.test(n))throw s=new ParameterError(\"Name cannot start with a number\"),c(s),s;d(`Cell range: Set name; address:${a}; newName:${n} (${r})`);const i={address:a,name:n,objectId:r};try{await t.dispatch(e.SetCellName,i)}catch(e){throw new AdapterError}},D=(t,r,a)=>async o=>{d(`Cell range: Set values; address:${a} (${r})`,o);const n={address:a,objectId:r,valuesMap:o};try{await t.dispatch(e.SetCellValues,n)}catch(e){throw new AdapterError}},U=(e,t,r,a)=>{var o;try{const n=C.get(e);if(!n)throw new ApiError(`Unable to find registered data stream with id ${e}`);void 0!==(null!==(o=n.timer)&&void 0!==o?o:void 0)&&F(e);const{address:s,updateInterval:i}=n.dataStream,l=async()=>{const o=await t();try{await D(r,a,s)([[o]])}catch(t){h(`Unable to update cell range for stream with id ${e}: ${null==t?void 0:t.message}`)}},c=window.setInterval(l,i);n.timer=c}catch(e){throw c(e),e}},F=e=>{var t;try{const r=C.get(e);if(!r)throw new ApiError(`Unable to find registered data stream with id ${e}`);if(void 0===(null!==(t=r.timer)&&void 0!==t?t:void 0))return;window.clearInterval(r.timer),r.timer=void 0}catch(e){throw c(e),e}},P=(t,r)=>async()=>{d(`Worksheet: Activate (${r})`);try{await t.dispatch(e.ActivateWorksheet,r)}catch(e){throw new AdapterError}},x=(e,t)=>async(r,a)=>p(e,t,r,a,V(a)),L=(t,r)=>async()=>{d(`Worksheet: Calculate (${r})`);try{await t.dispatch(e.CalculateWorksheet,r)}catch(e){throw new AdapterError}},B=(t,r)=>async()=>{d(`Worksheet: Clear all cell formatting (${r})`);try{await t.dispatch(e.ClearAllCellFormatting,r)}catch(e){throw new AdapterError}},j=(t,r)=>async()=>{d(`Worksheet: Clear all cells (${r})`);try{await t.dispatch(e.ClearAllCells,r)}catch(e){throw new AdapterError}},R=(t,r)=>async()=>{d(`Worksheet: Clear all cell values (${r})`);try{await t.dispatch(e.ClearAllCellValues,r)}catch(e){throw new AdapterError}},O=(e,t)=>{const r={eventTarget:g.Worksheet,objectId:t};return{objectId:t,activate:P(e,t),addEventListener:x(e,r),calculate:L(e,t),clearAllCellFormatting:B(e,t),clearAllCells:j(e,t),clearAllCellValues:R(e,t),clearCellFormatting:r=>b(e,t,r)(),clearCells:r=>v(e,t,r)(),clearCellValues:r=>A(e,t,r)(),createDataStream:(r,a,o)=>E(e,t,r)(a,o),delete:z(e,t),filterCells:(r,a,o,n,s,i)=>I(e,t,r)(a,o,n,s,i),getCellRange:M(e,r),getCells:r=>f(e,t,r)(),getName:T(e,t),protect:H(e,t),removeEventListener:u(e),setCellFormatting:(r,a)=>N(e,t,r)(a),setCellName:(r,a)=>S(e,t,r)(a),setCellValues:(r,a)=>D(e,t,r)(a),setName:Q(e,t)}},V=e=>r=>{var a;try{switch(null===(a=r.eventName)||void 0===a?void 0:a.toUpperCase()){case t.Activate.toUpperCase():case t.Deactivate.toUpperCase():return e();case t.Change.toUpperCase():return e(r.changedCells);default:throw new EventError(`Unexpected worksheet event: ${r.eventName}`)}}catch(e){c(e)}},z=(t,r)=>async()=>{d(`Worksheet: Delete (${r})`);try{await t.dispatch(e.DeleteWorksheet,r)}catch(e){throw new AdapterError}},M=(t,r)=>async a=>{const{objectId:o}=r;d(`Worksheet: Get cell range; address:${a} (${o})`);try{const n={address:a,objectId:o},s=await t.dispatch(e.GetRangeAddress,n);return((e,t,r)=>{const{objectId:a}=t,o={cellRangeAddress:r,eventTarget:g.CellRange,objectId:a};return{addEventListener:y(e,o),address:r,clear:v(e,a,r),clearFormatting:b(e,a,r),clearValues:A(e,a,r),createDataStream:E(e,a,r),getCells:f(e,a,r),getNames:G(e,a,r),removeEventListener:u(e),setFilter:I(e,a,r),setFormatting:N(e,a,r),setName:S(e,a,r),setValues:D(e,a,r)}})(t,r,s)}catch(e){if(e.message.indexOf(\"Unable to get cell range\")>=0){const e=new InvalidCellRangeAddressError;throw c(e),e}throw new AdapterError}},T=(t,r)=>async()=>{d(`Worksheet: Get name (${r})`);try{return await t.dispatch(e.GetWorksheetName,r)}catch(e){throw new AdapterError}},H=(t,r)=>async()=>{d(`Worksheet: Protect (${r})`);try{await t.dispatch(e.ProtectWorksheet,r)}catch(e){throw new AdapterError}},Q=(t,r)=>async a=>{const o=a.slice(0,31).replace(/[:\\\\/?*[\\]]/g,\"\").trim();let n;if(!o)throw n=new ParameterError(\"Invalid worksheet name\"),c(n),n;d(`Worksheet: Set name; newWorksheetName:${o} (${r})`);const s={newWorksheetName:o,objectId:r};try{return await t.dispatch(e.SetWorksheetName,s)}catch(e){throw new AdapterError}},_=(t,r)=>async()=>{d(`Workbook: Activate (${r})`);try{return await t.dispatch(e.ActivateWorkbook,r)}catch(e){throw new AdapterError}},q=(e,t)=>async(r,a)=>p(e,t,r,a,Y(e,a)),J=(t,r)=>async()=>{let a;d(`Workbook: Add worksheet (${r})`);try{a=await t.dispatch(e.AddWorksheet,r)}catch(e){throw new AdapterError}return O(t,a)},K=(t,r)=>async()=>{d(`Workbook: Calculate (${r})`);try{await t.dispatch(e.CalculateWorkbook,r)}catch(e){throw new AdapterError}},X=(t,r)=>async()=>{d(`Workbook: Close (${r})`);try{return await t.dispatch(e.CloseWorkbook,r)}catch(e){throw new AdapterError}},Z=(e,t)=>{const r={eventTarget:g.Workbook,objectId:t};return{objectId:t,activate:_(e,t),addWorksheet:J(e,t),addEventListener:q(e,r),calculate:K(e,t),close:X(e,t),getActiveWorksheet:ee(e,t),getCalculationMode:te(e,t),getFilePath:re(e,t),getName:ae(e,t),getWindowBounds:oe(e,t),getWorksheetByName:ne(e,t),getWorksheets:se(e,t),removeEventListener:u(e),save:ie(e,t),saveAs:le(e,t),setWindowBounds:ce(e,t)}},Y=(e,r)=>a=>{var o;try{switch(null===(o=a.eventName)||void 0===o?void 0:o.toUpperCase()){case t.Activate.toUpperCase():case t.Close.toUpperCase():case t.Deactivate.toUpperCase():return r();case t.ActivateWorksheet.toUpperCase():case t.AddWorksheet.toUpperCase():return r(O(e,a.worksheetObjectId));case t.DeleteWorksheet.toUpperCase():return r(a.worksheetName);default:throw new EventError(`Unexpected workbook event: ${a.eventName}`)}}catch(e){c(e)}},ee=(t,r)=>async()=>{let a;d(`Workbook: Get active worksheet: (${r})`);try{a=await t.dispatch(e.GetActiveWorksheet,r)}catch(e){throw new AdapterError}return O(t,a)},te=(t,r)=>async()=>{d(\"Workbook: Get calculation mode\");try{return await t.dispatch(e.GetCalculationMode,r)}catch(e){throw new AdapterError}},re=(t,r)=>async()=>{d(`Workbook: Get file path (${r})`);try{return await t.dispatch(e.GetWorkbookFilePath,r)}catch(e){throw new AdapterError}},ae=(t,r)=>async()=>{d(`Workbook: Get name (${r})`);try{return await t.dispatch(e.GetWorkbookName,r)}catch(e){throw new AdapterError}},oe=(t,r)=>async()=>{d(`Workbook: Get window bounds (${r})`);try{return await t.dispatch(e.GetWorkbookWindowBounds,r)}catch(e){throw new AdapterError}},ne=(t,r)=>async a=>{let o;d(`Workbook: Get worksheet by name: ${a} (${r})`);try{if(o=await t.dispatch(e.GetWorksheetByName,{objectId:r,worksheetName:a}),null===o)return null}catch(e){throw new AdapterError}return O(t,o)},se=(t,r)=>async()=>{let a;d(`Workbook: Get worksheets (${r})`);try{a=await t.dispatch(e.GetWorksheets,r)}catch(e){throw new AdapterError}return a.map((e=>O(t,e)))},ie=(t,r)=>async()=>{d(`Workbook: Save (${r})`);try{return await t.dispatch(e.SaveWorkbook,r)}catch(e){throw new AdapterError}},le=(t,r)=>async a=>{d(`Workbook: Save as; filePath:${a} (${r})`);try{return await t.dispatch(e.SaveWorkbookAs,{filePath:a,objectId:r})}catch(e){throw new AdapterError}},ce=(t,r)=>async a=>{d(`Workbook: Set window bounds (${r})`,a);const{height:o,left:n,top:s,width:i}=a;if(null!=o&&(Number.isNaN(o)||o<=0)){const e=new ParameterError(\"Workbook window height must be a number greater than zero.\");throw c(e),e}if(null!=n&&Number.isNaN(n)){const e=new ParameterError(\"Workbook window left position must be a valid number.\");throw c(e),e}if(null!=s&&Number.isNaN(s)){const e=new ParameterError(\"Workbook window top position must be a valid number.\");throw c(e),e}if(null!=i&&(Number.isNaN(i)||i<=0)){const e=new ParameterError(\"Workbook window width must be a number greater than zero.\");throw c(e),e}const l={newWindowBounds:a,objectId:r};try{return await t.dispatch(e.SetWorkbookWindowBounds,l)}catch(e){throw new AdapterError}},de=t=>async r=>{let a;d(`Application: Get workbook; id:${r}`);try{a=await t.dispatch(e.GetWorkbookById,r)}catch(e){throw new AdapterError}return Z(t,a)},he=t=>async()=>{let r;d(\"Application: Get workbooks\");try{r=await t.dispatch(e.GetWorkbooks)}catch(e){throw new AdapterError}return r.map((e=>Z(t,e)))},we=t=>async r=>{d(`Application: Get worksheet; id:${r}`);try{r=await t.dispatch(e.GetWorksheetById,r)}catch(e){throw new AdapterError}return O(t,r)},pe=t=>async r=>{let a;d(`Application: Open workbook; filePath:${r}`);try{a=await t.dispatch(e.OpenWorkbook,r)}catch(e){throw new AdapterError}return Z(t,a)},ke=t=>async(r=!0)=>{d(`Application: Quit; displayAlerts:${r}`);try{return await t.dispatch(e.QuitApplication,r)}catch(e){throw new AdapterError}};var ue,ge;!function(e){e.ExcelApplication=\"EXCEL-APP\"}(ue||(ue={})),function(e){e[e.Info=1]=\"Info\",e[e.Warn=2]=\"Warn\",e[e.Error=3]=\"Error\"}(ge||(ge={}));const me=\"excel-adapter\",Ce=m();let ye;const ve=()=>o,be=async(t=!1)=>{try{if(await(async e=>{try{d(\"Registering usage\"),await fin.System.registerUsage({type:\"integration-feature\",data:{apiVersion:o,componentName:e}})}catch(t){h(`Unable to register usage for feature ${e}: ${null==t?void 0:t.message}`)}})(ue.ExcelApplication),!await(async e=>(await fin.InterApplicationBus.Channel.getAllChannels()).some((t=>t.channelName===e)))(Ce)){await(async()=>{var e;const t=null===(e=(await fin.Application.getCurrentSync().getManifest()).appAssets)||void 0===e?void 0:e.find((e=>e.alias===me));if(t)return void h(\"Detected adapter package in app manifest appAssets\",t);if(await Ee())return void d(\"Using existing adapter package\");const r={alias:me,src:`https://cdn.openfin.co/release/integrations/excel/${ve()}/OpenFin.Excel.zip`,target:\"OpenFin.Excel.exe\",version:ve()};d(\"Downloading adapter package\",r);try{await fin.System.downloadAsset(r,(()=>{}))}catch(e){throw c(\"Unable to download adapter package\"),e}})();const{securityRealm:e,port:r}=await fin.System.getRuntimeInfo();let{licenseKey:a}=await fin.Application.getCurrentSync().getManifest();a=null!=a?a:\"NO_LICENSE_KEY\";const o=fin.me.uuid;d(\"Initializing adapter\",{adapterLoggingEnabled:t,channelName:Ce,licenseKey:a,port:r,securityRealm:e,uuid:o}),fin.System.launchExternalProcess({alias:me,arguments:`${o} ${a} ${r} ${e} ${Ce} ${t}`})}const r=fin.InterApplicationBus.Channel.connect(Ce,{payload:{version:ve()}}),a=new Promise((e=>{setTimeout(e,2e4)})).then((()=>{throw new Error(\"Connection to adapter timed out\")}));ye=await Promise.race([r,a]),d(`Connected to adapter ${ye.providerIdentity.uuid} on channel ${Ce}`),ye.register(e.LogMessage,Ae),ye.register(e.EventFired,k)}catch(e){const t=new InitializationError(void 0,e);throw c(t),t}return{adapter:{channelName:Ce,version:ve()},createWorkbook:(r=ye,async()=>{let t;d(\"Application: Create workbook\");try{t=await r.dispatch(e.CreateWorkbook)}catch(e){throw new AdapterError}return Z(r,t)}),getWorkbookById:de(ye),getWorkbooks:he(ye),getWorksheetById:we(ye),openWorkbook:pe(ye),quit:ke(ye)};var r},Ae=(e,t)=>{const{message:r,type:a}=e,o=\"[adapter]\";switch(a){case ge.Error:c(r,o);break;case ge.Info:d(o,r);break;case ge.Warn:h(o,r);break;default:c(new Error(`Unknown log type: ${a}`))}},Ee=async()=>{try{const e=await fin.System.getAppAssetInfo({alias:me});return e&&e.version===ve()}catch(e){return!1}};var We,fe,$e,Ge,Ie;!function(e){e.Continuous=\"Continuous\",e.Dash=\"Dash\",e.DashDot=\"DashDot\",e.DashDotDot=\"DashDotDot\",e.Dot=\"Dot\",e.Double=\"Double\",e.SlantDashDot=\"SlantDashDot\",e.None=\"None\"}(We||(We={})),function(e){e.Center=\"Center\",e.CenterAcrossSelection=\"CenterAcrossSelection\",e.Distributed=\"Distributed\",e.Fill=\"Fill\",e.General=\"General\",e.Justify=\"Justify\",e.Left=\"Left\",e.Right=\"Right\"}(fe||(fe={})),function(e){e.Automatic=\"Automatic\",e.Checker=\"Checker\",e.CrissCross=\"CrissCross\",e.Down=\"Down\",e.Gray16=\"Gray16\",e.Gray25=\"Gray25\",e.Gray50=\"Gray50\",e.Gray75=\"Gray75\",e.Gray8=\"Gray8\",e.Grid=\"Grid\",e.Horizontal=\"Horizontal\",e.LightDown=\"LightDown\",e.LightHorizontal=\"LightHorizontal\",e.LightUp=\"LightUp\",e.LightVertical=\"LightVertical\",e.LinearGradient=\"LinearGradient\",e.None=\"None\",e.RectangularGradient=\"RectangularGradient\",e.SemiGray75=\"SemiGray75\",e.Solid=\"Solid\",e.Up=\"Up\",e.Vertical=\"Vertical\"}($e||($e={})),function(e){e.Bottom=\"Bottom\",e.Center=\"Center\",e.Distributed=\"Distributed\",e.Justify=\"Justify\",e.Top=\"Top\"}(Ge||(Ge={})),function(e){e.And=\"And\",e.Or=\"Or\",e.Top10Items=\"Top10Items\",e.Bottom10Items=\"Bottom10Items\",e.Top10Percent=\"Top10Percent\",e.Bottom10Percent=\"Bottom10Percent\",e.FilterValues=\"FilterValues\"}(Ie||(Ie={}));var Ne=a.dq,Se=a.MS,De=a.xQ,Ue=a.sO,Fe=a.Zu,Pe=a.I3,xe=a.$U,Le=a.i0,Be=a.cX,je=a.gH,Re=a._W,Oe=a.U$,Ve=a.U7,ze=a.rd;export{Ne as AdapterError,Se as ApiError,De as EventError,Ue as ExcelCellBorderLineStyle,Fe as ExcelCellHorizontalAlignment,Pe as ExcelCellPattern,xe as ExcelCellVerticalAlignment,Le as ExcelFilterOperator,Be as InitializationError,je as InvalidCellRangeAddressError,Re as ParameterError,Oe as disableLogging,Ve as enableLogging,ze as getExcelApplication};","import type OpenFin from \"@openfin/core\";\nimport { enableLogging, getExcelApplication, type Cell, type ExcelApplication } from \"@openfin/excel\";\nimport type { ExcelAssetSettings, ExcelSettings, ExcelWorksheetSettings } from \"./shapes\";\n\nlet excel: ExcelApplication | undefined;\n/**\n * The interop clients for the different contexts.\n */\nlet interopClients: { [id: string]: OpenFin.InteropClient } | undefined;\n\nlet settings: ExcelSettings | undefined;\n\nlet workbookFound: boolean;\n\n/**\n * Initialize the Excel interop.\n * @param excelSettings The settings to use for initializing the Excel interop.\n */\nexport async function init(excelSettings: ExcelSettings): Promise<void> {\n\tif (!settings) {\n\t\tsettings = excelSettings;\n\t\tconst brokerClient = fin.Interop.connectSync(fin.me.identity.uuid, {});\n\t\tconst contextGroups = await brokerClient.getContextGroups();\n\t\tinteropClients = {};\n\t\tfor (const contextGroup of contextGroups) {\n\t\t\tconst contextClient = fin.Interop.connectSync(fin.me.identity.uuid, {});\n\t\t\tawait contextClient.joinContextGroup(contextGroup.id);\n\t\t\tawait contextClient.addContextHandler(async (ctx) => {\n\t\t\t\tawait handleContext(contextGroup.id, ctx);\n\t\t\t});\n\t\t\tinteropClients[contextGroup.id] = contextClient;\n\t\t}\n\n\t\tenableLogging();\n\t}\n}\n\n/**\n * Get the Excel application.\n * @param assetSettings The settings to use for getting the Excel application.\n * @returns The Excel application.\n */\nexport async function launchExcel(assetSettings: ExcelAssetSettings): Promise<boolean> {\n\tconst assetAvailable = await getAppAsset();\n\tif (!assetAvailable) {\n\t\treturn false;\n\t}\n\tawait fin.System.launchExternalProcess({\n\t\talias: settings?.appAsset.alias\n\t});\n\t// The workbook is not always available immediately, so start a background process\n\t// to wait for the workbook being ready\n\n\tawait listenToExcel(assetSettings);\n\treturn true;\n}\n\n/**\n * Listen to the Excel application.\n * @param assetSettings The settings to use for listening to the Excel application.\n * @param tryCount The number of times the function has been called.\n * @returns A promise that resolves when the Excel application is available.\n */\nasync function listenToExcel(assetSettings: ExcelAssetSettings, tryCount = 0): Promise<void> {\n\tif (tryCount === 10) {\n\t\tconsole.error(\"Excel workbook not available after 10 attempts\");\n\t\treturn;\n\t}\n\tif (workbookFound) {\n\t\tconsole.info(\"Workbook already found\");\n\t\treturn;\n\t}\n\tsetTimeout(async () => {\n\t\tconst excelInstance = await getExcel();\n\t\tif (excelInstance) {\n\t\t\tconst workbooks = await excelInstance.getWorkbooks();\n\t\t\tif (workbooks.length === 0) {\n\t\t\t\ttryCount++;\n\t\t\t\tawait listenToExcel(assetSettings, tryCount);\n\t\t\t} else {\n\t\t\t\tworkbookFound = false;\n\t\t\t\tfor (const workbook of workbooks) {\n\t\t\t\t\tconst name = await workbook.getName();\n\t\t\t\t\tif (name === assetSettings.workbook) {\n\t\t\t\t\t\tfor (const worksheetSettings of assetSettings.worksheets) {\n\t\t\t\t\t\t\tconst worksheet = await workbook.getWorksheetByName(worksheetSettings.name);\n\t\t\t\t\t\t\tif (worksheet) {\n\t\t\t\t\t\t\t\tworkbookFound = true;\n\t\t\t\t\t\t\t\tawait worksheet.addEventListener(\"change\", async (cells) => {\n\t\t\t\t\t\t\t\t\tawait handleCellChanges(assetSettings, worksheetSettings, cells);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!workbookFound) {\n\t\t\t\t\ttryCount++;\n\t\t\t\t\tawait listenToExcel(assetSettings, tryCount);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, 1000);\n}\n\n/**\n * Do any cleanup that is required.\n */\nexport async function closeDown(): Promise<void> {\n\tfor (const client in interopClients) {\n\t\tawait interopClients[client].removeFromContextGroup();\n\t}\n\tinteropClients = {};\n}\n\n/**\n * Gets the configured app asset and ensures it is available.\n * @returns A boolean indicating if the app asset is available.\n */\nasync function getAppAsset(): Promise<boolean> {\n\tlet availableAppAsset: OpenFin.AppAssetInfo | undefined;\n\ttry {\n\t\tif (settings?.appAsset !== undefined) {\n\t\t\tavailableAppAsset = await fin.System.getAppAssetInfo({ alias: settings.appAsset.alias });\n\t\t}\n\t} catch (appAssetError) {\n\t\tconsole.debug(\n\t\t\t`App asset info for alias: ${settings?.appAsset.alias} is not available. Response from getAppAssetInfo`,\n\t\t\tappAssetError\n\t\t);\n\t}\n\tif (\n\t\t(availableAppAsset === undefined || settings?.appAsset.version !== availableAppAsset.version) &&\n\t\tsettings?.appAsset !== undefined\n\t) {\n\t\tconsole.info(`App asset with alias: ${settings?.appAsset.alias} does not exist in memory. Fetching it.`);\n\t\ttry {\n\t\t\tawait fin.System.downloadAsset(settings.appAsset, (progress) => {\n\t\t\t\tconst downloadedPercent = Math.floor((progress.downloadedBytes / progress.totalBytes) * 100);\n\t\t\t\tconsole.info(\n\t\t\t\t\t`Downloaded ${downloadedPercent}% of app asset with alias of ${settings?.appAsset.alias}`\n\t\t\t\t);\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tconsole.error(`Error trying to download app asset with alias: ${settings?.appAsset.alias}`, error);\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\n/**\n * Get the excel application.\n * @returns The application.\n * @internal\n */\nasync function getExcel(): Promise<ExcelApplication | undefined> {\n\ttry {\n\t\texcel = await getExcelApplication();\n\t\treturn excel;\n\t} catch (err) {\n\t\tconsole.error(\"Error getting Excel application\", err);\n\t}\n}\n\n/**\n * Handle the cell changes.\n * @param excelAsset The asset to use for processing the cell changes.\n * @param worksheet The asset to use for processing the cell changes.\n * @param cells The cells that have changed.\n */\nasync function handleCellChanges(\n\texcelAsset: ExcelAssetSettings,\n\tworksheet: ExcelWorksheetSettings,\n\tcells: Cell[]\n): Promise<void> {\n\tif (interopClients && worksheet.cellHandlers) {\n\t\tfor (const cell of cells) {\n\t\t\tconst cellHandler = worksheet.cellHandlers.find((c) => c.cell === cell.address);\n\n\t\t\tif (cellHandler) {\n\t\t\t\tconst client = interopClients[cellHandler.contextGroup];\n\t\t\t\tif (\n\t\t\t\t\tclient &&\n\t\t\t\t\t(cellHandler.types.includes(\"instrument\") || cellHandler.types.includes(\"fdc3.instrument\"))\n\t\t\t\t) {\n\t\t\t\t\tawait client.setContext({\n\t\t\t\t\t\ttype: \"fdc3.instrument\",\n\t\t\t\t\t\tid: {\n\t\t\t\t\t\t\tticker: cell.value,\n\t\t\t\t\t\t\t_source: `excel.${excelAsset.workbook}.${worksheet.name}`\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Handle a context.\n * @param contextGroup The group receiving the context.\n * @param context The context being received.\n */\nasync function handleContext(contextGroup: string, context: OpenFin.Context): Promise<void> {\n\tif (settings?.asset) {\n\t\tconst excelInstance = await getExcel();\n\t\tif (excelInstance) {\n\t\t\tconst workbooks = await excelInstance.getWorkbooks();\n\t\t\tfor (const workbook of workbooks) {\n\t\t\t\tconst workbookName = await workbook.getName();\n\n\t\t\t\tconst connectedWorkbook = settings?.asset;\n\t\t\t\tif (connectedWorkbook?.worksheets) {\n\t\t\t\t\tfor (const worksheetSettings of connectedWorkbook.worksheets) {\n\t\t\t\t\t\tif (worksheetSettings.cellHandlers) {\n\t\t\t\t\t\t\tconst incomingSource = `excel.${workbookName}.${worksheetSettings.name}`;\n\n\t\t\t\t\t\t\tif (incomingSource !== context?.id?._source) {\n\t\t\t\t\t\t\t\tconst cellHandlers = worksheetSettings.cellHandlers?.filter(\n\t\t\t\t\t\t\t\t\t(ch) => ch.contextGroup === contextGroup && ch.types.includes(context.type)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tfor (const cellHandler of cellHandlers) {\n\t\t\t\t\t\t\t\t\tconst worksheet = await workbook.getWorksheetByName(worksheetSettings.name);\n\n\t\t\t\t\t\t\t\t\tif (worksheet) {\n\t\t\t\t\t\t\t\t\t\tlet cellValue: string | undefined;\n\t\t\t\t\t\t\t\t\t\tif (context.type === \"fdc3.instrument\" || context.type === \"instrument\") {\n\t\t\t\t\t\t\t\t\t\t\tcellValue = context.id?.ticker;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (cellValue !== undefined) {\n\t\t\t\t\t\t\t\t\t\t\tawait worksheet.setCellValues(cellHandler.cell, [[cellValue]]);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { init as initExcel, launchExcel } from \"./excel\";\nimport type { ExcelSettings } from \"./shapes\";\n\nwindow.addEventListener(\"DOMContentLoaded\", async () => {\n\tconst root = \"http://localhost:8080\";\n\tconst excelSettings: ExcelSettings = {\n\t\tappAsset: {\n\t\t\talias: \"excel-interop-example.xlsx\",\n\t\t\tversion: \"0.0.5\",\n\t\t\tsrc: `${root}/assets/excel-interop-example.zip`,\n\t\t\ttarget: \"excel-interop-example.xlsx\"\n\t\t},\n\t\ticon: `${root}/assets/excel.svg`,\n\t\tasset: {\n\t\t\ttitle: \"Excel Interop Example\",\n\t\t\tdescription: \"Demonstrate interop with Excel workbook\",\n\t\t\tworkbook: \"excel-interop-example.xlsx\",\n\t\t\tworksheets: [\n\t\t\t\t{\n\t\t\t\t\tname: \"Sheet1\",\n\t\t\t\t\tcellHandlers: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcell: \"$B$3\",\n\t\t\t\t\t\t\ttypes: [\"instrument\", \"fdc3.instrument\"],\n\t\t\t\t\t\t\tcontextGroup: \"green\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcell: \"$B$4\",\n\t\t\t\t\t\t\ttypes: [\"instrument\", \"fdc3.instrument\"],\n\t\t\t\t\t\t\tcontextGroup: \"purple\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcell: \"$B$5\",\n\t\t\t\t\t\t\ttypes: [\"instrument\", \"fdc3.instrument\"],\n\t\t\t\t\t\t\tcontextGroup: \"orange\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcell: \"$B$6\",\n\t\t\t\t\t\t\ttypes: [\"instrument\", \"fdc3.instrument\"],\n\t\t\t\t\t\t\tcontextGroup: \"red\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcell: \"$B$7\",\n\t\t\t\t\t\t\ttypes: [\"instrument\", \"fdc3.instrument\"],\n\t\t\t\t\t\t\tcontextGroup: \"pink\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcell: \"$B$8\",\n\t\t\t\t\t\t\ttypes: [\"instrument\", \"fdc3.instrument\"],\n\t\t\t\t\t\t\tcontextGroup: \"yellow\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t};\n\tawait initExcel(excelSettings);\n\tawait launchExcel(excelSettings.asset);\n});\n"],"names":[],"sourceRoot":""}