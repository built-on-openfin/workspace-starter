{"version":3,"file":"static/chunks/150.72daf878065e4218.js","mappings":"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","sources":["webpack://_N_E/./src/components/ControlBar/MenuWindow/GlobalMenuWindowStyles.tsx","webpack://_N_E/./src/components/ControlBar/MenuWindow/MenuWindow.tsx","webpack://_N_E/./src/components/App/PopupMenu/PopupMenu.tsx","webpack://_N_E/./src/hooks/useCallbackOnAPIReady.ts"],"sourcesContent":["import { createGlobalStyle } from 'styled-components';\n\nconst GlobalMenuWindowStyles = createGlobalStyle`\n    html,\n    body,\n    #__next {\n        height: 100%;\n    }\n`;\n\nexport default GlobalMenuWindowStyles;\n","import { FC, useEffect } from 'react';\n\nimport type OpenFin from '@openfin/core';\n\nimport { menuEvents } from '@common/utils/menu-window-provider';\nimport { navigate, Router, withRouter } from '@common/utils/router';\nimport { getUrlParams } from '@common/utils/router';\n\nimport { useCallbackOnAPIReady } from '@enterprise/hooks/useCallbackOnAPIReady';\n\ninterface Props {\n    router: Router;\n    children: React.ReactNode;\n}\n\nconst MenuWindow: FC<Props> = ({ children, router }) => {\n    useCallbackOnAPIReady(() => (fin.me as OpenFin.Window).close());\n\n    useEffect(() => {\n        // Allow escape key to close pop up window\n        const handleKeyUp = (ev: KeyboardEvent) => {\n            if (ev.key === 'Escape') {\n                (fin.me as OpenFin.Window).blur();\n            }\n        };\n        document.addEventListener('keyup', handleKeyUp);\n\n        const handleUpdate = async (name: string, bounds: Partial<OpenFin.Bounds>, route: string) => {\n            if (fin.me.name !== name) return;\n            console.debug('MenuWindow: navigating window to route', route);\n            // The below listener updates opacity to 1 after shown,\n            await (fin.me as OpenFin.Window).once('shown', async () => {\n                setTimeout(async () => {\n                    await fin.me.updateOptions({ opacity: 1 });\n                    const wOpts = await (fin.me as OpenFin.Window).getOptions();\n                    // more details in WRK-2277\n                    if (wOpts.opacity !== 1) {\n                        await fin.me.updateOptions({ opacity: 1 });\n                        console.debug('MenuWindow set opacity again', await fin.me.getOptions());\n                    }\n                });\n            });\n            await navigate(route);\n\n            // restore child window in case it's minimized\n            await (fin.me as OpenFin.Window).restore();\n            await fin.me.show();\n            await fin.me.focus();\n        };\n        menuEvents.addListener('update', handleUpdate);\n        // On startup the update event gets sent before the listener is ready\n        // This lets the window who created you know this menuWindow know it is up & ready\n        menuEvents.emit('ready', fin.me.identity);\n\n        return () => {\n            document.removeEventListener('keyup', handleKeyUp);\n            menuEvents.removeListener('update', handleUpdate);\n        };\n    }, []);\n\n    useEffect(() => {\n        const { title } = getUrlParams(router.asPath);\n        document.title = title;\n    }, [router]);\n\n    return <>{children}</>;\n};\n\nexport default withRouter(MenuWindow) as FC<{ children: React.ReactNode }>;\n","import { FC } from 'react';\n\nimport type { AppProps } from 'next/app';\n\nimport App from '@common/pages/_app';\n\nimport { isFin } from '@common/utils/env';\n\nimport GlobalMenuWindowStyles from '@enterprise/components/ControlBar/MenuWindow/GlobalMenuWindowStyles';\n\nimport { BrowserContext } from '@common/hooks/context';\n\nimport MenuWindow from '../../ControlBar/MenuWindow/MenuWindow';\nimport BrowserThemeProvider from '../ThemeProvider/BrowserThemeProvider';\n\nconst MenuController: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n    if (isFin && fin.me.isWindow) {\n        return <MenuWindow>{children}</MenuWindow>;\n    } else {\n        // In a view popup\n        return <>{children}</>;\n    }\n};\n\n/**\n * Entry point for a callot page that is in a popup menu window.\n */\nconst BrowserPopupMenuApp: FC<AppProps> = (props) => {\n    return (\n        <BrowserContext>\n            <BrowserThemeProvider>\n                <GlobalMenuWindowStyles />\n                <MenuController>\n                    <App {...props} />\n                </MenuController>\n            </BrowserThemeProvider>\n        </BrowserContext>\n    );\n};\nexport default BrowserPopupMenuApp;\n","import { useEffect } from 'react';\n\nexport const useCallbackOnAPIReady = (callback: () => Promise<void>) => {\n    useEffect(() => {\n        fin.Platform.getCurrentSync().on('platform-api-ready', callback);\n\n        return () => {\n            fin.Platform.getCurrentSync().removeListener('platform-api-ready', callback);\n        };\n    }, [callback]);\n};\n"],"names":["GlobalMenuWindowStyles","createGlobalStyle","MenuWindow_MenuWindow","withRouter","children","router","param","useCallbackOnAPIReady","fin","me","close","useEffect","handleKeyUp","ev","key","blur","document","addEventListener","handleUpdate","name","bounds","route","console","debug","once","setTimeout","updateOptions","opacity","wOpts","getOptions","navigate","restore","show","focus","menuEvents","addListener","emit","identity","removeEventListener","removeListener","title","getUrlParams","asPath","jsx_runtime","jsx","Fragment","MenuController","isFin","isWindow","MenuWindow","PopupMenu","BrowserContext","jsxs","BrowserThemeProvider","App","props","Platform","getCurrentSync","on","callback"],"sourceRoot":""}