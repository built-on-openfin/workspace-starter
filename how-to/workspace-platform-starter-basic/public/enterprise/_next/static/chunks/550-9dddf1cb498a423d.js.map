{"version":3,"file":"static/chunks/550-9dddf1cb498a423d.js","mappings":"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","sources":["webpack://_N_E/./src/assets/icons/ai-companion.svg","webpack://_N_E/./src/slices/modal/close.ts","webpack://_N_E/./src/api/controls.ts","webpack://_N_E/../common/src/utils/pages/attach-pages.ts","webpack://_N_E/../client-api-platform/src/init/override-callback/enterprise-page-required-layout-settings.ts","webpack://_N_E/./src/api/pages/attached.ts","webpack://_N_E/./src/api/pages/state.ts","webpack://_N_E/./src/api/panels.ts","webpack://_N_E/./src/api/view.ts","webpack://_N_E/./src/components/ControlBar/RightControlsContainer/ToolbarContainer/menus/menuConfig.ts","webpack://_N_E/./src/components/ControlBar/Tablist/utils.ts","webpack://_N_E/./src/assets/icons/pencil.svg","webpack://_N_E/./src/components/PanelContainer/AICompanionPanel/useInitializeAICompanionView.tsx","webpack://_N_E/./src/components/PanelContainer/AICompanionPanel/AICompanionPanel.tsx","webpack://_N_E/./src/components/PanelContainer/PanelContainer.tsx","webpack://_N_E/./src/components/mixins/padding-border.tsx","webpack://_N_E/./src/components/PanelContainer/utils.ts","webpack://_N_E/./src/hooks/usePanelBounds.ts","webpack://_N_E/./src/utils/layout.ts"],"sourcesContent":["var _path;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nvar SvgAiCompanion = function SvgAiCompanion(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, props), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m4.29 6.283-2.307.773a.961.961 0 0 0-.001 1.817l2.307.773a3.227 3.227 0 0 1 2.036 2.046l.769 2.319c.131.39.495.654.905.654.41 0 .773-.264.903-.652l.769-2.32a3.227 3.227 0 0 1 2.036-2.046l2.307-.772a.961.961 0 0 0 .002-1.82l-2.307-.772a3.227 3.227 0 0 1-2.036-2.046l-.77-2.32c-.259-.78-1.546-.78-1.807 0l-.77 2.32a3.227 3.227 0 0 1-2.035 2.046Z\",\n    fill: \"#140611\"\n  })));\n};\nexport default SvgAiCompanion;","import { createAsyncThunk } from '@reduxjs/toolkit';\n\nimport { showError, showSuccess } from '@common/utils/indicators/showIndicator';\nimport { countViews } from '@common/utils/layout';\nimport { waitForModalResponse } from '@common/utils/menu-window-provider';\nimport { getResponseModalBoundsAndCenterParentIfModalOffScreen } from '@common/utils/modal-bounds';\nimport { raiseBrowserAnalytics } from '@common/utils/usage-register';\nimport { currentOFIdentity, getCurrentOFWindow } from '@common/utils/window';\n\nimport { t } from '@common/api/i18next';\nimport { cleanPage } from '@common/api/pages';\nimport { requestShouldPageClose, requestShouldWindowClose } from '@common/api/pages/internal';\nimport { AttachedPageInternal, HandleSaveModalOnPageClosePayload } from '@common/api/pages/shapes';\n\nimport { getPages, updateInternalPageState } from '@enterprise/api/pages/attached';\n\nimport {\n    getBrowserWindowCloseMenu,\n    getPageCloseMenu\n} from '@enterprise/components/ControlBar/RightControlsContainer/ToolbarContainer/menus/menuConfig';\n\nimport { getCurrentSync } from '@client-platform/api';\nimport { AttachedPage, BrowserWindowModule, Page } from '@client-platform/index';\n\nimport { AttachedPagesRootState, selectPages } from '../pages/attached';\n\nconst trackRemovedPage = async (page: Page) => {\n    // eslint-disable-next-line no-underscore-dangle\n    await getCurrentSync().Browser.wrapSync(currentOFIdentity)._trackRemovedTab({ identity: currentOFIdentity, page });\n};\nconst trackRemovedWindow = async () => {\n    const w = getCurrentOFWindow();\n    const options = await w.getOptions();\n    if (options.workspacePlatform) {\n        // eslint-disable-next-line no-underscore-dangle\n        await getCurrentSync()\n            .Browser.wrapSync(currentOFIdentity)\n            ._trackRemovedTab({ window: options.workspacePlatform });\n    }\n};\n\nconst raiseBrowserModalAnalytics = (action: string, type: 'Page Modal' | 'Window Modal', value: string, data?: any) =>\n    raiseBrowserAnalytics({\n        type: type,\n        action: action,\n        value: value,\n        skipValueHashing: true,\n        data\n    });\n\nconst raisePageModalAnalytics = (action: string, value: string, data?: any) =>\n    raiseBrowserModalAnalytics(action, 'Page Modal', value, data);\n\nconst raiseWindowModalAnalytics = (action: string, value: string, data?: any) =>\n    raiseBrowserModalAnalytics(action, 'Window Modal', value, data);\n\n/**\n * Sets the targeted page as active and displays a modal dialog to confirm the closure of the page.\n * If the page has never been saved before, it prompts the user to enter a title for the page to save.\n *\n * @param {Object} params - The parameters for the function.\n * @param {AttachedPage} params.page - The page to be closed.\n * @param {boolean} params.isSaved - Indicates if the page is already saved.\n * @param {string} [params.titlePrefix] - Optional prefix for the title in the modal dialog.\n *\n * @returns {Promise<ModalResponse>} - A promise that resolves to the response from the modal dialog.\n */\nconst showClosePageModal = async ({\n    page,\n    isSaved,\n    titlePrefix\n}: {\n    page: AttachedPage;\n    isSaved: boolean;\n    titlePrefix?: string;\n}) => {\n    const textInputOptions = isSaved\n        ? null\n        : { placeholder: 'Please enter a title of the page to save', defaultValue: page.title };\n    const { windowOptions, content, parameters } = await getPageCloseMenu({\n        textInputOptions,\n        titlePrefix\n    });\n\n    // Set the target page active so users have context on the page they're closing\n    const browser = getCurrentSync().Browser.wrapSync(currentOFIdentity);\n    await browser.setActivePage(page.pageId);\n\n    const { top, left } = await getResponseModalBoundsAndCenterParentIfModalOffScreen(windowOptions, currentOFIdentity);\n    const pageCloseOptions = { ...windowOptions, top, left };\n\n    return waitForModalResponse({\n        options: pageCloseOptions,\n        content,\n        parameters\n    });\n};\n\n/**\n * Conditionally await a function based on a shouldAwait flag\n * If shouldAwait is true, the function will be awaited and return the result of the function\n *   Otherwise, the function will be called and return Promise<void>\n *\n * @param fn the async function to conditionally await\n * @param shouldAwait whether to await the function\n */\nconst conditionallyAwaitFunction = async <T>(fn: () => Promise<T>, shouldAwait: boolean): Promise<T | void> => {\n    if (shouldAwait) {\n        return fn();\n    } else {\n        // Intentionally not awaiting the function\n        fn();\n    }\n};\n\nconst handleClosePageModalResponse = async ({\n    response,\n    pageId,\n    recentlyActivePageId,\n    pageTitle,\n    awaitAnalytics,\n    skipPageClose\n}: {\n    response: Awaited<ReturnType<typeof showClosePageModal>>;\n    pageId: string;\n    pageTitle: string;\n    recentlyActivePageId?: string;\n    awaitAnalytics?: boolean;\n    skipPageClose?: boolean;\n}) => {\n    const platform = getCurrentSync();\n    const browser = platform.Browser.wrapSync(currentOFIdentity);\n    let analyticsFunction;\n\n    switch (response.data.actionName) {\n        case 'close-button':\n            analyticsFunction = () => raisePageModalAnalytics('Select Close', pageTitle);\n            await conditionallyAwaitFunction(analyticsFunction, awaitAnalytics);\n            break;\n        case 'Cancel':\n            // Not closing, do not need to await analytics\n            raisePageModalAnalytics('Select Cancel', pageTitle);\n            return;\n        case 'Discard Changes':\n            analyticsFunction = () => raisePageModalAnalytics('Select Discard Changes', pageTitle);\n            await conditionallyAwaitFunction(analyticsFunction, awaitAnalytics);\n            if (!skipPageClose) {\n                // Refocus previously active page from before the modal appeared to close the target page\n                if (recentlyActivePageId && pageId !== recentlyActivePageId) {\n                    await browser.setActivePage(recentlyActivePageId);\n                }\n\n                await browser.removePage(pageId);\n            }\n            break;\n        case 'Save':\n            try {\n                const newTitle = response.data.data?.textInputValue;\n                await browser.updatePage({\n                    pageId: pageId,\n                    page: { title: newTitle, hasUnsavedChanges: false }\n                });\n                const pageToSave = await browser.getPage(pageId);\n                const analyticsVerb = (await platform.Storage.getPage(pageId)) ? 'Save' : 'Save As';\n\n                await platform.Storage.savePage(pageToSave);\n\n                analyticsFunction = () => raisePageModalAnalytics(`Select ${analyticsVerb}`, pageToSave.title);\n                await conditionallyAwaitFunction(analyticsFunction, awaitAnalytics);\n\n                if (!skipPageClose) {\n                    await showSuccess({\n                        message: t('enterpriseSuccessIndicator.supertabSaved'),\n                        parentBrowserName: browser.identity.name,\n                        secondaryMessage: t('enterpriseSuccessIndicator.supertabHasBeenSaved', {\n                            title: pageToSave.title\n                        }),\n                        isEnterprise: true\n                    });\n\n                    // Refocus previously active page from before the modal appeared to close the target page\n                    if (recentlyActivePageId && pageId !== recentlyActivePageId) {\n                        await browser.setActivePage(recentlyActivePageId);\n                    }\n\n                    await browser.removePage(pageId);\n                }\n            } catch (err) {\n                console.error(err);\n                await showError({\n                    message: 'Failed to save a page',\n                    parentBrowserName: browser.identity.name\n                });\n            }\n            break;\n    }\n};\n\nconst shouldShowUnsavedPageModal = (payload: HandleSaveModalOnPageClosePayload) => {\n    // In EB, high-level tabs shouldn't prompt about unsaved changes\n    if (countViews(payload.page.layout.content) === 1) {\n        console.log('skipping save modal for single-view page in Enterprise browser', payload);\n        return { shouldShowModal: false };\n    }\n    // By default, only show modal if there are unsaved changes to the page.\n    return { shouldShowModal: !!payload.page.hasUnsavedChanges };\n};\n\nexport interface ClosePageRequestPayload {\n    pageId: string;\n    closeType?: 'page' | 'view';\n}\nexport const handleClosePageRequest = createAsyncThunk<void, ClosePageRequestPayload>(\n    'pages/handleClosePageRequest',\n    async ({ pageId, closeType }: ClosePageRequestPayload, { getState, dispatch }) => {\n        // Make sure page passed into overrides has latest layout\n        await updateInternalPageState();\n\n        const pages = selectPages(getState() as AttachedPagesRootState);\n        const targetPage = pages.find((page) => page.pageId === pageId);\n        const browser = getCurrentSync().Browser.wrapSync(currentOFIdentity);\n\n        const { shouldPageClose } = await requestShouldPageClose({\n            closeType: closeType || 'page',\n            page: targetPage,\n            identity: currentOFIdentity\n        });\n        if (!shouldPageClose) {\n            console.debug(`Closing of page ${pageId} prevented by shouldPageClose override.`);\n            return;\n        }\n\n        await trackRemovedPage(targetPage);\n\n        const { shouldShowModal } = await shouldShowUnsavedPageModal({\n            page: targetPage,\n            identity: currentOFIdentity\n        });\n        if (!shouldShowModal) {\n            await browser.removePage(pageId);\n            return;\n        }\n\n        const recentlyActivePageId = pages.find((page) => page.isActive)?.pageId;\n\n        const savedPage = await getCurrentSync().Storage.getPage(pageId);\n        // Set the target page active and pop a modal prompting user to save the page\n        const response = await showClosePageModal({ page: targetPage, isSaved: !!savedPage });\n\n        const isLastPage = pages.length === 1;\n        await handleClosePageModalResponse({\n            response,\n            pageId: targetPage.pageId,\n            recentlyActivePageId,\n            pageTitle: targetPage.title,\n            awaitAnalytics: isLastPage\n        });\n    }\n);\n\n/*\n * Get the pages that have unsaved changes and show the modal to save them\n */\nconst getPagesToSave = async (browserPages: AttachedPageInternal[]): Promise<AttachedPageInternal[]> => {\n    const unsavedPages = browserPages.filter(({ hasUnsavedChanges }) => hasUnsavedChanges);\n    // array of true/false indicating if modal should be shown for the page\n    const isPageSavable: boolean[] = await Promise.all(\n        unsavedPages.map(async (page) => {\n            const { shouldShowModal } = await shouldShowUnsavedPageModal({\n                page: page,\n                identity: currentOFIdentity\n            });\n            return shouldShowModal;\n        })\n    );\n    return unsavedPages.filter((_page, index) => isPageSavable[index]) as AttachedPageInternal[];\n};\n\n/*\n * Check if the page has been saved before\n */\nconst hasPageBeenSavedBefore = (storagePage: Page[], page: AttachedPageInternal): boolean =>\n    storagePage.some((storedPage) => storedPage.pageId === page.pageId);\n\n/*\n * Categorize pages into previously saved and never saved\n */\nconst categorizePagesBySaveStatus = (\n    savablePages: AttachedPage[],\n    pagesInStorage: Page[]\n): {\n    previouslySavedPages: AttachedPage[];\n    neverSavedPages: AttachedPage[];\n} => {\n    return savablePages.reduce(\n        (accum, page) => {\n            hasPageBeenSavedBefore(pagesInStorage, page)\n                ? accum.previouslySavedPages.push(page)\n                : accum.neverSavedPages.push(page);\n            return accum;\n        },\n        { previouslySavedPages: [] as AttachedPage[], neverSavedPages: [] as AttachedPage[] }\n    );\n};\n\nconst savePreviouslySavedPages = async (previouslySavedPages: AttachedPage[], browser: BrowserWindowModule) => {\n    for (let i = 0; i < previouslySavedPages.length; i++) {\n        const page = previouslySavedPages[i];\n\n        // if page is active, fetch it using API to get the up-to-date layout\n        const pageToSave = page.isActive ? await browser.getPage(page.pageId) : page;\n\n        await getCurrentSync().Storage.savePage(cleanPage(pageToSave));\n        await browser.updatePage({\n            pageId: pageToSave.pageId,\n            page: {\n                hasUnsavedChanges: false\n            }\n        });\n    }\n};\n\n/*\n * Handle the unsaved pages modals.\n * Returns true if all page save modals were handled gracefully.\n * Returns false if one of the page save modals is aborted.\n */\nconst handleUnsavedPagesWithRenameModals = async (neverSavedPages: AttachedPage[]) => {\n    const pages = await getPages(currentOFIdentity);\n    const recentlyActivePageId = pages.find((page) => page.isActive).pageId;\n    const skipPageClose = neverSavedPages.length > 1;\n\n    for (let index = 0; index < neverSavedPages.length; ++index) {\n        const page = neverSavedPages[index];\n        const modalResponse = await showClosePageModal({\n            page,\n            isSaved: false,\n            titlePrefix: neverSavedPages.length > 1 && `(${index + 1}/${neverSavedPages.length}) `\n        });\n        await handleClosePageModalResponse({\n            response: modalResponse,\n            pageId: page.pageId,\n            recentlyActivePageId,\n            pageTitle: page.title,\n            awaitAnalytics: true,\n            skipPageClose\n        });\n\n        if (modalResponse.data.actionName === 'Cancel' || modalResponse.data.actionName === 'close-button') {\n            return false;\n        }\n    }\n    return true;\n};\n\nexport const closeBrowserWindow = async () => {\n    const currentWindow = getCurrentOFWindow();\n    await trackRemovedWindow();\n    await currentWindow.close(true);\n};\n\n/**\n * Show the close window modal\n */\nexport const handleCloseWindowRequest = createAsyncThunk<void>(\n    'pages/handleCloseWindowRequest',\n    async (_, { getState, dispatch }) => {\n        await trackRemovedWindow();\n\n        // use getPages here instead of redux store to get latest layout for active page\n        const browserPages = await getPages(currentOFIdentity);\n        const platform = getCurrentSync();\n        const { shouldWindowClose } = await requestShouldWindowClose({\n            pages: browserPages,\n            identity: currentOFIdentity\n        });\n\n        if (!shouldWindowClose) {\n            console.debug('Closing of the window prevented by handlePagesAndWindowClose override.');\n            return;\n        }\n        const savablePages = await getPagesToSave(browserPages);\n        const pagesInStorage = await platform.Storage.getPages();\n        const { previouslySavedPages, neverSavedPages } = categorizePagesBySaveStatus(savablePages, pagesInStorage);\n\n        if (savablePages.length === 0) {\n            // Do not show modal if there are no unsaved pages.\n            await closeBrowserWindow();\n            return;\n        }\n\n        // When closing from taskbar, need to focus to prevent immediate blur of the response modal\n        await fin.me.focus();\n\n        if (previouslySavedPages.length === 0 && neverSavedPages.length === 1) {\n            // If there is only one unsaved page that was not saved before, only show the save changes modal for that page\n            const allSavePageModalsHandled = await handleUnsavedPagesWithRenameModals(neverSavedPages);\n\n            if (allSavePageModalsHandled) {\n                await closeBrowserWindow();\n            }\n            return;\n        }\n\n        const { windowOptions, content, parameters } = await getBrowserWindowCloseMenu({\n            unsavedPagesCount: savablePages.length\n        });\n        const { top, left } = await getResponseModalBoundsAndCenterParentIfModalOffScreen(\n            windowOptions,\n            currentOFIdentity\n        );\n\n        const browserWindowCloseOptions = { ...windowOptions, top, left };\n\n        const response = await waitForModalResponse({\n            options: browserWindowCloseOptions,\n            content,\n            parameters\n        });\n\n        switch (response.data.actionName) {\n            case 'close-button':\n                await raiseWindowModalAnalytics('Select Close', currentOFIdentity.name);\n                break;\n            case 'Save All': {\n                // save the pages\n                const browser = platform.Browser.wrapSync(currentOFIdentity);\n                let allSavePageModalsHandled = true;\n\n                if (previouslySavedPages.length > 0) {\n                    await savePreviouslySavedPages(previouslySavedPages, browser);\n                }\n\n                if (neverSavedPages.length) {\n                    allSavePageModalsHandled = await handleUnsavedPagesWithRenameModals(neverSavedPages);\n                }\n\n                await raiseWindowModalAnalytics('Select Save All', currentOFIdentity.name);\n\n                if (allSavePageModalsHandled) {\n                    await closeBrowserWindow();\n                }\n                break;\n            }\n            case 'Discard All': {\n                await raiseWindowModalAnalytics('Select Discard All', currentOFIdentity.name);\n                await closeBrowserWindow();\n                break;\n            }\n            case 'Cancel':\n                // Not closing, do not need to await analytics\n                raiseWindowModalAnalytics('Select Cancel', currentOFIdentity.name, {\n                    uuid: currentOFIdentity.uuid\n                });\n        }\n    }\n);\n","import type OpenFin from '@openfin/core';\n\nimport { titleCase } from 'title-case';\n\nimport {\n    showError,\n    showIndicator,\n    ShowIndicatorPayload,\n    showInfo,\n    showSuccess\n} from '@common/utils/indicators/showIndicator';\nimport { getViewContextGroupId } from '@common/utils/interop';\nimport { showChildWindow } from '@common/utils/menu-window-provider';\nimport { getResponseModalBoundsAndCenterParentIfModalOffScreen } from '@common/utils/modal-bounds';\nimport { raiseBrowserAnalytics } from '@common/utils/usage-register';\nimport { currentOFIdentity } from '@common/utils/window';\n\nimport { t } from '@common/api/i18next';\nimport { copyPage } from '@common/api/pages/internal';\nimport { AddToChannelRequest } from '@common/api/protocol/browser';\n\nimport { selectPage } from '@enterprise/slices/pages/attached';\n\nimport { handleClosePageRequest, handleCloseWindowRequest } from '@enterprise/slices/modal/close';\n\nimport { getSaveMenu } from '@enterprise/components/ControlBar/RightControlsContainer/ToolbarContainer/menus/menuConfig';\n\nimport { getCurrentSync, SaveModalType } from '@client-platform/index';\nimport { OpenSaveMenuRequest } from '@client-platform/shapes';\nimport store from '@enterprise/store';\n\nimport { updateContextGroup } from './color-linking';\n\nexport const requestCloseBrowserWindow = async () => {\n    store.dispatch(handleCloseWindowRequest());\n};\n\nexport const requestClosePage = async (...args: Parameters<typeof handleClosePageRequest>) => {\n    store.dispatch(handleClosePageRequest(...args));\n};\n\ntype MenuSearchParams = {\n    menuType: string;\n    invocationId: string;\n    id?: string;\n    isEnterprise?: string;\n};\n\n/**\n * Opens the save menu with the specified menu type provided and the ID to be saved\n *\n * @param menuType Provide one of the SaveModalType's to define the content to render\n * @id id of the page or workspace to action against\n */\nexport const requestOpenSaveModal = async ({ menuType, id }: OpenSaveMenuRequest) => {\n    const menuOptions: MenuSearchParams = {\n        menuType,\n        invocationId: Date.now().toString(),\n        isEnterprise: `${true}`\n    };\n    id && (menuOptions.id = id);\n\n    const windowOpts = (await getSaveMenu()).windowOptions;\n\n    const bounds = await getResponseModalBoundsAndCenterParentIfModalOffScreen(windowOpts, fin.me.identity);\n\n    if (\n        menuType === SaveModalType.SAVE_PAGE ||\n        menuType === SaveModalType.SAVE_PAGE_AS ||\n        menuType === SaveModalType.RENAME_PAGE\n    ) {\n        const browser = getCurrentSync().Browser.wrapSync(currentOFIdentity);\n        await browser.setActivePage(menuOptions.id);\n    }\n\n    const popupWin = await showChildWindow({\n        options: {\n            url: windowOpts.url,\n            name: windowOpts.name,\n            defaultHeight: windowOpts.defaultHeight,\n            defaultWidth: windowOpts.defaultWidth,\n            defaultLeft: bounds.left,\n            defaultTop: bounds.top,\n            left: bounds.left,\n            top: bounds.top\n        },\n        parameters: new URLSearchParams(menuOptions)\n    });\n\n    return popupWin.identity;\n};\n\n/**\n * Creates a copy of a page in the same window.\n * @param page The page to be duplicated\n */\nexport const requestDuplicatePage = async (pageId: string) => {\n    let isSupertab = false;\n    try {\n        const page = selectPage(store.getState(), pageId);\n        if (!page) {\n            throw new Error('Request to duplicate page failed. Page not found.');\n        }\n        const browser = getCurrentSync().Browser.wrapSync(currentOFIdentity);\n        isSupertab = page.attachedPageType === 'multiView';\n\n        const title = await getCurrentSync().Browser.getUniquePageTitle(page.title);\n        const pageClone = await copyPage({ page, reason: 'duplicate', identity: browser.identity });\n\n        pageClone.title = title;\n\n        await browser.addPage(pageClone);\n        await browser.setActivePage(pageClone.pageId);\n    } catch (e) {\n        console.error('failed to duplicate page', e);\n        if (isSupertab) {\n            showError({\n                message: t('enterpriseErrorIndicator.failedToDuplicateSupertab'),\n                parentBrowserName: currentOFIdentity.name\n            });\n        } else {\n            showError({\n                message: t('enterpriseErrorIndicator.failedToDuplicateTab'),\n                parentBrowserName: currentOFIdentity.name\n            });\n        }\n    }\n};\n\nexport const raiseJoinContextGroupAnalytics = (colorName: string, view: OpenFin.Identity) => {\n    raiseBrowserAnalytics({\n        type: 'Interop',\n        action: 'Join Group',\n        value: colorName,\n        data: { name: view.name },\n        skipValueHashing: true\n    });\n};\n\nexport const requestAddToChannel = ({ newChannelId, selectedViews }: AddToChannelRequest) => {\n    selectedViews.forEach(async (view) => {\n        const prevChannelId = await getViewContextGroupId(view);\n        if (prevChannelId === newChannelId) return;\n        try {\n            await updateContextGroup([view], newChannelId);\n            const colorName = titleCase(\n                (await fin.me.interop.getContextGroups())\n                    .find((c) => c.id === newChannelId)\n                    ?.displayMetadata?.name?.toLowerCase() ?? ''\n            );\n            showSuccess({\n                message: colorName\n                    ? t('successIndicator.namedContextGroupApplied', { colorName })\n                    : t('successIndicator.contextGroupApplied'),\n                parentBrowserName: fin.me.name\n            });\n            raiseJoinContextGroupAnalytics(colorName, view);\n        } catch (e) {\n            console.warn(e);\n            showInfo({\n                message: t('infoIndicator.colorLinkAttempt'),\n                parentBrowserName: fin.me.name\n            });\n        }\n    });\n};\n\nexport const raiseLeaveContextGroupAnalytics = (colorName: string, view: OpenFin.Identity) => {\n    raiseBrowserAnalytics({\n        type: 'Interop',\n        action: 'Leave Group',\n        value: colorName,\n        data: { name: view.name },\n        skipValueHashing: true\n    });\n};\n\nexport const requestRemoveFromChannel = (selectedViews: OpenFin.Identity[]) => {\n    selectedViews.forEach(async (view) => {\n        const channelId = await getViewContextGroupId(view);\n        if (!channelId) return;\n        const colorName = titleCase(\n            (await fin.me.interop.getContextGroups())\n                .find((c) => c.id === channelId)\n                ?.displayMetadata?.name?.toLowerCase() ?? ''\n        );\n        updateContextGroup([view], channelId);\n        raiseLeaveContextGroupAnalytics(colorName, view);\n    });\n    showSuccess({\n        message: selectedViews.length > 1 ? t('successIndicator.viewRemoved') : t('successIndicator.viewsRemoved'),\n        parentBrowserName: fin.me.name\n    });\n};\n\nexport const requestShowBrowserIndicator = (payload: ShowIndicatorPayload) => showIndicator(payload);\n","import { isEnterpriseBrowser } from '@common/utils/enterpriseBrowser';\nimport { countViews } from '@common/utils/layout';\nimport { raiseBrowserPageAnalytics } from '@common/utils/usage-register';\n\nimport type { AttachedPage, AttachedPageInternal, ExtendedPanelConfig } from '@common/api/pages/shapes';\n\n/**\n * Interface for the parameters needed to attach pages to a window\n */\nexport interface AttachPagesParams {\n    /** The pages to attach */\n    pages: AttachedPage[];\n    /** The existing pages in the window */\n    existingPages: AttachedPage[];\n    /** Optional index where to insert the new pages */\n    insertionIndex?: number;\n    /** Whether to replace the active page with the first new page */\n    replaceActivePage?: boolean;\n    /** Function to attach panel views */\n    attachPanelViews: (panels: ExtendedPanelConfig[]) => Promise<void>;\n    /** Function to dispatch Redux actions */\n    dispatch: (action: any) => void;\n    /** Function to update pages window options */\n    updatePagesWindowOptions: () => Promise<void>;\n    /** Function to set pages in Redux state */\n    setPages: (pages: AttachedPage[]) => void;\n    /** Function to update a page at a specific index */\n    updatePageAtIndex: (params: { index: number; page: Partial<AttachedPageInternal> }) => void;\n}\n\n/**\n * Interface for the result of attaching pages\n */\nexport interface AttachPagesResult {\n    /** The new attached pages with proper metadata */\n    newAttachedPages: AttachedPage[];\n    /** The updated pages state */\n    newPagesState: AttachedPage[];\n}\n\n/**\n * Creates new attached pages with proper metadata and validation\n *\n * @param pages - The pages to attach\n * @param existingPages - The existing pages in the window\n * @returns Array of new attached pages with proper metadata\n */\nexport const createNewAttachedPages = async (\n    pages: AttachedPage[],\n    existingPages: AttachedPage[]\n): Promise<AttachedPage[]> => {\n    const isEnterprise = await isEnterpriseBrowser();\n\n    return pages.map((page) => {\n        const alreadyExists = existingPages.find((p) => p.pageId === page.pageId);\n        if (alreadyExists) {\n            throw new Error(`Target window already has a page with pageId: ${page.pageId}`);\n        }\n\n        const viewCount = isEnterprise ? countViews(page.layout.content) : 0;\n\n        return {\n            ...page,\n            parentIdentity: fin.me.identity,\n            isActive: false,\n            // only setting multiView here if there are more than one views, otherwise it will be undefined until the layout is created in order to avoid getting singleView title by wrong view id\n            attachedPageType: viewCount > 1 ? 'multiView' : undefined\n        };\n    });\n};\n\n/**\n * Handles panel reparenting for pages that need to be reparented\n *\n * @param newAttachedPages - The new attached pages\n * @param attachPanelViews - Function to attach panel views\n */\nexport const handlePanelReparenting = async (\n    newAttachedPages: AttachedPage[],\n    attachPanelViews: (panels: ExtendedPanelConfig[]) => Promise<void>\n): Promise<void> => {\n    const panelsToReparent = newAttachedPages.reduce((panels: ExtendedPanelConfig[], currentPage: AttachedPage) => {\n        return [...panels, ...(currentPage.panels ? currentPage.panels : [])];\n    }, []);\n\n    await attachPanelViews(panelsToReparent);\n};\n\n/**\n * Updates the pages state based on replaceActivePage logic\n *\n * @param existingPages - The existing pages in the window\n * @param newAttachedPages - The new attached pages\n * @param insertionIndex - Optional index where to insert the new pages\n * @param replaceActivePage - Whether to replace the active page\n * @returns The updated pages state\n */\nexport const updatePagesState = (\n    existingPages: AttachedPage[],\n    newAttachedPages: AttachedPage[],\n    insertionIndex?: number,\n    replaceActivePage?: boolean\n): AttachedPage[] => {\n    const newPagesState = [...existingPages];\n    const activePageIndex = existingPages.findIndex((page) => page.isActive);\n\n    if (activePageIndex !== -1) {\n        // Handle replaceActivePage logic\n        if (replaceActivePage) {\n            // Find the currently active page\n            // Remove the active page and insert new pages at its position\n            newPagesState.splice(activePageIndex, 1, ...newAttachedPages);\n            // Set the first new page as active\n            newPagesState[activePageIndex] = {\n                ...newPagesState[activePageIndex],\n                isActive: true\n            };\n        } else {\n            // Add new pages at specified index or at the end if unspecified\n            const actualInsertIndex = insertionIndex ?? existingPages.length;\n            newPagesState.splice(actualInsertIndex, 0, ...newAttachedPages);\n        }\n    } else {\n        // No active page found, just add at insertion index or at the end if unspecified\n        const actualInsertIndex = insertionIndex ?? existingPages.length;\n        newPagesState.splice(actualInsertIndex, 0, ...newAttachedPages);\n        // Set the first new page as active\n        newPagesState[actualInsertIndex] = {\n            ...newPagesState[actualInsertIndex],\n            isActive: true\n        };\n    }\n    return newPagesState;\n};\n\n/**\n * Sets the first new page as active in Redux state\n *\n * @param newAttachedPages - The new attached pages\n * @param newPagesState - The updated pages state\n * @param updatePageAtIndex - Function to update a page at a specific index\n */\nexport const setFirstPageActive = (\n    newAttachedPages: AttachedPage[],\n    newPagesState: AttachedPage[],\n    updatePageAtIndex: (params: { index: number; page: Partial<AttachedPageInternal> }) => void\n): void => {\n    // Manually set the first new page as active in Redux state\n    if (newAttachedPages.length > 0) {\n        const firstNewPage = newAttachedPages[0];\n        const firstNewPageIndex = newPagesState.findIndex((page) => page.pageId === firstNewPage.pageId);\n        if (firstNewPageIndex !== -1) {\n            updatePageAtIndex({\n                index: firstNewPageIndex,\n                page: { isActive: true }\n            });\n        }\n    }\n};\n\n/**\n * Main function to handle attaching pages to a window\n * This function encapsulates the shared logic between browser and enterprise workspaces\n *\n * @param params - The parameters needed to attach pages\n * @returns Promise that resolves when pages are attached\n */\nexport const attachPagesToWindowCore = async (params: AttachPagesParams): Promise<void> => {\n    const {\n        pages,\n        existingPages,\n        insertionIndex,\n        replaceActivePage,\n        attachPanelViews,\n        dispatch,\n        updatePagesWindowOptions,\n        setPages,\n        updatePageAtIndex\n    } = params;\n\n    if (!pages.length) return;\n\n    // Create new attached pages with proper metadata\n    const newAttachedPages = await createNewAttachedPages(pages, existingPages);\n\n    // Handle panel reparenting\n    await handlePanelReparenting(newAttachedPages, attachPanelViews);\n\n    // Update pages state based on replaceActivePage logic\n    const newPagesState = updatePagesState(existingPages, newAttachedPages, insertionIndex, replaceActivePage);\n\n    // Update Redux state\n    dispatch(setPages(newPagesState));\n\n    if (replaceActivePage) {\n        // Set the first new page as active\n        setFirstPageActive(newAttachedPages, newPagesState, updatePageAtIndex);\n    }\n\n    // Update window options and analytics\n    await updatePagesWindowOptions();\n    raiseBrowserPageAnalytics(newAttachedPages, 'Open Page');\n};\n","import { PageLayout } from '@common/api/pages/shapes';\n\nexport type EnterprisePageRequiredLayoutSettings = {\n    newTabButtonUrl: string;\n};\n\nexport const applyEnterprisePageRequiredLayoutSettings = (\n    requiredSettings: EnterprisePageRequiredLayoutSettings,\n    layout: PageLayout\n) => {\n    if (!layout.settings) {\n        layout.settings = {};\n    }\n\n    if (!(layout.settings as any).newTabButton?.url) {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        layout.settings.newTabButton = { url: requiredSettings.newTabButtonUrl };\n    }\n};\n","import type OpenFin from '@openfin/core';\n\nimport { getEnterpriseLandingUrl } from '@common/utils/browser-base-url';\nimport makeDebouncedFunc from '@common/utils/debounce';\nimport { getLayoutConfig, getUnlockedLayout, mapLayoutViewComponents } from '@common/utils/layout';\nimport { attachPagesToWindowCore } from '@common/utils/pages/attach-pages';\nimport { raiseBrowserPageAnalytics } from '@common/utils/usage-register';\nimport { currentOFIdentity, getCurrentOFWindow, getDisableMultiplePagesOption } from '@common/utils/window';\n\nimport {\n    attachPagesToWindow as AttachPagesToWindowType,\n    detachPagesFromWindow as DetachPagesFromWindowType,\n    getPages as GetPagesType,\n    renamePage as RenamePageType,\n    reorderPagesForWindow as ReorderPagesForWindowType,\n    setActivePageForWindow as SetActivePageForWindowType,\n    updatePageForWindow as UpdatePageForWindowType\n} from '@common/api/pages/attached';\nimport type { AttachedPageInternal } from '@common/api/pages/enterprise-shapes';\nimport type { AttachedPage, SetActivePageForWindowPayload } from '@common/api/pages/shapes';\n\nimport { dispatch, getState } from '@enterprise/api/pages/state';\nimport {\n    selectActivePageWithIndex,\n    selectIsActivePageChanging,\n    selectIsDetachingPages,\n    selectPage,\n    selectPages,\n    selectPageWithIndex,\n    setIsActivePageChanging,\n    setIsDetachingPages,\n    setPages,\n    updatePageAtIndex\n} from '@enterprise/slices/pages/attached';\n\nimport { replaceLayout } from '@enterprise/utils/layout';\n\nimport { getOFView } from '@enterprise/api/view';\n\nimport { deletePageWithSelectedViews } from '@enterprise/slices/tab-focus';\n\nimport { getNextActivePageOnRemoval } from '@enterprise/components/ControlBar/Tablist/utils';\n\nimport { getCurrentSync } from '@client-platform/api';\nimport { applyEnterprisePageRequiredLayoutSettings } from '@client-platform/init/override-callback/enterprise-page-required-layout-settings';\nimport { mapInternalWorkspaceDataToWorkspacePlatform } from '@client-platform/init/override-callback/view-options';\n\nimport { attachPanelViews, getPanelsWithViewSnapshots, setUpPanelViews } from '../panels';\n\n/**\n * Save the current attached page state in window options.\n */\nexport const updatePagesWindowOptions = makeDebouncedFunc(async () => {\n    /*\n     * Always get state from redux store because we need to preserve internal\n     * properties (e.g. layoutContainerKey) for provider snapshot logic\n     */\n    const attachedPages = selectPages(getState());\n    const oldOptions = await (fin.me as OpenFin.Window).getOptions();\n\n    await fin.me.updateOptions({\n        workspacePlatform: {\n            ...oldOptions.workspacePlatform,\n            pages: (await Promise.all(\n                attachedPages.map(async (page) => {\n                    return {\n                        ...page,\n                        parentIdentity: undefined,\n                        isSaved: undefined,\n                        panels: await getPanelsWithViewSnapshots(page.panels)\n                    };\n                })\n            )) as AttachedPage[]\n        }\n    });\n});\n\nconst handleSetActivePageForWindow = async ({ pageId }: SetActivePageForWindowPayload) => {\n    try {\n        const disableMultiplePages = !!(await getDisableMultiplePagesOption(fin.me));\n\n        const [currentActivePage, currentActivePageIndex] = selectActivePageWithIndex(getState());\n        if (currentActivePage?.pageId === pageId) {\n            if (!currentActivePage?.isLayoutCreated) {\n                dispatch(\n                    updatePageAtIndex({\n                        index: currentActivePageIndex,\n                        page: { isLayoutCreated: true }\n                    })\n                );\n            }\n            return;\n        }\n\n        if (disableMultiplePages) {\n            throw new Error('Cannot change active page in a browser window where disableMultiplePages is true');\n        }\n\n        dispatch(setIsActivePageChanging(true));\n\n        const [newActivePage, newActivePageIndex] = selectPageWithIndex(getState(), pageId);\n        if (!newActivePage) {\n            throw new Error(`page with id ${pageId} is not attached to window ${fin.me.identity.name}`);\n        }\n        await setUpPanelViews(newActivePage.panels, currentActivePage?.panels);\n\n        await updatePagesWindowOptions();\n        dispatch(\n            updatePageAtIndex({\n                index: currentActivePageIndex,\n                page: { isActive: false, isLayoutCreated: true }\n            })\n        );\n\n        dispatch(\n            updatePageAtIndex({\n                index: newActivePageIndex,\n                page: { isActive: true, isLayoutCreated: true }\n            })\n        );\n\n        if (currentActivePage) {\n            const layout = fin.Platform.Layout.wrapSync({\n                ...fin.me.identity,\n                layoutName: currentActivePage.layoutContainerKey\n            });\n\n            const currentLayout = await layout.getConfig();\n\n            const layoutConfig = currentActivePage.isLocked\n                ? // never store locked layout settings in memory\n                  getUnlockedLayout(currentLayout, currentActivePage.layout)\n                : currentLayout;\n\n            dispatch(\n                updatePageAtIndex({\n                    index: currentActivePageIndex,\n                    page: { isActive: false, layout: layoutConfig }\n                })\n            );\n        }\n\n        console.debug(`switched from page ${currentActivePage?.pageId} to page ${newActivePage.pageId}`);\n    } finally {\n        dispatch(setIsActivePageChanging(false));\n    }\n};\n\nconst cleanPageInternalProps = (page: AttachedPageInternal): AttachedPage => {\n    const cleanedPage = { ...page };\n    cleanedPage.layoutName = cleanedPage.layoutContainerKey;\n    delete cleanedPage.layoutContainerKey;\n    delete cleanedPage.isLayoutCreated;\n    delete cleanedPage.isLayoutReady;\n    return cleanedPage;\n};\n\nexport const setActivePageForWindow: typeof SetActivePageForWindowType =\n    makeDebouncedFunc(handleSetActivePageForWindow);\n\n/**\n * Get the page from redux and update the layout for the given page id.\n */\nexport const getPageWithLayout = async (pageId: string) => {\n    if (!pageId) {\n        return null;\n    }\n\n    const [page, index] = selectPageWithIndex(getState(), pageId);\n\n    if (!page) {\n        return null;\n    }\n\n    const layout = await getLayoutConfig(page.layoutContainerKey);\n\n    const layoutConfig = page.isLocked\n        ? getUnlockedLayout(layout, page.layout) // never store locked layout setttings in memory\n        : layout;\n\n    dispatch(\n        updatePageAtIndex({\n            index,\n            page: { layout: layoutConfig }\n        })\n    );\n    await updatePagesWindowOptions();\n\n    return selectPage(getState(), pageId);\n};\n\nexport const getActivePageForWindow = async () => {\n    const [{ pageId: activePageId }] = selectActivePageWithIndex(getState());\n    if (activePageId) {\n        return cleanPageInternalProps(await getPageWithLayout(activePageId));\n    }\n\n    return null;\n};\n\nexport const renamePage: typeof RenamePageType = async ({ pageId, newTitle, identity }) => {\n    const [page, index] = selectPageWithIndex(getState(), pageId);\n    if (!page) {\n        throw new Error(`page with id ${pageId} is not attached to window ${identity.name}`);\n    }\n    dispatch(\n        updatePageAtIndex({\n            index,\n            page: { title: newTitle }\n        })\n    );\n    await updatePagesWindowOptions();\n};\n\nexport const getPages: typeof GetPagesType = async () => {\n    // Ensure we have the latest page layouts in redux state\n    await updateInternalPageState();\n\n    const updatedPages = selectPages(getState());\n    return updatedPages.map((page) => {\n        const cleanedPage = cleanPageInternalProps(page);\n        cleanedPage.layout = mapLayoutViewComponents(cleanedPage.layout, mapInternalWorkspaceDataToWorkspacePlatform);\n        return cleanedPage;\n    });\n};\n\nexport const attachPagesToWindow: typeof AttachPagesToWindowType = async ({\n    pages,\n    insertionIndex,\n    replaceActivePage\n}) => {\n    const existingPages = [...selectPages(getState())];\n\n    await attachPagesToWindowCore({\n        pages,\n        existingPages,\n        insertionIndex,\n        replaceActivePage,\n        attachPanelViews,\n        dispatch,\n        updatePagesWindowOptions,\n        setPages,\n        updatePageAtIndex\n    });\n};\n\nexport const detachPagesFromWindow: typeof DetachPagesFromWindowType = async (payload) => {\n    try {\n        dispatch(setIsDetachingPages(true));\n\n        const browser = getCurrentSync().Browser.wrapSync(currentOFIdentity);\n        const attachedPages = selectPages(getState());\n        const detachSet = new Set(payload.pageIds);\n\n        let detachedActivePageIndex = -1;\n        const filteredPages = attachedPages.filter(({ pageId, isActive }, index) => {\n            const isDetached = detachSet.has(pageId);\n            if (isDetached) {\n                // Clear tab focus store of state for pages that are being detached\n                dispatch(deletePageWithSelectedViews(pageId));\n                if (isActive) {\n                    detachedActivePageIndex = index;\n                }\n            }\n            return !isDetached;\n        });\n\n        raiseBrowserPageAnalytics(filteredPages, 'Close Page');\n\n        if (filteredPages.length === 0) {\n            getCurrentOFWindow().close(true);\n            return;\n        }\n\n        if (detachedActivePageIndex !== -1) {\n            const newActivePage = getNextActivePageOnRemoval(detachedActivePageIndex, filteredPages);\n            // We call the setActivePage override here to allow platform developers to effect page-dependent changes on newly active page.\n            await browser.setActivePage(newActivePage.pageId);\n        }\n\n        // We now need to update the filteredPages array so the array contains the newly active page, which we set above.\n        const updatedFilteredPages = selectPages(getState()).filter((page) => !detachSet.has(page.pageId));\n        dispatch(setPages(updatedFilteredPages));\n\n        await updatePagesWindowOptions();\n    } finally {\n        dispatch(setIsDetachingPages(false));\n    }\n};\n\nexport const reorderPagesForWindow: typeof ReorderPagesForWindowType = async ({ pageIds }) => {\n    const pages = selectPages(getState());\n    const reorderMap: Map<string, AttachedPage> = new Map();\n    pages.forEach((page) => reorderMap.set(page.pageId, page));\n    const reorderedPages = pageIds.map((pageId) => reorderMap.get(pageId)).filter((v): v is AttachedPage => !!v);\n    dispatch(setPages(reorderedPages));\n    await updatePagesWindowOptions();\n};\n\nexport const updatePageForWindow: typeof UpdatePageForWindowType = async ({ pageId, page, identity }) => {\n    console.debug(`updating page with id ${pageId}`);\n\n    const [currentPageState, index] = selectPageWithIndex(getState(), pageId);\n    if (!page) {\n        throw new Error(`page with id ${pageId} is not attached to window ${identity.name}`);\n    }\n\n    const anyPayloadPage = page as any;\n    delete anyPayloadPage.isActive;\n    delete anyPayloadPage.parentIdentity;\n    const newPageState = { ...currentPageState, ...page };\n\n    applyEnterprisePageRequiredLayoutSettings(\n        {\n            newTabButtonUrl: await getEnterpriseLandingUrl()\n        },\n        newPageState.layout\n    );\n\n    if (page.pageId && page.pageId !== pageId) {\n        // If pageId is updated (i.e. in Save As), we should consider this a close & open in analytics\n        raiseBrowserPageAnalytics([currentPageState], 'Close Page');\n        raiseBrowserPageAnalytics([newPageState], 'Open Page');\n    }\n\n    dispatch(updatePageAtIndex({ index, page }));\n\n    updatePagesWindowOptions();\n\n    const isLockedStateChanged = Object.hasOwn(page, 'isLocked') && newPageState.isLocked !== currentPageState.isLocked;\n    if (currentPageState.isActive) {\n        // Updating the active page's layout or its isLocked property requires replacing current layout\n        if (page.layout || isLockedStateChanged) {\n            // replacing the layout so need to set the flag to ignore layout events that trigger dirty state\n            dispatch(setIsActivePageChanging(true));\n            const newLayout = page.layout || currentPageState.layout;\n            await replaceLayout(newLayout, newPageState);\n            dispatch(setIsActivePageChanging(false));\n        }\n        // Replace panel views if we're updating the panels object\n        if (page.panels) {\n            // replacing the layout so need to set the flag to ignore view events that trigger dirty state\n            dispatch(setIsActivePageChanging(true));\n            await setUpPanelViews(page.panels, currentPageState.panels);\n            dispatch(setIsActivePageChanging(false));\n        }\n    }\n};\n\nexport const isDetachingPages = () => selectIsDetachingPages(getState());\nexport const isActivePageChanging = () => selectIsActivePageChanging(getState());\n\n// Needed where two views are detached from the same window by a single call such as replaceLayout\nconst checkViewHealthDelay = 1000 * 15;\n\nasync function checkViewHealth(view: OpenFin.View) {\n    const info = await view.getInfo().catch(() => {\n        // Ignored: View has been closed.\n    });\n    if (info && (!info.url || info.url === 'about:blank')) {\n        // If the view is showing the `about:blank` page, try rescuing it.\n        setTimeout(() => {\n            console.warn(`rescuing unhealthy view with name ${view.identity.name}`);\n            rescueCrashedView(view);\n        }, checkViewHealthDelay);\n    }\n}\n\nasync function rescueCrashedView(view: OpenFin.View) {\n    console.warn(`reloading crashed view with name ${view.identity.name}`);\n    await view.reload();\n\n    // Once the view is reloaded, check if it healthy.\n    checkViewHealth(view);\n}\n\nexport const handleViewCrashed = ({ viewIdentity }: { viewIdentity: OpenFin.Identity }) => {\n    const view = getOFView(viewIdentity);\n    rescueCrashedView(view);\n};\n\nexport const handleViewAttached = async ({ viewIdentity }: { viewIdentity: OpenFin.Identity }) => {\n    const view = getOFView(viewIdentity);\n    setTimeout(() => checkViewHealth(view), checkViewHealthDelay);\n};\n\n/**\n * Updates pages in redux state with up-to-date layouts\n */\nexport async function updateInternalPageState() {\n    let layoutSnapshot: OpenFin.LayoutSnapshot;\n    try {\n        layoutSnapshot = await fin.Platform.Layout.getCurrentLayoutManagerSync().getLayoutSnapshot();\n    } catch (error) {\n        // if window layout isn't initialized yet, no need to update state\n    }\n\n    const pages = selectPages(getState());\n    if (layoutSnapshot) {\n        pages.forEach((page, index) => {\n            // when getting pages, return most up-to-date layout (if initialized)\n            const currentLayout = layoutSnapshot.layouts[page.layoutContainerKey] || page.layout;\n            const updatedLayoutConfig = page.isLocked\n                ? getUnlockedLayout(currentLayout, page.layout) // never store locked layout setttings in memory\n                : currentLayout;\n\n            dispatch(\n                updatePageAtIndex({\n                    index,\n                    page: { layout: updatedLayoutConfig }\n                })\n            );\n        });\n        await updatePagesWindowOptions();\n    }\n}\n","import type { AnyAction } from 'redux';\nimport type { ThunkDispatch } from 'redux-thunk';\n\nimport { AttachedPagesRootState } from '@enterprise/slices/pages/attached';\n\nlet dispatchInstance: ThunkDispatch<unknown, unknown, AnyAction>;\nlet getStateInstance: () => AttachedPagesRootState;\n\nexport const getState = () => {\n    return getStateInstance();\n};\n\nexport const dispatch: typeof dispatchInstance = (act: any) => {\n    return dispatchInstance(act);\n};\n\nexport const setGetStateInstance = (instance: typeof getStateInstance) => {\n    getStateInstance = instance;\n};\n\nexport const setDispatchInstance = (instance: typeof dispatchInstance) => {\n    dispatchInstance = instance;\n};\n","import type OpenFin from '@openfin/core';\n\nimport { finUUID } from '@common/utils/env';\nimport { currentOFIdentity } from '@common/utils/window';\n\nimport {\n    ExtendedPanelConfig,\n    PanelConfigHorizontal,\n    PanelConfigVertical,\n    PanelPosition\n} from '@common/api/pages/shapes';\n\nimport { selectActivePageWithIndex, updatePageAtIndex } from '@enterprise/slices/pages/attached';\n\nimport { getSizeWithoutCSSUnits } from '@enterprise/components/PanelContainer/PanelContainer';\n\nimport { dispatch, getState } from './pages/state';\n\nconst resizeObserverDisconnectCallbacks = new Map<string, () => void>();\n\nconst isPanelZeroSized = (panelConfig: ExtendedPanelConfig) => {\n    const primaryDimension = [PanelPosition.Left, PanelPosition.Right].includes(panelConfig.position)\n        ? (panelConfig as PanelConfigVertical).width\n        : (panelConfig as PanelConfigHorizontal).height;\n    return getSizeWithoutCSSUnits(primaryDimension) === 0;\n};\n\nexport async function attachPanelViews(panels: ExtendedPanelConfig[] = []) {\n    const panelInitPromises = panels.map(async (panelConfig) => {\n        const view = fin.View.wrapSync({ name: panelConfig.viewOptions.name, uuid: fin.me.uuid });\n        await view.attach(fin.me.identity);\n\n        if (isPanelZeroSized(panelConfig)) {\n            await view.hide();\n        } else {\n            await view.show();\n        }\n\n        const panelElement = document.getElementById('panel' + panelConfig.position);\n        const disconnectCallback = await view.bindToElement(panelElement);\n        resizeObserverDisconnectCallbacks.set(panelConfig.viewOptions.name, disconnectCallback);\n    });\n    await Promise.all(panelInitPromises);\n}\n\nexport async function setUpPanelViews(panels: ExtendedPanelConfig[] = [], panelsToReplace: ExtendedPanelConfig[] = []) {\n    for (const disconnectCallback of resizeObserverDisconnectCallbacks.values()) {\n        disconnectCallback();\n    }\n    resizeObserverDisconnectCallbacks.clear();\n\n    await attachPanelViews(panels);\n\n    const viewDetachPromises = panelsToReplace.map(async (oldPanel) => {\n        if (!panels.find((newPanel) => newPanel.viewOptions.name === oldPanel.viewOptions.name)) {\n            // Attach view that's no longer needed to platform window for cleanup\n            const view = fin.View.wrapSync(oldPanel.viewOptions);\n            await view.attach({ name: currentOFIdentity.uuid, uuid: currentOFIdentity.uuid });\n            await view.hide();\n        }\n    });\n    await Promise.all(viewDetachPromises);\n}\n\nexport async function getPanelsWithViewSnapshots(panels: ExtendedPanelConfig[] = []) {\n    return Promise.all(\n        panels.map(async (panel) => {\n            const platform = fin.Platform.getCurrentSync();\n            const snapshotViewOpts = await platform.getViewSnapshot(panel.viewOptions);\n            return { ...panel, viewOptions: { ...snapshotViewOpts, uuid: finUUID } };\n        })\n    );\n}\n\nexport const handlePanelViewDetached = (e: OpenFin.WindowEvents.ViewDetachedEvent) => {\n    // View attached to another browser, not platform provider\n    // Target is sometimes `null` if a view is destroyed\n    if (e.target?.name !== fin.me.uuid) {\n        const [activePage, activePageIndex] = selectActivePageWithIndex(getState());\n\n        // remove panel config if view of the panel is grabbed by another browser window\n        const filteredPanels = activePage.panels?.filter((panel: ExtendedPanelConfig) => {\n            const isViewIdentityMatching = panel.viewOptions.name === e.viewIdentity.name;\n            if (isViewIdentityMatching) {\n                const disconnectCallback = resizeObserverDisconnectCallbacks.get(panel.viewOptions.name);\n                disconnectCallback();\n                resizeObserverDisconnectCallbacks.delete(panel.viewOptions.name);\n            }\n            return !isViewIdentityMatching;\n        }) as ExtendedPanelConfig[];\n\n        dispatch(\n            updatePageAtIndex({\n                index: activePageIndex,\n                page: { ...activePage, panels: filteredPanels }\n            })\n        );\n    }\n};\n","import type OpenFin from '@openfin/core';\n\nimport { isFin } from '@common/utils/env';\nimport { getNewLandingTabViewOptions } from '@common/utils/landing-page';\n\nimport { getCurrentSync } from '@client-platform/api';\n\nexport function getOFView(identity: OpenFin.Identity) {\n    if (!isFin) {\n        throw new Error(\n            'getOFView can only be used in an OpenFin env. Avoid calling this method during pre-rendering.'\n        );\n    }\n    return fin.View.wrapSync(identity);\n}\n\n/**\n * Creates a new View to the landing page at the end of the tab strip\n * which includes the currently selected View\n * @param view the currently selected View\n */\nexport const makeNewView = async (view: OpenFin.View) => {\n    const windowIdentity = fin.Window.getCurrentSync().identity;\n    const viewOptions = await getNewLandingTabViewOptions(windowIdentity);\n    await getCurrentSync().createView(viewOptions, windowIdentity, view.identity);\n};\n\n/**\n * Duplicates the current View at the end of the tab strip\n * which includes the currently selected View\n * @param view the currently selected View\n */\nexport const duplicateView = async (view: OpenFin.View) => {\n    const windowIdentity = fin.Window.getCurrentSync().identity;\n    // need to get url separately because it's not updated in options\n    const { url } = await view.getInfo();\n    const sourceViewOpts = await view.getOptions();\n    const viewOptions = {\n        ...sourceViewOpts,\n        url,\n        target: windowIdentity,\n        name: undefined\n    } as OpenFin.PlatformViewCreationOptions;\n    await getCurrentSync().createView(viewOptions, windowIdentity, view.identity);\n};\n","import { getEnterpriseBaseUrl } from '@common/utils/browser-base-url';\nimport { DefaultSaveMenuBounds } from '@common/utils/context-menu';\nimport { MenuConfig, ResponseModalConfig, RightMenuConfig } from '@common/utils/menu-config';\nimport Route from '@common/utils/route';\nimport { currentOFIdentity, WindowName } from '@common/utils/window';\n\nimport { t } from '@common/api/i18next';\n\ntype PageCloseMenuOptions = { textInputOptions: { placeholder: string; defaultValue: string }; titlePrefix?: string };\n\n// This menu is being used by waitForModalResponse so is not kept in redux state\nexport const getPageCloseMenu = async ({\n    textInputOptions,\n    titlePrefix\n}: PageCloseMenuOptions): Promise<ResponseModalConfig> => {\n    return {\n        title: 'Page Close',\n        windowOptions: {\n            url: (await getEnterpriseBaseUrl()) + Route.ResponseModal,\n            name: WindowName.BrowserMenu,\n            defaultHeight: textInputOptions ? 157 : 113,\n            defaultWidth: 410,\n            modalParentIdentity: currentOFIdentity\n        },\n        content: {\n            title: (titlePrefix || '') + t('modal.saveChangesPrompt'),\n            body: t('enterpriseModal.discardSupertabWarning'),\n            buttons: {\n                left: [\n                    {\n                        label: t('saveModal.discardChanges'),\n                        type: 'secondary',\n                        id: 'Discard Changes',\n                        variant: 'outline'\n                    }\n                ],\n                right: [\n                    { label: t('global.cancel'), type: 'secondary', id: 'Cancel', variant: 'outline' },\n                    { label: t('global.save'), type: 'primary', id: 'Save', variant: 'submit' }\n                ]\n            },\n            closeType: 'page',\n            textInputOptions\n        },\n        parameters: new URLSearchParams({ isEnterprise: `${true}` })\n    };\n};\n\ntype WindowCloseMenuOptions = { unsavedPagesCount: number };\n// This menu is being used by waitForModalResponse so is not kept in redux state\nexport const getBrowserWindowCloseMenu = async ({\n    unsavedPagesCount\n}: WindowCloseMenuOptions): Promise<ResponseModalConfig> => {\n    return {\n        title: 'Window Close',\n        windowOptions: {\n            url: (await getEnterpriseBaseUrl()) + Route.ResponseModal,\n            name: WindowName.BrowserMenu,\n            defaultHeight: 119,\n            defaultWidth: 410,\n            modalParentIdentity: currentOFIdentity\n        },\n        content: {\n            title: t('enterpriseSaveModal.saveSupertabCount', {\n                count: unsavedPagesCount\n            }),\n            body: t('enterpriseModal.discardSupertabWarning'),\n            buttons: {\n                left: [{ label: t('saveModal.discardAll'), type: 'secondary', id: 'Discard All' }],\n                right: [\n                    { label: t('global.cancel'), type: 'secondary', id: 'Cancel' },\n                    { label: t('saveModal.saveAll'), type: 'primary', id: 'Save All' }\n                ]\n            }\n        },\n        parameters: new URLSearchParams({ isEnterprise: `${true}` })\n    };\n};\n\nexport const getColorLinkingMenu = async (title: string): Promise<RightMenuConfig> => ({\n    title,\n    windowOptions: {\n        url: (await getEnterpriseBaseUrl()) + Route.BrowserPopupMenuColorLinking,\n        name: WindowName.BrowserMenu,\n        defaultHeight: 37,\n        defaultWidth: 226\n    }\n});\n\nexport const getLayoutsMenu = async (title: string): Promise<RightMenuConfig> => ({\n    title,\n    windowOptions: {\n        url: (await getEnterpriseBaseUrl()) + Route.BrowserPopupMenuLayouts,\n        name: WindowName.BrowserMenu,\n        defaultHeight: 37,\n        defaultWidth: 138\n    }\n});\n\nexport const getSaveMenu = async (): Promise<MenuConfig> => ({\n    title: t('toolbar.saveMenu'),\n    windowOptions: {\n        url: (await getEnterpriseBaseUrl()) + Route.BrowserPopupMenuSaveModal,\n        name: WindowName.BrowserSaveMenu,\n        defaultWidth: DefaultSaveMenuBounds.width,\n        defaultHeight: DefaultSaveMenuBounds.height\n    }\n});\n","import { AttachedPage } from '@common/api/pages/shapes';\n\n/**\n * Gets the index of the page that should be active once current active page is removed.\n * @param detachedActivePageIndex Index of the active page prior to being removed\n * @param filteredPages Remaining pages\n * @returns page that should be active once current active page is removed\n */\nexport const getNextActivePageOnRemoval = (detachedActivePageIndex: number, filteredPages: AttachedPage[]) => {\n    let newActiveIndex = detachedActivePageIndex > 0 ? detachedActivePageIndex - 1 : 0;\n    if (newActiveIndex >= filteredPages.length) {\n        newActiveIndex = filteredPages.length - 1;\n    }\n    return filteredPages[newActiveIndex];\n};\n","var _path, _path2;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nvar SvgPencil = function SvgPencil(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 12,\n    height: 12,\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, props), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M9.372 2.12a.414.414 0 0 0-.585.001L4.724 6.184a.414.414 0 0 0-.12.256l-.092 1.05 1.047-.093a.414.414 0 0 0 .256-.12l3.388-3.386.676-.676a.414.414 0 0 0 0-.585l-.507-.51c0 .001 0 0 0 0ZM8.08 1.415a1.414 1.414 0 0 1 2 0l.506.509a1.414 1.414 0 0 1 0 1.999L6.523 7.985c-.235.235-.545.38-.876.408l-1.251.111c-.17.015-.469.017-.693-.21-.223-.224-.22-.522-.205-.69l.11-1.252c.03-.33.174-.64.409-.875L8.08 1.414Z\",\n    fill: \"#140611\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M3.215 2A1.214 1.214 0 0 0 2 3.215v5.57A1.214 1.214 0 0 0 3.215 10h5.57A1.214 1.214 0 0 0 10 8.786V6.793a.5.5 0 0 1 1 0v1.993A2.214 2.214 0 0 1 8.786 11H3.215A2.214 2.214 0 0 1 1 8.786V3.215A2.215 2.215 0 0 1 3.215 1h1.992a.5.5 0 0 1 0 1H3.215Z\",\n    fill: \"#140611\"\n  })));\n};\nexport default SvgPencil;","import { useCallback, useEffect, useRef, useState } from 'react';\n\nimport { getAICompanionViewIdentity } from '@common/utils/enterpriseBrowser';\nimport { addLayoutEventListener } from '@common/utils/layout';\n\nimport { SidePanelComponent, useShouldHidePanelComponent } from '@enterprise/context/SidePanelContext';\n\nimport { AICompanionPanelId } from './AICompanionPanel';\n\ntype InboundAIChannelMessage = {\n    topic: 'new-chat-button';\n    showNewChatButton: boolean;\n};\n\ntype OutboundAIChannelMessage = {\n    topic: 'new-chat-button-clicked';\n};\n\n/**\n * Custom hook to initialize and manage the AI Companion view within the side panel.\n *\n * This hook:\n * - Attaches the AI Companion view to the current window and binds it to the AI Companion panel's DOM element.\n * - Listens for layout container resize events and rebinds the view to the panel element.\n * - Toggles the visibility of the AI Companion view based on whether the panel should be hidden.\n * - Listens for messages on a broadcast channel to update the state of the \"New Chat\" button.\n * - Provides a handler to notify when the \"New Chat\" button is clicked.\n *\n * @returns {{\n *   hidden: boolean,\n *   showNewChatButton: boolean,\n *   handleNewChatClicked: () => void\n * }} An object containing:\n * - `hidden`: A boolean indicating whether the AI Companion panel is hidden.\n * - `showNewChatButton`: A boolean indicating whether the \"New Chat\" button should be shown.\n * - `handleNewChatClicked`: A function to notify that the \"New Chat\" button has been clicked.\n */\nexport const useInitializeAICompanionView = () => {\n    const hidden = useShouldHidePanelComponent(SidePanelComponent.AICompanion);\n    const broadcastChannel = useRef<BroadcastChannel>();\n\n    const [showNewChatButton, setShowNewChatButton] = useState<boolean>(false);\n\n    const handleChannelMessage = useCallback(({ data }: MessageEvent<InboundAIChannelMessage>) => {\n        if (data.topic === 'new-chat-button') {\n            setShowNewChatButton(data.showNewChatButton);\n        }\n    }, []);\n\n    useEffect(() => {\n        const attachAICompanionView = async () => {\n            const aiCompanionView = fin.View.wrapSync(getAICompanionViewIdentity());\n            await aiCompanionView.attach(fin.me.identity);\n            const aiCompanionPanelDiv = document.getElementById(AICompanionPanelId);\n            await aiCompanionView.bindToElement(aiCompanionPanelDiv);\n            addLayoutEventListener('container-resized', () => aiCompanionView.bindToElement(aiCompanionPanelDiv));\n        };\n\n        attachAICompanionView();\n        broadcastChannel.current = new BroadcastChannel(`ai-companion-${fin.me.identity.name}`);\n        broadcastChannel.current.onmessage = handleChannelMessage;\n    }, []);\n\n    useEffect(() => {\n        const aiCompanionView = fin.View.wrapSync(getAICompanionViewIdentity());\n        if (hidden) {\n            aiCompanionView.hide();\n        } else {\n            aiCompanionView.show();\n        }\n    }, [hidden]);\n\n    const handleNewChatClicked = useCallback(() => {\n        broadcastChannel.current.postMessage({ topic: 'new-chat-button-clicked' } as OutboundAIChannelMessage);\n    }, []);\n\n    return { hidden, showNewChatButton, handleNewChatClicked };\n};\n","import React from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport styled from 'styled-components';\n\nimport { Text } from '@openfin/ui-library';\n\nimport BaseButton from '@common/components/BaseButton/BaseButton';\nimport CloseButtonLarge from '@common/components/CloseButton/CloseButtonLarge';\n\nimport AICompanionIcon from '@enterprise/assets/icons/ai-companion.svg';\nimport PencilIcon from '@enterprise/assets/icons/pencil.svg';\n\nimport { PaddingBorderMixin } from '@enterprise/components/mixins/padding-border';\n\nimport { SidePanelComponent, useSidePanelContext } from '@enterprise/context/SidePanelContext';\nimport { useIsWindows } from '@enterprise/hooks/useIsWindows';\n\nimport { useInitializeAICompanionView } from './useInitializeAICompanionView';\n\nexport const AICompanionPanelId = 'aiCompanionPanel';\n\nconst AICompanionPanel = () => {\n    const { t } = useTranslation();\n    const isWindows = useIsWindows();\n\n    const { toggleSidePanelComponent } = useSidePanelContext();\n    const { hidden, showNewChatButton, handleNewChatClicked } = useInitializeAICompanionView();\n\n    return (\n        <Container hidden={hidden}>\n            <HeaderContainer>\n                <LeftContainer>\n                    <AICompanionIcon />\n                    <Text>{t('sidePanel.aiCenter')}</Text>\n                </LeftContainer>\n                <RightContainer>\n                    {showNewChatButton && (\n                        <NewChatButton onClick={handleNewChatClicked}>\n                            <PencilIcon />\n                            <Text>{t('sidePanel.newChat')}</Text>\n                        </NewChatButton>\n                    )}\n                    <CloseButtonLarge\n                        onClick={() => toggleSidePanelComponent(SidePanelComponent.AICompanion)}\n                        aria-label={t('sidePanel.closePanel')}\n                    />\n                </RightContainer>\n            </HeaderContainer>\n            <BorderPaddingContainer isWindows={isWindows}>\n                <ViewContentContainer id={AICompanionPanelId} />\n            </BorderPaddingContainer>\n        </Container>\n    );\n};\n\nexport default AICompanionPanel;\n\nconst Container = styled.div<{ hidden: boolean }>`\n    height: 100%;\n    width: 100%;\n\n    display: ${({ hidden }) => (hidden ? 'none' : 'flex')};\n    flex-direction: column;\n\n    ${Text} {\n        font-weight: 500;\n        user-select: none;\n    }\n`;\n\nconst HeaderContainer = styled.div`\n    height: 48px;\n    padding: 0px ${({ theme }) => theme.px.base};\n    border-bottom: 1px solid ${({ theme }) => theme.palette.background3};\n\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    flex-shrink: 0;\n`;\n\nconst LeftContainer = styled.div`\n    display: flex;\n    gap: ${({ theme }) => theme.px.xsmall};\n    align-items: center;\n\n    svg path {\n        fill: ${({ theme }) => theme.palette.textDefault};\n    }\n`;\n\nconst RightContainer = styled.div`\n    display: flex;\n    gap: ${({ theme }) => theme.px.small};\n    align-items: center;\n`;\n\nconst NewChatButton = styled(BaseButton).attrs({ borderRadius: 'xsmall', customContentSize: true })`\n    width: max-content;\n    padding: 2px ${({ theme }) => theme.px.small};\n\n    border: 1px solid ${({ theme }) => theme.palette.background4};\n    background-color: transparent;\n\n    & > div {\n        gap: ${({ theme }) => theme.px.xsmall};\n    }\n\n    &:hover {\n        background-color: unset;\n    }\n\n    svg {\n        margin-left: -1px;\n\n        path {\n            fill: ${({ theme }) => theme.palette.inputColor};\n        }\n    }\n`;\n\nconst BorderPaddingContainer = styled.div<{ isWindows: boolean }>`\n    width: 100%;\n    flex-grow: 1;\n\n    ${({ theme, isWindows }) =>\n        isWindows &&\n        PaddingBorderMixin({\n            size: 1,\n            dimensions: { top: false, right: false, bottom: false },\n            borderColor: theme.palette.background1\n        })};\n`;\n\nconst ViewContentContainer = styled.div`\n    height: 100%;\n    width: 100%;\n`;\n","import React from 'react';\n\nimport styled, { css } from 'styled-components';\n\nimport { PanelPosition } from '@common/api/pages/shapes';\n\nimport AICompanionPanel from '@enterprise/components/PanelContainer/AICompanionPanel/AICompanionPanel';\nimport BookmarksPanel from '@enterprise/components/PanelContainer/BookmarksPanel/BookmarksPanel';\n\nimport { MAC_WINDOW_BORDER_RADIUS } from '@common/mixins/padding-border';\nimport { useSidePanelContext } from '@enterprise/context/SidePanelContext';\nimport { useIsWindows } from '@enterprise/hooks/useIsWindows';\nimport { CSSBounds, usePanelBounds } from '@enterprise/hooks/usePanelBounds';\n\ninterface Props {\n    position: PanelPosition;\n}\n\nconst PanelContainer: React.FC<Props> = ({ position }) => {\n    const cssBounds = usePanelBounds(position);\n    const { isAICompanionEnabled } = useSidePanelContext();\n    const isWindows = useIsWindows();\n\n    return (\n        <Panel {...cssBounds} tabIndex={0} id={'panel' + position} isWindows={isWindows}>\n            {<BookmarksPanel />}\n            {isAICompanionEnabled && <AICompanionPanel />}\n        </Panel>\n    );\n};\n\nexport default PanelContainer;\n\nexport const getSizeWithoutCSSUnits = (cssValue: string | number = ''): number => {\n    const stringValue = String(cssValue);\n    const asNumber = Number(stringValue.replace(/[a-zA-Z]*(%)*/g, ''));\n    return !Number.isNaN(asNumber) ? asNumber : null;\n};\n\nconst Panel = styled.div<CSSBounds & { isWindows: boolean }>`\n    height: ${({ height }) => height};\n    width: ${({ width }) => width};\n\n    left: ${({ left }) => left || 'unset'};\n    right: ${({ right }) => right || 'unset'};\n    top: ${({ top }) => top || 'unset'};\n    bottom: ${({ bottom }) => bottom || 'unset'};\n\n    display: ${({ width, height }) =>\n        getSizeWithoutCSSUnits(width) === 0 || getSizeWithoutCSSUnits(height) === 0 ? 'none' : 'flex'};\n\n    background-color: ${({ theme }) => theme.palette.background1};\n    position: absolute;\n    box-sizing: ${({ isWindows }) => (isWindows ? 'border-box' : 'content-box')};\n    border: 1px solid ${({ theme }) => theme.palette.background5};\n    margin-top: ${({ top }) => (top === '0px' ? '-1px' : '0')};\n    margin-bottom: ${({ bottom }) => (bottom === '0px' ? '-1px' : '0')};\n    margin-right: ${({ right }) => (right === '0px' ? '-1px' : '0')};\n    border-radius: 0;\n    ${({ isWindows, width }) =>\n        !isWindows &&\n        css`\n            border-bottom-right-radius: ${MAC_WINDOW_BORDER_RADIUS};\n            box-shadow: none;\n            width: ${width ? `calc(${width} - 1px)` : 'unset'};\n        `}\n    overflow: hidden;\n`;\n","import { css } from 'styled-components';\n\ntype BorderProps = {\n    size?: number;\n    dimensions?: { top?: number | false; bottom?: number | false; right?: number | false; left?: number | false };\n    borderColor: string;\n    backgroundColor?: string;\n};\n\nconst getDimension = (defaultSize = 0, size?: number | false) => {\n    if (size === false) {\n        return 0;\n    }\n    if (size >= 0) {\n        return size;\n    }\n    return defaultSize;\n};\n\nexport const PaddingBorderMixin = ({ size, dimensions = {}, borderColor, backgroundColor }: BorderProps) => css`\n    background-color: ${borderColor};\n    padding-left: ${getDimension(size, dimensions.left)}px;\n    padding-right: ${getDimension(size, dimensions.right)}px;\n    padding-top: ${getDimension(size, dimensions.top)}px;\n    padding-bottom: ${getDimension(size, dimensions.bottom)}px;\n    > * {\n        ${backgroundColor\n            ? css`\n                  background-color: ${backgroundColor};\n              `\n            : ''}\n    }\n`;\n","import { PanelConfigVertical, PanelPosition } from '@client-platform/index';\n\nexport const NAVIGATION_RAIL_WIDTH = 40;\nexport const SIDE_PANEL_WIDTH = 340;\n\nexport const getSidePanelConfig = (shouldShowNavigationRail: boolean): PanelConfigVertical => {\n    const sidePanelWidth = shouldShowNavigationRail ? SIDE_PANEL_WIDTH + NAVIGATION_RAIL_WIDTH : SIDE_PANEL_WIDTH;\n    return {\n        position: PanelPosition.Right,\n        width: `${sidePanelWidth}px`\n    };\n};\n","import { useEffect, useMemo, useState } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { FalseyValue } from 'styled-components';\n\nimport { addLayoutEventListener } from '@common/utils/layout';\n\nimport { PanelConfigHorizontal, PanelConfigVertical, PanelPosition } from '@common/api/pages/shapes';\n\nimport { selectActivePage } from '@enterprise/slices/pages/attached';\n\nimport { getSizeWithoutCSSUnits } from '@enterprise/components/PanelContainer/PanelContainer';\nimport { getSidePanelConfig } from '@enterprise/components/PanelContainer/utils';\n\nimport { useSidePanelContext } from '@enterprise/context/SidePanelContext';\n\n/**\n * A template processor that converts falsey values to '0px'.\n * Helps avoid verbosity when writing complex CSS calc() expressions\n * @param strings slices of the template that surround values to process\n * @param values CSS measurement values, potentially falsey\n * @returns string with falsey values converted to 0px\n */\nconst units = (strings: TemplateStringsArray, ...values: (string | FalseyValue)[]) => {\n    let result = strings[0];\n    for (let i = 0; i < values.length; i++) {\n        const value = values[i] || '0px';\n        result += value + strings[i + 1];\n    }\n    return result;\n};\n\nexport type CSSBounds = Partial<Record<'top' | 'right' | 'bottom' | 'left' | 'height' | 'width', string>>;\n\nconst zeroBounds: CSSBounds = { left: '0', top: '0', width: '0', height: '0' };\n\nexport const usePanelBounds = (panelPosition: PanelPosition | 'Center') => {\n    const activePage = useSelector(selectActivePage);\n    const [resizeCounter, setResizeCounter] = useState(0);\n    const { isSidePanelOpen } = useSidePanelContext();\n\n    const pagelessPanels: (PanelConfigHorizontal | PanelConfigVertical)[] = useMemo(() => {\n        if (isSidePanelOpen) {\n            return [getSidePanelConfig(false)];\n        }\n        return [];\n    }, [isSidePanelOpen]);\n\n    useEffect(() => {\n        if (panelPosition === PanelPosition.Right || panelPosition === PanelPosition.Bottom) {\n            /*\n             * When resizing window along only an x or y axis, the Right/Bottom panel element doesn't resize\n             * but only moves along the corresponding axis.\n             * Mere position change doesn't trigger ResizeObserver and view remains in the old position.\n             * We need to resize the panel by a unique tiny amount to trigger view reposition.\n             */\n            addLayoutEventListener('container-resized', () => setResizeCounter((currentVal) => currentVal + 1));\n        }\n    }, [panelPosition]);\n\n    const cssBounds = useMemo(() => {\n        const panels = activePage.panels;\n        const topConfig = (panels?.find((panel) => panel.position == PanelPosition.Top) ||\n            pagelessPanels?.find((panel) => panel.position == PanelPosition.Top)) as PanelConfigHorizontal | undefined;\n\n        const leftConfig = (panels?.find((panel) => panel.position == PanelPosition.Left) ||\n            pagelessPanels?.find((panel) => panel.position == PanelPosition.Left)) as PanelConfigVertical | undefined;\n\n        const rightConfig = (panels?.find((panel) => panel.position == PanelPosition.Right) ||\n            pagelessPanels?.find((panel) => panel.position == PanelPosition.Right)) as PanelConfigVertical | undefined;\n\n        const bottomConfig = (panels?.find((panel) => panel.position == PanelPosition.Bottom) ||\n            pagelessPanels?.find((panel) => panel.position == PanelPosition.Bottom)) as\n            | PanelConfigHorizontal\n            | undefined;\n\n        const extendLeftPanelToTop = leftConfig?.extendToTop;\n        const extendLeftPanelToBottom = leftConfig?.extendToBottom;\n\n        const extendRightPanelToTop = rightConfig?.extendToTop;\n        const extendRightPanelToBottom = rightConfig?.extendToBottom;\n\n        switch (panelPosition) {\n            case PanelPosition.Left:\n                return {\n                    left: '0',\n                    top: units`${!extendLeftPanelToTop && topConfig?.height}`,\n                    width: units`${leftConfig?.width}`,\n                    height: units`calc(100% - ${!extendLeftPanelToTop && topConfig?.height} - ${\n                        !extendLeftPanelToBottom && bottomConfig?.height\n                    })`\n                };\n            case PanelPosition.Right:\n                return {\n                    right: '0px',\n                    top: units`${!extendRightPanelToTop && topConfig?.height}`,\n                    // Not resizing by tiny amount because we will rebind AI side panel view explicitly on layout resize\n                    width:\n                        getSizeWithoutCSSUnits(units`${rightConfig?.width}`) === 0\n                            ? '0px' // no need to offset by a small value if it's a 0 sized panel\n                            : `${rightConfig?.width}`,\n                    height: units`calc(100% - ${!extendRightPanelToTop && topConfig?.height} - ${\n                        !extendRightPanelToBottom && bottomConfig?.height\n                    })`\n                };\n            case PanelPosition.Top:\n                return {\n                    left: units`${extendLeftPanelToTop && leftConfig?.width}`,\n                    top: '0',\n                    width: units`calc(100% - ${extendLeftPanelToTop && leftConfig?.width} - ${\n                        extendRightPanelToTop && rightConfig?.width\n                    })`,\n                    height: units`${topConfig?.height}`\n                };\n            case PanelPosition.Bottom:\n                return {\n                    left: units`${extendLeftPanelToBottom && leftConfig?.width}`,\n                    bottom: '0',\n                    width: units`calc(100% - ${extendLeftPanelToBottom && leftConfig?.width} - ${\n                        extendRightPanelToBottom && rightConfig?.width\n                    })`,\n                    // need to resize by a tiny value in order to trigger view repositioning\n                    height:\n                        getSizeWithoutCSSUnits(units`${bottomConfig?.height}`) === 0\n                            ? '0px' // no need to offset by a small value if it's a 0 sized panel\n                            : units`calc(${bottomConfig?.height} - ${(resizeCounter % 2) / 1000 + 'cm'})`\n                };\n            case 'Center':\n                return {\n                    left: units`${leftConfig?.width}`,\n                    top: units`${topConfig?.height}`,\n                    // If side panel is activated, we have to account for navigation rail width\n                    width: units`calc(100% - ${leftConfig?.width} - ${rightConfig?.width})`,\n                    height: units`calc(100% - ${topConfig?.height} - ${bottomConfig?.height})`\n                };\n            default:\n                return zeroBounds;\n        }\n    }, [pagelessPanels, activePage.panels, panelPosition, resizeCounter]);\n\n    return cssBounds;\n};\n","import { replaceLayout as commonReplaceLayout } from '@common/utils/layout';\r\n\r\nimport { dispatch, getState } from '@enterprise/api/pages/state';\r\nimport { selectPageWithIndex, updatePageAtIndex } from '@enterprise/slices/pages/attached';\r\n\r\nimport { AttachedPage, PageLayout } from '@client-platform/index';\r\n\r\nexport const replaceLayout = async (layout: PageLayout, page: AttachedPage): Promise<void> => {\r\n    // Set layout ready to false so dirty events are not handled while the layout is being replaced.\r\n    const [_, index] = selectPageWithIndex(getState(), page.pageId);\r\n\r\n    dispatch(updatePageAtIndex({ index, page: { isLayoutReady: false } }));\r\n\r\n    return commonReplaceLayout(layout, page);\r\n};\r\n"],"names":["_path","_extends","Object","assign","bind","n","e","arguments","length","t","r","hasOwnProperty","call","apply","__webpack_exports__","Z","props","react__WEBPACK_IMPORTED_MODULE_0__","createElement","width","height","fill","xmlns","d","trackRemovedPage","page","getCurrentSync","Browser","wrapSync","currentOFIdentity","_trackRemovedTab","identity","trackRemovedWindow","w","getCurrentOFWindow","options","getOptions","workspacePlatform","window","raiseBrowserModalAnalytics","action","type","value","data","raiseBrowserAnalytics","skipValueHashing","raisePageModalAnalytics","raiseWindowModalAnalytics","showClosePageModal","param","isSaved","titlePrefix","textInputOptions","placeholder","defaultValue","title","windowOptions","content","parameters","getPageCloseMenu","browser","setActivePage","pageId","top","left","getResponseModalBoundsAndCenterParentIfModalOffScreen","pageCloseOptions","waitForModalResponse","conditionallyAwaitFunction","fn","shouldAwait","handleClosePageModalResponse","analyticsFunction","response","recentlyActivePageId","pageTitle","awaitAnalytics","skipPageClose","platform","actionName","removePage","newTitle","textInputValue","updatePage","hasUnsavedChanges","pageToSave","getPage","analyticsVerb","Storage","savePage","concat","showSuccess","message","parentBrowserName","name","secondaryMessage","isEnterprise","err","console","error","showError","shouldShowUnsavedPageModal","countViews","payload","layout","log","shouldShowModal","handleClosePageRequest","createAsyncThunk","param1","pages","closeType","getState","dispatch","updateInternalPageState","selectPages","targetPage","find","shouldPageClose","requestShouldPageClose","debug","isActive","savedPage","isLastPage","getPagesToSave","browserPages","unsavedPages","filter","isPageSavable","Promise","all","map","_page","index","hasPageBeenSavedBefore","storagePage","some","storedPage","categorizePagesBySaveStatus","savablePages","pagesInStorage","reduce","accum","previouslySavedPages","push","neverSavedPages","savePreviouslySavedPages","i","cleanPage","handleUnsavedPagesWithRenameModals","getPages","modalResponse","closeBrowserWindow","currentWindow","close","handleCloseWindowRequest","_","shouldWindowClose","requestShouldWindowClose","fin","me","focus","getBrowserWindowCloseMenu","unsavedPagesCount","browserWindowCloseOptions","allSavePageModalsHandled","uuid","requestCloseBrowserWindow","store","requestClosePage","args","requestOpenSaveModal","menuType","id","menuOptions","invocationId","Date","now","toString","windowOpts","getSaveMenu","bounds","SaveModalType","SAVE_PAGE","SAVE_PAGE_AS","RENAME_PAGE","popupWin","showChildWindow","url","defaultHeight","defaultWidth","defaultLeft","defaultTop","URLSearchParams","requestDuplicatePage","isSupertab","selectPage","attachedPageType","getUniquePageTitle","pageClone","copyPage","reason","addPage","raiseJoinContextGroupAnalytics","colorName","view","requestAddToChannel","newChannelId","selectedViews","forEach","prevChannelId","getViewContextGroupId","_find_displayMetadata_name","_find_displayMetadata","_find","_find_displayMetadata_name_toLowerCase","updateContextGroup","titleCase","interop","getContextGroups","c","displayMetadata","toLowerCase","warn","showInfo","raiseLeaveContextGroupAnalytics","requestRemoveFromChannel","channelId","requestShowBrowserIndicator","showIndicator","createNewAttachedPages","existingPages","isEnterpriseBrowser","p","viewCount","parentIdentity","undefined","handlePanelReparenting","newAttachedPages","attachPanelViews","panelsToReparent","panels","currentPage","updatePagesState","insertionIndex","replaceActivePage","newPagesState","activePageIndex","findIndex","splice","actualInsertIndex","setFirstPageActive","updatePageAtIndex","firstNewPage","firstNewPageIndex","attachPagesToWindowCore","params","updatePagesWindowOptions","setPages","raiseBrowserPageAnalytics","applyEnterprisePageRequiredLayoutSettings","requiredSettings","_layout_settings_newTabButton","settings","newTabButton","newTabButtonUrl","makeDebouncedFunc","attachedPages","oldOptions","updateOptions","getPanelsWithViewSnapshots","handleSetActivePageForWindow","disableMultiplePages","getDisableMultiplePagesOption","currentActivePage","currentActivePageIndex","selectActivePageWithIndex","isLayoutCreated","setIsActivePageChanging","newActivePage","newActivePageIndex","selectPageWithIndex","setUpPanelViews","Platform","Layout","layoutName","layoutContainerKey","currentLayout","getConfig","layoutConfig","isLocked","getUnlockedLayout","cleanPageInternalProps","cleanedPage","isLayoutReady","setActivePageForWindow","getPageWithLayout","getLayoutConfig","getActivePageForWindow","activePageId","renamePage","updatedPages","mapLayoutViewComponents","mapInternalWorkspaceDataToWorkspacePlatform","attachPagesToWindow","detachPagesFromWindow","setIsDetachingPages","detachSet","Set","pageIds","detachedActivePageIndex","filteredPages","isDetached","has","deletePageWithSelectedViews","getNextActivePageOnRemoval","updatedFilteredPages","reorderPagesForWindow","reorderMap","Map","set","reorderedPages","get","v","updatePageForWindow","currentPageState","anyPayloadPage","newPageState","getEnterpriseLandingUrl","isLockedStateChanged","hasOwn","newLayout","replaceLayout","isDetachingPages","selectIsDetachingPages","isActivePageChanging","selectIsActivePageChanging","checkViewHealth","info","getInfo","catch","setTimeout","rescueCrashedView","reload","handleViewCrashed","viewIdentity","getOFView","handleViewAttached","layoutSnapshot","getCurrentLayoutManagerSync","getLayoutSnapshot","layouts","updatedLayoutConfig","dispatchInstance","getStateInstance","act","setGetStateInstance","instance","setDispatchInstance","resizeObserverDisconnectCallbacks","isPanelZeroSized","primaryDimension","PanelPosition","Left","Right","includes","panelConfig","position","getSizeWithoutCSSUnits","panelInitPromises","View","viewOptions","attach","hide","show","panelElement","document","getElementById","disconnectCallback","bindToElement","panelsToReplace","values","clear","viewDetachPromises","oldPanel","newPanel","panel","snapshotViewOpts","getViewSnapshot","finUUID","handlePanelViewDetached","activePage","target","filteredPanels","isViewIdentityMatching","delete","isFin","makeNewView","windowIdentity","Window","getNewLandingTabViewOptions","createView","getEnterpriseBaseUrl","Route","ResponseModal","WindowName","BrowserMenu","modalParentIdentity","body","buttons","label","variant","right","count","getColorLinkingMenu","BrowserPopupMenuColorLinking","getLayoutsMenu","BrowserPopupMenuLayouts","BrowserPopupMenuSaveModal","BrowserSaveMenu","DefaultSaveMenuBounds","newActiveIndex","_path2","pencil","react","fillRule","clipRule","useInitializeAICompanionView","hidden","useShouldHidePanelComponent","SidePanelComponent","AICompanion","broadcastChannel","useRef","showNewChatButton","setShowNewChatButton","useState","handleChannelMessage","useCallback","topic","useEffect","attachAICompanionView","aiCompanionView","getAICompanionViewIdentity","aiCompanionPanelDiv","AICompanionPanelId","addLayoutEventListener","current","BroadcastChannel","onmessage","handleNewChatClicked","postMessage","AICompanionPanel_AICompanionPanel","useTranslation","isWindows","useIsWindows","toggleSidePanelComponent","useSidePanelContext","jsx_runtime","jsxs","Container","HeaderContainer","LeftContainer","jsx","AICompanionIcon","Text","RightContainer","NewChatButton","onClick","PencilIcon","CloseButtonLarge","aria-label","BorderPaddingContainer","ViewContentContainer","styled","div","withConfig","theme","px","base","palette","background3","xsmall","textDefault","small","BaseButton","attrs","borderRadius","customContentSize","background4","inputColor","PaddingBorderMixin","size","dimensions","bottom","borderColor","background1","PanelContainer_PanelContainer","cssBounds","usePanelBounds","isAICompanionEnabled","Panel","tabIndex","BookmarksPanel","AICompanionPanel","cssValue","asNumber","Number","stringValue","replace","isNaN","background5","css","MAC_WINDOW_BORDER_RADIUS","getDimension","defaultSize","backgroundColor","getSidePanelConfig","shouldShowNavigationRail","SIDE_PANEL_WIDTH","units","strings","result","zeroBounds","useSelector","selectActivePage","resizeCounter","setResizeCounter","isSidePanelOpen","pagelessPanels","useMemo","panelPosition","Bottom","currentVal","topConfig","Top","leftConfig","rightConfig","bottomConfig","extendLeftPanelToTop","extendToTop","extendLeftPanelToBottom","extendToBottom","extendRightPanelToTop","extendRightPanelToBottom","commonReplaceLayout"],"sourceRoot":""}